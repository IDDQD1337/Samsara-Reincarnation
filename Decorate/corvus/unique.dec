/*actor PortTome : PowerupGiver
{
    inventory.maxamount 16
    inventory.usesound "heretic/itemuse"
    +INVBAR
    +inventory.undroppable
    +inventory.hubpower
    Inventory.Icon "ARTIPWBK"
    Powerup.Type HereticTome
}*/

actor PortTome : CustomInventory
{
    tag "Tome of Power"
    inventory.maxamount 16
    inventory.usesound "heretic/itemuse"
    +INVBAR
    +inventory.undroppable
    +inventory.hubpower
    Inventory.Icon "ARTIPWBK"
    States
    {
      Use:
        TNT1 A 0 A_JumpIfInventory("PowerHereticTome",1,"UseFail")
        TNT1 A 1
        TNT1 A 0 A_GiveInventory("PowerHereticTome",1)
        TNT1 A 0 A_GiveInventory("PowerGreaterTome",1)
        TNT1 A 0 A_GiveInventory("PowerTomeProtection",1)
        stop

      UseFail:
        TNT1 A 1
        fail
    }
}

actor PortTomeCoOp : CustomInventory
{
    tag "Tome of Power"
    inventory.maxamount 1
    inventory.usesound "heretic/itemuse"
    +INVBAR
    +inventory.undroppable
    +inventory.hubpower
    Inventory.Icon "ARTIPWBK"
    States
    {
      Use:
        TNT1 A 0 A_JumpIfInventory("TomeOfPowerCooldown",1,"UseFail")
        TNT1 A 1
        TNT1 A 0 A_GiveInventory("PowerHereticTome",1)
        TNT1 A 0 A_GiveInventory("PowerGreaterTome",1)
        TNT1 A 0 A_GiveInventory("PowerTomeProtection",1)
        TNT1 A 0 ACS_ExecuteAlways(202)
        TNT1 A 0 A_GiveInventory("TomeOfPowerCooldown",200)
        fail

      UseFail:
        TNT1 A 1
        TNT1 A 0 A_Print("$TOMECOOLDOWN")
        fail
    }
}

actor PowerHereticTome : Powerup//PowerWeaponLevel2
{
    Powerup.Duration -90
    Inventory.Icon "SPINBK0"
    Powerup.Color Red, 0.1
}

actor PowerHereticTomeCoOp : Powerup//PowerWeaponLevel2
{
    Powerup.Duration -120
    Inventory.Icon "SPINBK0"
    Powerup.Color Red, 0.1
}

actor PowerHereticTomeDM : PowerHereticTome
{
    Powerup.Duration -60
}

actor PowerGreaterTome : PowerDamage
{
    Powerup.Duration -90
    DamageFactor "Pistol", 2.0
    DamageFactor "Mace", 2.0
    DamageFactor "Normal", 2.0
    DamageFactor "DragonClaw", 2.0
    DamageFactor "Fire", 2.0
    DamageFactor "CorvusHellstaff", 2.0
    DamageFactor "CorvusHellstaffTomed", 2.0
    DamageFactor "CorvusCrossbow", 2.0
    DamageFactor "Spectral", 2.0
    DamageFactor "FireExplosive", 2.0

}

actor PowerGreaterTomeDM : PowerGreaterTome
{
    Powerup.Duration -60
}

actor PowerTomeProtection : PowerProtection
{
    Powerup.Duration -90
    damagefactor "normal", 0.5
    damagefactor "Pistol", 0.5
    DamageFactor "DoomFist", 0.5
    damagefactor "ZorchPistol", 0.5
    damagefactor "Wraithverge", 0.5
    damagefactor "zorch", 0.5
    damagefactor "fire", 0.5
    damagefactor "ice", 0.5
    damagefactor "slime", 0.5
    damagefactor "bfg", 0.5
    damagefactor "bfgspray", 0.5
    damagefactor "disintegrate", 0.5
    damagefactor "electric", 0.5
    DamageFactor "BFG", 0.5
    DamageFactor "BFGSpray", 0.5
    DamageFactor "Poison", 0.5
    DamageFactor "PoisonCloud", 0.5
    DamageFactor "Mace", 0.5
    DamageFactor "DragonClaw", 0.5
    DamageFactor "WolfenFlamethrower", 0.5
    DamageFactor "DukeDamage", 0.5
    DamageFactor "DukeExplosive", 0.5
    DamageFactor "DukeSpectral", 0.5
    DamageFactor "MightyBoot", 0.5
    DamageFactor "DukeIce", 0.5
    
    DamageFactor "DukePistol", 0.5
    DamageFactor "MarathonPistol", 0.5
    DamageFactor "Explosive", 0.5
    DamageFactor "DoomPlasma", 0.5
    DamageFactor "CorvusCrossbow", 0.5
    DamageFactor "CorvusHellstaff", 0.5
    DamageFactor "CorvusHellstaffTomed", 0.5
    DamageFactor "MarathonPlasma", 0.5
    DamageFactor "BJSpear", 0.5
    DamageFactor "DoomCacodemon", 0.5
    DamageFactor "DoomHellNoble", 0.5
    DamageFactor "DoomSpiderPlasma", 0.5
    DamageFactor "DoomTheseGuysAreTheBest", 0.5
    DamageFactor "HereNitrogolem", 0.5
    DamageFactor "HereAxeGreen", 0.5
    DamageFactor "HereAxeRed", 0.5
    DamageFactor "Wizard", 0.5
    DamageFactor "HereLichWind", 0.5
    DamageFactor "HereDsparil", 0.5
    DamageFactor "HexBishop", 0.5
    DamageFactor "HexSlaughtaur", 0.5
    DamageFactor "HexGreenFire", 0.5
    DamageFactor "HexStalkerShot", 0.5
    DamageFactor "HexHeresiarchPurple", 0.5
    DamageFactor "QuakePistol", 0.5
    DamageFactor "NotQuadded", 0.5
    DamageFactor "SpectralNoQuad", 0.5
    
    DamageFactor "Kamikaze", 1.0
    DamageFactor "ZorchKamikaze", 1.0
    DamageFactor "Suicide", 1.0
    DamageFactor "Telefrag", 1.0
}

actor PowerTomeProtectionDM : PowerTomeProtection
{
    Powerup.Duration -60
}

actor TomeOfPowerCooldown : inventory { -INVBAR +INVENTORY.UNDROPPABLE inventory.maxamount 360 }

// Kept for legacy purposes

actor Chicken2 : Chicken replaces Chicken
{
    BloodType "SamsaraBloodyHellBlood"
    States
    {
      Death:
        TNT1 A 0 A_GiveToTarget("KillCount",1)
        TNT1 A 0 ACS_ExecuteAlways(SAMSARA_CLIENT_DECORATE,0,11)
        goto "Super::Death"

      Death.ZorchPistol:

      Death.Zorch:
      Death.ZorchKamikaze:
      Death.PhasingZorch:
      Death.ZorchSpectral:
        TNT1 A 0 A_GiveToTarget("KillCount",1)
        CHKN D 0 A_Stop
        TNT1 A 0 A_PlaySoundEx("chex/zorchsmall","soundslot5",0,0)
        CHKN D 3 A_SpawnItem("ZorchEffectSuperTiny")
        CHKN D 3 A_SetTranslucent(0.9,0)
        CHKN DD 0 A_Feathers
        CHKN D 0 A_Scream
        CHKN D 3 A_SetTranslucent(0.8,0)
        TNT1 D 0 A_NoBlocking
        CHKN D 3 A_SetTranslucent(0.7,0)
        CHKN D 3 A_SetTranslucent(0.6,0)
        CHKN D 3 A_SetTranslucent(0.5,0)
        CHKN D 3 A_SetTranslucent(0.4,0)
        CHKN D 3 A_SetTranslucent(0.3,0)
        CHKN D 3 A_SetTranslucent(0.2,0)
        CHKN D 3 A_SetTranslucent(0.1,0)
        TNT1 A 1 A_SetTranslucent(1,0)
        TNT1 A -1
        stop

      Ice:
      Freeze:
      Death.Ice:
        TNT1 A 0 A_GiveToTarget("KillCount",1)
        TNT1 A 0 A_NoBlocking
        CHKN D 0 A_UnsetSolid
        CHKN D 70 A_GenericFreezeDeath
        CHKN D 0 A_IceGuyDie
        CHKN D 1 A_IceGuyDie
        TNT1 A -1
        stop

      Death.WolfenFlamethrower:
        CHKN E 0 A_Scream
        CHKN E 0 A_GiveToTarget("KillCount",1)
        CHKN EEEEEEE 0 A_Feathers
        CHKN E 0 A_SpawnItem("WolfensteinChickenLeg")
        ACLO E -1
        stop

      DeathBrutal:
        TNT1 A 0
        TNT1 AA 0 A_SpawnItemEx("RedMistTrail",random(-10,10),random(-10,10),random(12,40),random(-400,400)/100.00,random(-400,400)/100.00,random(300,600)/100.00,random(-180,180),160)
        TNT1 AA 0 A_SpawnItemEx("BrutalTinyBone",random(-5,5),random(-5,5),random(12,40),random(-200,200)/100.00,random(-200,200)/100.00,random(300,800)/100.00,random(-180,180),160)
        TNT1 AA 0 A_SpawnItemEx("BrutalChunkTinier",random(-10,10),random(-10,10),random(12,40),random(-400,400)/100.00,random(-400,400)/100.00,random(300,600)/100.00,random(-180,180),160)
        TNT1 AA 0 A_SpawnItemEx("BrutalChunkTiny",random(-10,10),random(-10,10),random(12,40),random(-400,400)/100.00,random(-400,400)/100.00,random(300,600)/100.00,random(-180,180),160)
        TNT1 A 0 A_SpawnItemEx("RedMistIntenseTrail",random(-10,10),random(-10,10),random(12,40),random(-400,400)/100.00,random(-400,400)/100.00,random(300,600)/100.00,random(-180,180),160)
        TNT1 AA 0 A_SpawnItemEx("Switchable_FlyingBlood",random(-10,10),random(-10,10),random(12,40),random(-350,350)/100.00,random(-350,350)/100.00,random(300,700)/100.00,random(-180,180),160)
        TNT1 A 0 A_SpawnItemEx("BrutalOnlineSound2",0,0,0,0,0,0,0,160) // Apparently A_PlaySound doesn't work, so I have to spawn the item. Weird!
        goto "Super::Death"
        
      DeathHappyfun:
        TNT1 A 0
        TNT1 AAA 0 A_SpawnItemEx("RainbowSparkleSound",random(-10,10),random(-10,10),random(32,40),0,0,0,0,32)
        TNT1 AAA 0 A_SpawnItemEx("WhiteSpark",0,0,random(32,40),random(-60,60)/20.0,random(-60,60)/20.0,random(-40,40)/20.0,random(-180,180),32)
        TNT1 A 0 A_SpawnItemEx("RainbowSparkHuge",0,0,random(32,40),random(-60,60)/20.0,random(-60,60)/20.0,random(-40,40)/20.0,random(-180,180),32)
        TNT1 AAAA 0 A_SpawnItemEx("RainbowSpark",0,0,random(32,40),random(-60,60)/20.0,random(-60,60)/20.0,random(-40,40)/20.0,random(-180,180),32)
        TNT1 AA 0 A_SpawnItemEx("RainbowSparkTiny",random(-5,5),random(-5,5),random(25,30),random(-80,80)/10.00,random(-80,80)/10.0,random(-3,3),random(-180,180),160)
        goto "Super::Death"
    }
}

actor ChickenPlayer2 : ChickenPlayer
{
    Health 100 // Previously 30
    ReactionTime 0
    PainChance 255
    Radius 8
    Height 12
    Speed 1
    Gravity 0.125
    +NOSKIN
    PainSound "chicken/pain"
    DeathSound "chicken/death"
    Player.JumpZ 1
    Player.Viewheight 21
    Player.ForwardMove 0.85, 0.9//1.22, 1.22
    Player.SideMove 0.85, 0.9//1.22, 1.22
    Player.SoundClass "Chicken"
    Player.DisplayName "Chicken"
    Player.MorphWeapon " Beak "
    BloodType "SamsaraBloodyHellBlood"
    -PICKUP
    States
    {
      Spawn:
        CHKN A -1
        Stop

      See:
        CHKN ABAB 3
        Loop

      Melee:
      Missile:
        CHKN C 12
        Goto Spawn

      Pain:
        CHKN D 4 A_Feathers
        CHKN C 4 A_Pain
        Goto Spawn

      Death:
        TNT1 A 0 ACS_ExecuteAlways(SAMSARA_CLIENT_DECORATE,0,11)
      Death2:
        CHKN E 6 A_Scream
        CHKN F 6 A_Feathers
        CHKN G 6
        CHKN H 6 A_NoBlocking
        CHKN IJK 6
        CHKN L -1
        Stop

      Death.WolfenFlamethrower:
        CHKN E 0 A_Scream
        CHKN EEEEEEEEE 0 A_Feathers
        CHKN E 0 A_SpawnItem("WolfensteinChickenLeg")
        ACLO E -1
        stop

      Pain.MightyBoot:
        CHKN G 1 ACS_ExecuteAlways(312, 0, 25, 5, 24)
        CHKN G 1 A_PlaySoundEx("duke/kickhit","body",0,0)
        TNT1 A 0 A_Recoil(12)
        CHKN G 6 A_Pain
        Goto See
        
      Pain.MarathonStun:
        TNT1 A 0 A_Stop
        CHKN D 1 ACS_ExecuteAlways(312, 0, 25, 5, 100)
        TNT1 A 0 A_GiveInventory("NothingSpeed")
        TNT1 A 0 A_SetBlend("White",0.9,105)
        CHKN D 1 A_PlaySoundEx("marathon/tech50/stun","body",0,0)
        CHKN D 6 A_Pain
        Goto See

      Death.ZorchPistol:

      Death.Zorch:
      Death.ZorchKamikaze:
      Death.PhasingZorch:
      Death.ZorchSpectral:
        TNT1 A 0 A_Stop
        TNT1 A 0 A_PlaySoundEx("chex/zorchsmall","soundslot5",0,0)
        CHKN D 3 A_SpawnItem("ZorchEffectSuperTiny")
        CHKN D 3 A_SetTranslucent(0.9,0)
        CHKN AAAAAAAAAA 0 A_Feathers
        TNT1 A 0 A_PlayerScream
        CHKN D 3 A_SetTranslucent(0.8,0)
        TNT1 A 0 A_NoBlocking
        CHKN D 3 A_SetTranslucent(0.7,0)
        CHKN D 3 A_SetTranslucent(0.6,0)
        CHKN D 3 A_SetTranslucent(0.5,0)
        CHKN D 3 A_SetTranslucent(0.4,0)
        CHKN D 3 A_SetTranslucent(0.3,0)
        CHKN D 3 A_SetTranslucent(0.2,0)
        CHKN D 3 A_SetTranslucent(0.1,0)
        ACLO E 1 A_SetTranslucent(1,0)
        ACLO E -1
        stop

      DeathBrutal:
        TNT1 A 0
        TNT1 AA 0 A_SpawnItemEx("RedMistTrail",random(-10,10),random(-10,10),random(12,40),random(-400,400)/100.00,random(-400,400)/100.00,random(300,600)/100.00,random(-180,180),160)
        TNT1 AA 0 A_SpawnItemEx("BrutalTinyBone",random(-5,5),random(-5,5),random(12,40),random(-200,200)/100.00,random(-200,200)/100.00,random(300,800)/100.00,random(-180,180),160)
        TNT1 AA 0 A_SpawnItemEx("BrutalChunkTinier",random(-10,10),random(-10,10),random(12,40),random(-400,400)/100.00,random(-400,400)/100.00,random(300,600)/100.00,random(-180,180),160)
        TNT1 AA 0 A_SpawnItemEx("BrutalChunkTiny",random(-10,10),random(-10,10),random(12,40),random(-400,400)/100.00,random(-400,400)/100.00,random(300,600)/100.00,random(-180,180),160)
        TNT1 A 0 A_SpawnItemEx("RedMistIntenseTrail",random(-10,10),random(-10,10),random(12,40),random(-400,400)/100.00,random(-400,400)/100.00,random(300,600)/100.00,random(-180,180),160)
        TNT1 AA 0 A_SpawnItemEx("Switchable_FlyingBlood",random(-10,10),random(-10,10),random(12,40),random(-350,350)/100.00,random(-350,350)/100.00,random(300,700)/100.00,random(-180,180),160)
        TNT1 A 0 A_SpawnItemEx("BrutalOnlineSound2",0,0,0,0,0,0,0,160) // Apparently A_PlaySound doesn't work, so I have to spawn the item. Weird!
        goto Death2
        
      DeathHappyfun:
        TNT1 A 0
        TNT1 AAA 0 A_SpawnItemEx("RainbowSparkleSound",random(-10,10),random(-10,10),random(32,40),0,0,0,0,32)
        TNT1 AAA 0 A_SpawnItemEx("WhiteSpark",0,0,random(32,40),random(-60,60)/20.0,random(-60,60)/20.0,random(-40,40)/20.0,random(-180,180),32)
        TNT1 A 0 A_SpawnItemEx("RainbowSparkHuge",0,0,random(32,40),random(-60,60)/20.0,random(-60,60)/20.0,random(-40,40)/20.0,random(-180,180),32)
        TNT1 AAAA 0 A_SpawnItemEx("RainbowSpark",0,0,random(32,40),random(-60,60)/20.0,random(-60,60)/20.0,random(-40,40)/20.0,random(-180,180),32)
        TNT1 AA 0 A_SpawnItemEx("RainbowSparkTiny",random(-5,5),random(-5,5),random(25,30),random(-80,80)/10.00,random(-80,80)/10.0,random(-3,3),random(-180,180),160)
        goto Death2
    }
}

actor " Beak " : Beak replaces Beak
{
+CHEATNOTWEAPON
}

actor ChickenPlayer3: ChickenPlayer2
{
    Radius 16
    Height 36
    Speed 0.75
    Player.ForwardMove 0.75, 0.75
    Player.SideMove 0.75, 0.75
}
