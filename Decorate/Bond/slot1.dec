ACTOR Goldeneye_ThrowingKnives : Weapon
{
  Weapon.SelectionOrder 55
  Weapon.AmmoType "Goldeneye_ThrowingKnivesAmmo"
  Weapon.AmmoGive 1
  Weapon.SlotNumber 1
  Weapon.SlotPriority 0
  Weapon.BobStyle InverseSmooth
  Weapon.BobSpeed 1.6
  Weapon.BobRangeX 0.3
  Weapon.BobRangeY 0.4  
  Obituary "%o got quietly killed by %k's knife."
  Inventory.Pickupmessage "Picked up a throwing knife."
  Inventory.RestrictedTo "JamesBond"
  Tag "Throwing Knives"
  +WEAPON.AMMO_OPTIONAL
  +WEAPON.NOALERT
  +WEAPON.NOAUTOAIM
  Height 16
  Radius 8
  States
  {
  Spawn:
    PIST A -1
    stop

  // Single
  Ready:
	TNT1 A 0 A_JumpIfInventory("BondAltToggle", 1, "DualWield")
	TNT1 A 0 A_JumpIfInventory("BondWatchQueue", 1, "RaiseWatch")
	TNT1 A 0 A_JumpIfInventory("BondWatchToken", 1, "WatchReady")
	TNT1 A 0 A_JumpIfInventory("BondGunAngle", 10, "Right5")
	TNT1 A 0 A_JumpIfInventory("BondGunAngle", 9, "Right4")
	TNT1 A 0 A_JumpIfInventory("BondGunAngle", 8, "Right3")
	TNT1 A 0 A_JumpIfInventory("BondGunAngle", 7, "Right2")
	TNT1 A 0 A_JumpIfInventory("BondGunAngle", 6, "Right1")
	TNT1 A 0 A_JumpIfInventory("BondGunAngle", 5, "Center")
	TNT1 A 0 A_JumpIfInventory("BondGunAngle", 4, "Left1")
	TNT1 A 0 A_JumpIfInventory("BondGunAngle", 3, "Left2")
	TNT1 A 0 A_JumpIfInventory("BondGunAngle", 2, "Left3")
	TNT1 A 0 A_JumpIfInventory("BondGunAngle", 1, "Left4")
	Goto Center
  ReadyNoAmmoCheck:
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,"ReloadStart")
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,"ReloadStart")
    goto Ready

  Right5:
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,2)
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,1)
    goto OutOfKnives
    GE01 E 1 A_WeaponReady
    goto Ready
  Right4:
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,2)
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,1)
    goto OutOfKnives
    GE01 D 1 A_WeaponReady
    goto Ready
  Right3:
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,2)
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,1)
    goto OutOfKnives
    GE01 C 1 A_WeaponReady
    goto Ready
  Right2:
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,2)
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,1)
    goto OutOfKnives
    GE01 B 1 A_WeaponReady
    goto Ready
  Right1:
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,2)
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,1)
    goto OutOfKnives
    GE01 A 1 A_WeaponReady
    goto Ready
  Center:
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,2)
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,1)
    goto OutOfKnives
    GE00 A 1 A_WeaponReady
    goto Ready
  Left1:
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,2)
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,1)
    goto OutOfKnives
    GE00 B 1 A_WeaponReady
    goto Ready
  Left2:
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,2)
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,1)
    goto OutOfKnives
    GE00 C 1 A_WeaponReady
    goto Ready
  Left3:
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,2)
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,1)
    goto OutOfKnives
    GE00 D 1 A_WeaponReady
    goto Ready
  Left4:
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,2)
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,1)
    goto OutOfKnives
    GE00 E 1 A_WeaponReady
    goto Ready
  OutOfKnives:
    GE02 Z 1 A_WeaponReady
    goto ReadyNoAmmoCheck

  Deselect:
    TNT1 A 0 A_JumpIfInventory("BondDualWieldToken",1,1)
    goto DeselectLoop
    TNT1 A 0 A_GunFlash("DualDeselect",GFF_NOEXTCHANGE)
  DeselectLoop:
	TNT1 A 0 A_TakeInventory("BondFireDelay", 3)
	TNT1 A 0 A_TakeInventory("BondAlternateFire", 1)
	TNT1 A 0 A_TakeInventory("BondDualWieldToken", 1)
	TNT1 A 0 A_TakeInventory("BondAltToggle", 2)
	TNT1 A 0 A_TakeInventory("BondZoomToken", 1)
	TNT1 A 0 A_TakeInventory("BondDualWieldSpamProtector", 1)
	TNT1 A 0 A_TakeInventory("BondDryFireSpamProtector1", 1)
	TNT1 A 0 A_TakeInventory("BondDryFireSpamProtector2", 1)
	TNT1 A 0 A_TakeInventory("BondAltActivationToken", 1)
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,3)
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,2)
    GE02 Z 1 A_Lower
    loop
    GE00 A 1 A_Lower
    loop

  Select:
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,2)
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,1)
    goto SelectDualCheck
	TNT1 A 0 A_PlaySound("Goldeneye/KnifeSwitch",CHAN_7)
  SelectDualCheck:
    TNT1 A 0 A_JumpIfInventory("BondDualWieldToken",1,1)
    goto SelectLoop
    TNT1 A 0 A_GunFlash("DualSelect",GFF_NOEXTCHANGE)
  SelectLoop:
	TNT1 A 0 A_TakeInventory("Goldeneye_UnarmedToken", 1)
	TNT1 A 0 A_TakeInventory("Goldeneye_PP7Token", 1)
	TNT1 A 0 A_GiveInventory("Goldeneye_KnifeToken", 1)
	TNT1 A 0 A_TakeInventory("Goldeneye_KF7Token", 1)
	TNT1 A 0 A_TakeInventory("Goldeneye_AutoShotgunToken", 1)
	TNT1 A 0 A_TakeInventory("Goldeneye_AR33Token", 1)
	TNT1 A 0 A_TakeInventory("Goldeneye_RocketLauncherToken", 1)
	TNT1 A 0 A_TakeInventory("Goldeneye_RCP90Token", 1)
	TNT1 A 0 A_TakeInventory("Goldeneye_LaserToken", 1)
	TNT1 A 0 A_TakeInventory("Goldeneye_GoldenGunToken", 1)
	TNT1 A 0 A_TakeInventory("Goldeneye_SniperToken", 1)
	TNT1 A 0 A_TakeInventory("Goldeneye_D5KToken", 1)
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,3)
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,2)
    GE02 Z 1 A_Raise
    goto SelectDualCheck
    GE00 A 1 A_Raise
    goto SelectDualCheck

  Fire:
	GE02 A 0 A_JumpIfInventory("BondSecondaryToken",1,"AltGotoFire")
	GE02 A 0 A_JumpIfInventory("BondAltToggle", 1, "DualWieldFire")
	GE02 A 0 A_JumpIfInventory("BondDualWieldToken", 1, 1)
	Goto Fire+5
	GE02 A 0 A_JumpIfInventory("BondHoldingToken", 1, "Ready")
	GE02 A 0 A_JumpIfInventory("BondAlternateFire", 1, "Ready")
    GE02 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,"FireStart")
    GE02 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,"FireStart")
    goto FireDry

  FireDry:
	TNT1 A 0 A_JumpIfInventory("BondDryFireSpamProtector1", 1, "FireFinish")
	TNT1 A 0 ACS_NamedExecuteAlways("BondDryFireSpamBlocker_Primary")
	TNT1 A 0 A_GiveInventory("BondDryFireSpamProtector1", 1)
	Goto FireFinish

  FireStart:
	GE02 A 0 A_GiveInventory("BondFiringToken", 1)
    GE02 A 0 A_TakeInventory("BondGunAngleFiringSingle")
    GE02 A 0 A_JumpIfInventory("BondGunAngle", 10, "FireRight5")
	GE02 A 0 A_JumpIfInventory("BondGunAngle", 9, "FireRight4")
	GE02 A 0 A_JumpIfInventory("BondGunAngle", 8, "FireRight3")
	GE02 A 0 A_JumpIfInventory("BondGunAngle", 7, "FireRight2")
	GE02 A 0 A_JumpIfInventory("BondGunAngle", 6, "FireRight1")
	GE02 A 0 A_JumpIfInventory("BondGunAngle", 5, "FireCenter")
	GE02 A 0 A_JumpIfInventory("BondGunAngle", 4, "FireLeft1")
	GE02 A 0 A_JumpIfInventory("BondGunAngle", 3, "FireLeft2")
	GE02 A 0 A_JumpIfInventory("BondGunAngle", 2, "FireLeft3")
	GE02 A 0 A_JumpIfInventory("BondGunAngle", 1, "FireLeft4")
	Goto FireCenter

  FireRight5:
    GE07 A 2 A_GiveInventory("BondGunAngleFiringSingle",10)
    GE07 BCDE 2
    goto FireContinue

  FireRight4:
    GE08 A 2 A_GiveInventory("BondGunAngleFiringSingle",9)
    GE08 BCDE 2
    goto FireContinue

  FireRight3:
    GE09 A 2 A_GiveInventory("BondGunAngleFiringSingle",8)
    GE09 BCDE 2
    goto FireContinue

  FireRight2:
    GE10 A 2 A_GiveInventory("BondGunAngleFiringSingle",7)
    GE10 BCDE 2
    goto FireContinue

  FireRight1:
    GE11 A 2 A_GiveInventory("BondGunAngleFiringSingle",6)
    GE11 BCDE 2
    goto FireContinue

  FireCenter:
    GE02 A 2 A_GiveInventory("BondGunAngleFiringSingle",5)
    GE02 BCDE 2
    goto FireContinue

  FireLeft1:
    GE06 A 2 A_GiveInventory("BondGunAngleFiringSingle",4)
    GE06 BCDE 2
    goto FireContinue

  FireLeft2:
    GE05 A 2 A_GiveInventory("BondGunAngleFiringSingle",3)
    GE05 BCDE 2
    goto FireContinue

  FireLeft3:
    GE04 A 2 A_GiveInventory("BondGunAngleFiringSingle",2)
    GE04 BCDE 2
    goto FireContinue

  FireLeft4:
    GE03 A 2 A_GiveInventory("BondGunAngleFiringSingle")
    GE03 BCDE 2
    goto FireContinue

  FireContinue:
    TNT1 A 0
    GE02 Z 5
  FireHold:
    GE02 Z 1
    GE02 Z 0 A_GiveInventory("BondHoldingToken")
    GE02 Z 0 A_ReFire("FireHold")
  FireAttack:
    GE02 Z 1 A_GiveInventory("SamsaraGoldenEyeThrowingKnivesSingleAttackHandler")
    GE02 Z 0 A_TakeInventory("BondFiringToken")
    GE02 Z 0 A_TakeInventory("BondHoldingToken")
  FireDone:
    GE02 Z 5
    goto FireFinish

  FireFinish:
    TNT1 A 0 A_JumpIfInventory("BondDualWieldToken",1,1)
    goto FireFinish+2
    TNT1 A 0 A_GiveInventory("BondAlternateFire")
    TNT1 A 0 A_TakeInventory("BondFiringToken")
    goto ReadyNoAmmoCheck

  AltGotoFire:
	GE02 A 0 A_JumpIfInventory("BondAltActivationToken", 1, "FireOffset")
	GE02 A 0 A_TakeInventory("BondAltToggle", 2)
	GE02 A 0 A_GiveInventory("BondAltActivationToken", 1)
	GE02 A 0 ACS_NamedExecuteAlways("BondAltFire")
	Goto Fire

  FireOffset:
	GE02 A 0
	Goto Fire+1

  ReloadStart:
  ReloadDone:
	GE27 IHGFEDCBA 1
	goto Ready

  // Dual Init
  AltFire:
	TNT1 A 0 A_JumpIfInventory("BondAltActivationToken", 1, "Ready")
	TNT1 A 0 A_TakeInventory("BondAltToggle", 2)
	TNT1 A 0 A_GiveInventory("BondAltActivationToken", 1)
	TNT1 A 0 ACS_NamedExecuteAlways("BondAltFire")
	Goto Ready

  DualWield:
	TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesDualToken", 1, 4)
	TNT1 A 0 A_TakeInventory("BondAltActivationToken", 1)
	TNT1 A 0 A_TakeInventory("BondAltToggle", 2)
	TNT1 A 0 A_TakeInventory("BondZoomToken", 1)
	Goto Ready+1
	TNT1 A 0 A_JumpIfInventory("BondDualWieldToken", 1, "DualUnWield")
	TNT1 A 0 A_TakeInventory("BondAltActivationToken", 1)
	TNT1 A 0 A_TakeInventory("BondAltToggle", 2)
	TNT1 A 0 A_JumpIfInventory("BondDualWieldSpamProtector", 1, 3)
	TNT1 A 0 A_GiveInventory("BondDualWieldToken", 1)
	TNT1 A 0 A_GunFlash("DualRaise",GFF_NOEXTCHANGE)
	TNT1 A 0 A_ZoomFactor(1.0)
	Goto Ready+1

  DualUnWield:
	TNT1 A 0 A_TakeInventory("BondAltActivationToken", 1)
	TNT1 A 0 A_TakeInventory("BondAltToggle", 2)
	TNT1 A 0 A_TakeInventory("BondAlternateFire", 1)
	TNT1 A 0 A_JumpIfInventory("BondDualWieldSpamProtector", 1, 5)
	TNT1 A 0 A_TakeInventory("BondDualWieldToken", 1)
	TNT1 A 0 A_TakeInventory("BondDryFireSpamProtector1", 1)
	TNT1 A 0 A_TakeInventory("BondDryFireSpamProtector2", 1)
	TNT1 A 0 A_GunFlash("DualLower",GFF_NOEXTCHANGE)
	TNT1 A 0 A_ZoomFactor(1.0)
	Goto Ready+1

  DualWieldFire:
	TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesDualToken", 1, 4)
	TNT1 A 0 A_TakeInventory("BondAltActivationToken", 1)
	TNT1 A 0 A_TakeInventory("BondAltToggle", 2)
	TNT1 A 0 A_TakeInventory("BondZoomToken", 1)
	Goto Fire+2
	TNT1 A 0 A_JumpIfInventory("BondDualWieldToken", 1, "DualUnWieldFire")
	TNT1 A 0 A_TakeInventory("BondAltActivationToken", 1)
	TNT1 A 0 A_TakeInventory("BondAltToggle", 2)
	TNT1 A 0 A_JumpIfInventory("BondDualWieldSpamProtector", 1, 3)
	TNT1 A 0 A_GiveInventory("BondDualWieldToken", 1)
	TNT1 A 0 A_GunFlash("DualRaise",GFF_NOEXTCHANGE)
	TNT1 A 0 A_ZoomFactor(1.0)
	Goto Fire+2

  DualUnWieldFire:
	TNT1 A 0 A_TakeInventory("BondAltActivationToken", 1)
	TNT1 A 0 A_TakeInventory("BondAltToggle", 2)
	TNT1 A 0 A_TakeInventory("BondAlternateFire", 1)
	TNT1 A 0 A_JumpIfInventory("BondDualWieldSpamProtector", 1, 5)
	TNT1 A 0 A_TakeInventory("BondDualWieldToken", 1)
	TNT1 A 0 A_TakeInventory("BondDryFireSpamProtector1", 1)
	TNT1 A 0 A_TakeInventory("BondDryFireSpamProtector2", 1)
	TNT1 A 0 A_GunFlash("DualLower",GFF_NOEXTCHANGE)
	TNT1 A 0 A_ZoomFactor(1.0)
	Goto Fire+2

  // Dual
  ReadyDual:
	TNT1 A 0 A_JumpIfInventory("BondHoldingToken", 1, 3)
	TNT1 A 0 A_JumpIfInventory("BondAlternateFire", 1, 1)
	Goto ReadyDual+3
	TNT1 A 0 A_JumpIfInventory("BondPrimaryToken",1,"FireDual")
	TNT1 A 0 A_JumpIfInventory("BondGunAngle", 10, "Right5Dual")
	TNT1 A 0 A_JumpIfInventory("BondGunAngle", 9, "Right4Dual")
	TNT1 A 0 A_JumpIfInventory("BondGunAngle", 8, "Right3Dual")
	TNT1 A 0 A_JumpIfInventory("BondGunAngle", 7, "Right2Dual")
	TNT1 A 0 A_JumpIfInventory("BondGunAngle", 6, "Right1Dual")
	TNT1 A 0 A_JumpIfInventory("BondGunAngle", 5, "CenterDual")
	TNT1 A 0 A_JumpIfInventory("BondGunAngle", 4, "Left1Dual")
	TNT1 A 0 A_JumpIfInventory("BondGunAngle", 3, "Left2Dual")
	TNT1 A 0 A_JumpIfInventory("BondGunAngle", 2, "Left3Dual")
	TNT1 A 0 A_JumpIfInventory("BondGunAngle", 1, "Left4Dual")
	Goto CenterDual
  ReadyNoAmmoCheckDual:
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,"ReloadStartDual")
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,"ReloadStartDual")
    goto ReadyDual

  Right5Dual:
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,2)
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,1)
    goto OutOfKnivesDual
    GE15 E 1
    goto ReadyDual
  Right4Dual:
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,2)
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,1)
    goto OutOfKnivesDual
    GE15 D 1
    goto ReadyDual
  Right3Dual:
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,2)
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,1)
    goto OutOfKnivesDual
    GE15 C 1
    goto ReadyDual
  Right2Dual:
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,2)
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,1)
    goto OutOfKnivesDual
    GE15 B 1
    goto ReadyDual
  Right1Dual:
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,2)
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,1)
    goto OutOfKnivesDual
    GE15 A 1
    goto ReadyDual
  CenterDual:
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,2)
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,1)
    goto OutOfKnivesDual
    GE14 A 1
    goto ReadyDual
  Left1Dual:
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,2)
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,1)
    goto OutOfKnivesDual
    GE14 B 1
    goto ReadyDual
  Left2Dual:
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,2)
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,1)
    goto OutOfKnivesDual
    GE14 C 1
    goto ReadyDual
  Left3Dual:
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,2)
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,1)
    goto OutOfKnivesDual
    GE14 D 1
    goto ReadyDual
  Left4Dual:
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,2)
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,1)
    goto OutOfKnivesDual
    GE14 E 1
    goto ReadyDual
  OutOfKnivesDual:
    TNT1 A 1
    goto ReadyNoAmmoCheckDual

  DualDeselect:
    TNT1 A 0 A_TakeInventory("BondHoldingToken")
    TNT1 A 0 A_TakeInventory("BondDualReloadSpamProtector")
    TNT1 A 0 A_TakeInventory("BondDualWieldSpamProtector")
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,"DualDeselectFull")
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,"DualDeselectFull")
    goto DualDeselectEmpty

  DualDeselectEmpty:
    TNT1 AAAAAAAAAAAAAAAA 1
    stop

  DualDeselectFull:
    GE26 AAAAAAAAAAAAAAAA 1
    stop

  DualLower:
    TNT1 A 0 A_TakeInventory("BondHoldingToken")
    TNT1 A 0 A_TakeInventory("BondDualReloadSpamProtector")
    TNT1 A 0 A_GiveInventory("BondDualWieldSpamProtector")
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,"DualLowerFull")
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,"DualLowerFull")
    goto DualLowerEmpty

  DualLowerEmpty:
    TNT1 AAAAAAAAA 1
    goto DualLowerFinish

  DualLowerFull:
    GE26 ABCDEFGHI 1
    goto DualLowerFinish

  DualLowerFinish:
    TNT1 A 0 A_TakeInventory("BondDualWieldSpamProtector")
    stop

  DualSelect:
    TNT1 A 0 A_TakeInventory("BondHoldingToken")
    TNT1 A 0 A_TakeInventory("BondDualReloadSpamProtector")
    TNT1 A 0 A_TakeInventory("BondDualWieldSpamProtector")
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,"DualSelectFull")
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,"DualSelectFull")
    goto DualSelectEmpty

  DualSelectEmpty:
    TNT1 A 1
    goto CenterDual

  DualSelectFull:
    GE26 A 1
    goto CenterDual

  DualRaise:
    TNT1 A 0 A_TakeInventory("BondHoldingToken")
    TNT1 A 0 A_TakeInventory("BondDualReloadSpamProtector")
    TNT1 A 0 A_GiveInventory("BondDualWieldSpamProtector")
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,"DualRaiseFull")
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,"DualRaiseFull")
    goto DualRaiseEmpty

  DualRaiseEmpty:
    TNT1 AAAAAAAAA 1
    goto DualRaiseFinish

  DualRaiseFull:
    GE26 I 1 A_PlaySound("Goldeneye/KnifeSwitch",CHAN_7)
    GE26 HGFEDCBA 1
    goto DualRaiseFinish

  DualRaiseFinish:
    TNT1 A 0 A_TakeInventory("BondDualWieldSpamProtector")
    goto CenterDual

  FireDual:
	GE16 A 0 A_JumpIfInventory("BondAlternateFire", 1, 2)
	GE16 A 0 A_JumpIfInventory("BondHoldingToken", 1, 1)
	Goto ReadyDual
    GE16 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,"FireDualStart")
    GE16 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,"FireDualStart")
    goto FireDualDry

  FireDualDry:
	TNT1 A 0 A_JumpIfInventory("BondDryFireSpamProtector2", 1, "FireFinishDual")
	TNT1 A 0 ACS_NamedExecuteAlways("BondDryFireSpamBlocker_Secondary")
	TNT1 A 0 A_GiveInventory("BondDryFireSpamProtector2", 1)
	Goto FireFinishDual

  FireDualStart:
	GE16 A 0 A_GiveInventory("BondFiringToken", 1)
    GE16 A 0 A_TakeInventory("BondGunAngleFiringDual")
    GE16 A 0 A_JumpIfInventory("BondGunAngle", 10, "FireRight5Dual")
	GE16 A 0 A_JumpIfInventory("BondGunAngle", 9, "FireRight4Dual")
	GE16 A 0 A_JumpIfInventory("BondGunAngle", 8, "FireRight3Dual")
	GE16 A 0 A_JumpIfInventory("BondGunAngle", 7, "FireRight2Dual")
	GE16 A 0 A_JumpIfInventory("BondGunAngle", 6, "FireRight1Dual")
	GE16 A 0 A_JumpIfInventory("BondGunAngle", 5, "FireCenterDual")
	GE16 A 0 A_JumpIfInventory("BondGunAngle", 4, "FireLeft1Dual")
	GE16 A 0 A_JumpIfInventory("BondGunAngle", 3, "FireLeft2Dual")
	GE16 A 0 A_JumpIfInventory("BondGunAngle", 2, "FireLeft3Dual")
	GE16 A 0 A_JumpIfInventory("BondGunAngle", 1, "FireLeft4Dual")
	Goto FireCenterDual

  FireRight5Dual:
    GE21 A 2 A_GiveInventory("BondGunAngleFiringDual",10)
    GE21 BCDE 2
    goto FireDualContinue

  FireRight4Dual:
    GE22 A 2 A_GiveInventory("BondGunAngleFiringDual",9)
    GE22 BCDE 2
    goto FireDualContinue

  FireRight3Dual:
    GE23 A 2 A_GiveInventory("BondGunAngleFiringDual",8)
    GE23 BCDE 2
    goto FireDualContinue

  FireRight2Dual:
    GE24 A 2 A_GiveInventory("BondGunAngleFiringDual",7)
    GE24 BCDE 2
    goto FireDualContinue

  FireRight1Dual:
    GE25 A 2 A_GiveInventory("BondGunAngleFiringDual",6)
    GE25 BCDE 2
    goto FireDualContinue

  FireCenterDual:
    GE16 A 2 A_GiveInventory("BondGunAngleFiringDual",5)
    GE16 BCDE 2
    goto FireDualContinue

  FireLeft1Dual:
    GE20 A 2 A_GiveInventory("BondGunAngleFiringDual",4)
    GE20 BCDE 2
    goto FireDualContinue

  FireLeft2Dual:
    GE19 A 2 A_GiveInventory("BondGunAngleFiringDual",3)
    GE19 BCDE 2
    goto FireDualContinue

  FireLeft3Dual:
    GE18 A 2 A_GiveInventory("BondGunAngleFiringDual",2)
    GE18 BCDE 2
    goto FireDualContinue

  FireLeft4Dual:
    GE17 A 2 A_GiveInventory("BondGunAngleFiringDual")
    GE17 BCDE 2
    goto FireDualContinue

  FireDualContinue:
    TNT1 A 0
    TNT1 A 5
  FireDualHold:
    TNT1 A 1
    TNT1 A 0 A_GiveInventory("BondHoldingToken")
    TNT1 A 0 A_JumpIfInventory("BondPrimaryToken",1,"FireDualHold")
  FireDualAttack:
    TNT1 A 1 A_GiveInventory("SamsaraGoldenEyeThrowingKnivesDualAttackHandler")
    TNT1 A 0 A_TakeInventory("BondFiringToken")
    TNT1 A 0 A_TakeInventory("BondHoldingToken")
  FireDualDone:
    TNT1 A 5
    goto FireFinishDual

  FireFinishDual:
    TNT1 A 0 A_TakeInventory("BondAlternateFire")
    TNT1 A 0 A_TakeInventory("BondFiringToken")
    goto ReadyNoAmmoCheckDual

  ReloadStartDual:
    TNT1 A 0 A_GiveInventory("BondDualReloadSpamProtector")
  ReloadDoneDual:
    GE26 IHGFEDCBA 1
    TNT1 A 0 A_TakeInventory("BondDualReloadSpamProtector")
    goto ReadyDual

  // Watch
  WatchReady:
	GE13 T 0 A_JumpIfInventory("BondWatchQueue", 1, "RaiseWatch")
	GE13 T 4 A_WeaponReady(WRF_DISABLESWITCH|WRF_NOFIRE)
	Loop

  LowerWatch:
	GE13 T 0 A_Zoomfactor(1.0)
	GE13 T 0 A_TakeInventory("BondWatchActivate", 1)
	GE13 T 0 A_GiveInventory("BondWatchUIDeinit", 1)
	GE13 T 0 ACS_NamedExecuteAlways("BondWatchLookUpAndDown")
    GE13 T 10
  LowerWatchStart:
	GE13 T 0 A_WeaponReady(WRF_DISABLESWITCH|WRF_NOFIRE)
    GE13 TSRQPONMLKJIHGFEDCBA 2
  LowerWatchContinue:
	TNT1 A 0 A_JumpIfInventory("BondDualWieldToken", 1, 1)
	Goto LowerWatchFinish
	TNT1 A 0 A_GunFlash("DualRaise",GFF_NOEXTCHANGE)
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,"LowerWatchContinueFull")
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,"LowerWatchContinueFull")
    goto LowerWatchContinueEmpty

  LowerWatchContinueEmpty:
    GE02 Z 12
    goto LowerWatchFinish

  LowerWatchContinueFull:
    GE00 A 12
    goto LowerWatchFinish

  LowerWatchFinish:
	TNT1 A 0 A_TakeInventory("BondWatchQueue", 1)
	TNT1 A 0 SetPlayerProperty(0, 0, PROP_Frozen)
	TNT1 A 0 A_TakeInventory ("PowerTimeFreezer", 0x7fffffff) 
	TNT1 A 0 A_TakeInventory("BondWatchToken", 1)
	TNT1 A 0 A_TakeInventory("BondWatchUIInit", 1)
	TNT1 A 0 ACS_NamedExecuteAlways("BondWeaponSwitch")
	Goto Ready 

  RaiseWatch:
	TNT1 A 0 A_ZoomFactor(1.0)
	TNT1 A 0 A_TakeInventory("BondAltToggle", 2)
	TNT1 A 0 A_WeaponReady(WRF_DISABLESWITCH|WRF_NOFIRE)
	TNT1 A 0 A_JumpIfInventory("BondWatchToken", 1, "LowerWatch")
	TNT1 A 0 A_GiveInventory("BondWatchActivate", 1)
	TNT1 A 0 A_JumpIfInventory("BondDualWieldToken", 1, 1)
	Goto RaiseWatchContinue
	TNT1 A 0 A_GunFlash("DualLower",GFF_NOEXTCHANGE)
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,"RaiseWatchFull")
    TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,"RaiseWatchFull")
    goto RaiseWatchEmpty

  RaiseWatchEmpty:
    GE02 Z 12
    goto RaiseWatchContinue

  RaiseWatchFull:
    GE00 A 12
    goto RaiseWatchContinue

  RaiseWatchContinue:
	GE13 A 0 A_TakeInventory("BondPitchTokens", 32768)
	GE13 A 0 A_TakeInventory("BondAngleTokens", 131072)
	GE13 A 0 SetPlayerProperty(0, 1, PROP_Frozen)
	GE13 A 0 ACS_NamedExecuteAlways("BondWatchLookUpAndDown")
	//GE13 A 0 A_GiveInventory("Goldeneye_TimeFreezer", 1)
    GE13 ABCDEFGHIJKLMNOPQRST 2
  RaiseWatchFinish:
	TNT1 A 0 A_Zoomfactor(7.5)
	TNT1 A 0 A_GiveInventory("BondWatchUIInit", 1)
	TNT1 A 0 A_GiveInventory("BondWatchToken", 1)
	TNT1 A 0 ACS_NamedExecuteAlways("BondWatchInterface")
	TNT1 A 0 A_TakeInventory("BondWatchQueue", 1)
	Goto Ready
  }
}

// Attack handlers

actor SamsaraGoldenEyeThrowingKnivesSingleAttackHandler : Trigger
{
    States
    {
      // Ammo checking/taking stuff
      Pickup:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,"PickupAttack")
        TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,1)
        stop
        TNT1 A 0 A_TakeInventory("Goldeneye_ThrowingKnivesAmmo",1)
        goto PickupAttack

      // Attack stuff
      PickupAttack:
        TNT1 A 0 A_PlaySound("Goldeneye/KnifeThrow",CHAN_WEAPON)
        TNT1 A 0 A_JumpIfInventory("BondGunAngleFiringSingle",0,"PickupAttackRight5")
        TNT1 A 0 A_JumpIfInventory("BondGunAngleFiringSingle",9,"PickupAttackRight4")
        TNT1 A 0 A_JumpIfInventory("BondGunAngleFiringSingle",8,"PickupAttackRight3")
        TNT1 A 0 A_JumpIfInventory("BondGunAngleFiringSingle",7,"PickupAttackRight2")
        TNT1 A 0 A_JumpIfInventory("BondGunAngleFiringSingle",6,"PickupAttackRight1")
        TNT1 A 0 A_JumpIfInventory("BondGunAngleFiringSingle",5,"PickupAttackCenter")
        TNT1 A 0 A_JumpIfInventory("BondGunAngleFiringSingle",4,"PickupAttackLeft1")
        TNT1 A 0 A_JumpIfInventory("BondGunAngleFiringSingle",3,"PickupAttackLeft2")
        TNT1 A 0 A_JumpIfInventory("BondGunAngleFiringSingle",2,"PickupAttackLeft3")
        TNT1 A 0 A_JumpIfInventory("BondGunAngleFiringSingle",1,"PickupAttackLeft4")
        goto PickupAttackCenter

      PickupAttackRight5:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"PickupAttackRight5Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"PickupAttackRight5Coop")
      PickupAttackRight5DM:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectile",-10+frandom(-0.2,0.2),false,11,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackRight5Coop:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectileCoop",-10+frandom(-0.2,0.2),false,11,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackRight4:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"PickupAttackRight4Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"PickupAttackRight4Coop")
      PickupAttackRight4DM:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectile",-8+frandom(-0.2,0.2),false,11,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackRight4Coop:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectileCoop",-8+frandom(-0.2,0.2),false,11,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackRight3:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"PickupAttackRight3Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"PickupAttackRight3Coop")
      PickupAttackRight3DM:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectile",-6+frandom(-0.2,0.2),false,12,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackRight3Coop:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectileCoop",-6+frandom(-0.2,0.2),false,12,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackRight2:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"PickupAttackRight2Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"PickupAttackRight2Coop")
      PickupAttackRight2DM:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectile",-4+frandom(-0.2,0.2),false,12,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackRight2Coop:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectileCoop",-4+frandom(-0.2,0.2),false,12,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackRight1:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"PickupAttackRight1Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"PickupAttackRight1Coop")
      PickupAttackRight1DM:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectile",-2+frandom(-0.2,0.2),false,12,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackRight1Coop:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectileCoop",-2+frandom(-0.2,0.2),false,12,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackCenter:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"PickupAttackCenterCoop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"PickupAttackCenterCoop")
      PickupAttackCenterDM:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectile",frandom(-0.2,0.2),false,12,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackCenterCoop:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectileCoop",frandom(-0.2,0.2),false,12,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackLeft1:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"PickupAttackLeft1Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"PickupAttackLeft1Coop")
      PickupAttackLeft1DM:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectile",3+frandom(-0.2,0.2),false,10,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackLeft1Coop:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectileCoop",3+frandom(-0.2,0.2),false,10,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackLeft2:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"PickupAttackLeft2Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"PickupAttackLeft2Coop")
      PickupAttackLeft2DM:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectile",7+frandom(-0.2,0.2),false,8,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackLeft2Coop:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectileCoop",7+frandom(-0.2,0.2),false,8,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackLeft3:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"PickupAttackLeft3Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"PickupAttackLeft3Coop")
      PickupAttackLeft3DM:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectile",11+frandom(-0.2,0.2),false,4,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackLeft3Coop:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectileCoop",11+frandom(-0.2,0.2),false,4,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackLeft4:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"PickupAttackLeft4Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"PickupAttackLeft4Coop")
      PickupAttackLeft4DM:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectile",15+frandom(-0.2,0.2),false,0,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackLeft4Coop:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectileCoop",15+frandom(-0.2,0.2),false,0,0,0,frandom(-0.2,0.2))
        stop
    }
}

actor SamsaraGoldenEyeThrowingKnivesDualAttackHandler : Trigger
{
    States
    {
      // Ammo checking/taking stuff
      Pickup:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,"PickupAttack")
        TNT1 A 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo",1,1)
        stop
        TNT1 A 0 A_TakeInventory("Goldeneye_ThrowingKnivesAmmo",1)
        goto PickupAttack

      // Attack stuff
      PickupAttack:
        TNT1 A 0 A_PlaySound("Goldeneye/KnifeThrow",CHAN_WEAPON)
        TNT1 A 0 A_JumpIfInventory("BondGunAngleFiringDual",0,"PickupAttackRight5")
        TNT1 A 0 A_JumpIfInventory("BondGunAngleFiringDual",9,"PickupAttackRight4")
        TNT1 A 0 A_JumpIfInventory("BondGunAngleFiringDual",8,"PickupAttackRight3")
        TNT1 A 0 A_JumpIfInventory("BondGunAngleFiringDual",7,"PickupAttackRight2")
        TNT1 A 0 A_JumpIfInventory("BondGunAngleFiringDual",6,"PickupAttackRight1")
        TNT1 A 0 A_JumpIfInventory("BondGunAngleFiringDual",5,"PickupAttackCenter")
        TNT1 A 0 A_JumpIfInventory("BondGunAngleFiringDual",4,"PickupAttackLeft1")
        TNT1 A 0 A_JumpIfInventory("BondGunAngleFiringDual",3,"PickupAttackLeft2")
        TNT1 A 0 A_JumpIfInventory("BondGunAngleFiringDual",2,"PickupAttackLeft3")
        TNT1 A 0 A_JumpIfInventory("BondGunAngleFiringDual",1,"PickupAttackLeft4")
        goto PickupAttackCenter

      PickupAttackRight5:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"PickupAttackRight5Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"PickupAttackRight5Coop")
      PickupAttackRight5DM:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectile",-10+frandom(-0.2,0.2),false,-11,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackRight5Coop:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectileCoop",-10+frandom(-0.2,0.2),false,-11,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackRight4:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"PickupAttackRight4Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"PickupAttackRight4Coop")
      PickupAttackRight4DM:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectile",-8+frandom(-0.2,0.2),false,-11,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackRight4Coop:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectileCoop",-8+frandom(-0.2,0.2),false,-11,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackRight3:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"PickupAttackRight3Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"PickupAttackRight3Coop")
      PickupAttackRight3DM:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectile",-6+frandom(-0.2,0.2),false,-12,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackRight3Coop:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectileCoop",-6+frandom(-0.2,0.2),false,-12,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackRight2:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"PickupAttackRight2Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"PickupAttackRight2Coop")
      PickupAttackRight2DM:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectile",-4+frandom(-0.2,0.2),false,-12,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackRight2Coop:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectileCoop",-4+frandom(-0.2,0.2),false,-12,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackRight1:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"PickupAttackRight1Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"PickupAttackRight1Coop")
      PickupAttackRight1DM:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectile",-2+frandom(-0.2,0.2),false,-12,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackRight1Coop:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectileCoop",-2+frandom(-0.2,0.2),false,-12,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackCenter:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"PickupAttackCenterCoop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"PickupAttackCenterCoop")
      PickupAttackCenterDM:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectile",frandom(-0.2,0.2),false,-12,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackCenterCoop:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectileCoop",frandom(-0.2,0.2),false,-12,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackLeft1:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"PickupAttackLeft1Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"PickupAttackLeft1Coop")
      PickupAttackLeft1DM:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectile",3+frandom(-0.2,0.2),false,-10,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackLeft1Coop:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectileCoop",3+frandom(-0.2,0.2),false,-10,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackLeft2:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"PickupAttackLeft2Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"PickupAttackLeft2Coop")
      PickupAttackLeft2DM:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectile",7+frandom(-0.2,0.2),false,-8,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackLeft2Coop:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectileCoop",7+frandom(-0.2,0.2),false,-8,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackLeft3:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"PickupAttackLeft3Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"PickupAttackLeft3Coop")
      PickupAttackLeft3DM:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectile",11+frandom(-0.2,0.2),false,-4,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackLeft3Coop:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectileCoop",11+frandom(-0.2,0.2),false,-4,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackLeft4:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"PickupAttackLeft4Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"PickupAttackLeft4Coop")
      PickupAttackLeft4DM:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectile",15+frandom(-0.2,0.2),false,0,0,0,frandom(-0.2,0.2))
        stop

      PickupAttackLeft4Coop:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_KnifeProjectileCoop",15+frandom(-0.2,0.2),false,0,0,0,frandom(-0.2,0.2))
        stop
    }
}

ACTOR Goldeneye_ThrowingKnivesAmmo : Ammo
{
  Inventory.PickupMessage "Picked up a throwing knife."
  Inventory.Amount 1
  Inventory.MaxAmount 6
  Ammo.BackpackAmount 3
  Ammo.BackpackMaxAmount 12
  Inventory.Icon "AMSMN0"
  States
  {
  Spawn:
        TNT1 A 35
        stop
  }
}

Actor Goldeneye_KnifeProjectile
{
	Damage (50)
	Projectile
	Height 8
	Radius 6
	Speed 20
	ExplosionDamage 0
	Gravity 0.33
	Scale 0.5
	BounceType "Doom"	
	WallBounceFactor 0.1
	SeeSound "Goldeneye/KnifeThrow"
	BounceFactor 0.1
	var int user_pitch;
	var int user_damage;
	-NOGRAVITY
	+BOUNCEONACTORS
	+ALLOWBOUNCEONACTORS
	+USEBOUNCESTATE
	+MOVEWITHSECTOR
	+ISMONSTER
	+NODAMAGETHRUST
	+HITTRACER
	+NOEXTREMEDEATH
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_SetUserVar("user_damage",50)
			TNT1 A 0 A_Playsound("Goldeneye/KnifeThrow", CHAN_5, 1.0, true)
			TNT1 A 0 A_SetUserVar("user_pitch", CallACS("BondThrownKnifePitch"))
			TNT1 A 0 A_SetPitch(user_pitch - 90)
			Goto SpawnLoop
		SpawnLoop:	
			TNT1 A 0 A_JumpIf(velx == 0 || vely == 0, "Death")
			GE00 A 1 A_SetPitch(pitch + 15, SPF_INTERPOLATE)
			loop
		Bounce:
			TNT1 A 0 A_StopSound(CHAN_5)
			TNT1 A 0 A_Playsound("Goldeneye/KnifeCollide", CHAN_BODY)
			Goto SpawnLoop
		Bounce.Actor:
			TNT1 A 0 A_Explode(CallACS("BondHitBox",user_damage),8,!XF_HURTSOURCE,0,8)
			TNT1 A 0 A_Playsound("Goldeneye/HitBody", CHAN_BODY)
			Goto SpawnLoop
		Death:
			TNT1 A 0 A_ChangeFlag(THRUACTORS, true)
		DeathLoseInertia:
			TNT1 A 0 A_JumpIfCloser(24, "Remove")
			GE00 A 1 A_SetPitch(pitch + (15/abs(sqrt(velx*2+vely*2)-5)+1), SPF_INTERPOLATE)
			TNT1 A 0 A_CheckFloor("DeathStart")
			loop
		DeathStart:
			TNT1 A 0 A_Playsound("Goldeneye/KnifeCollide", CHAN_BODY)
			TNT1 A 0 A_SetPitch(0)
			TNT1 A 0 A_SetAngle(angle-90)
			TNT1 A 0 A_StopSound(CHAN_5)
		DeathLoop:
			GE00 B 0 A_JumpIfInventory("Goldeneye_ThrowingKnivesAmmo", 0, 2, AAPTR_Target)
			GE00 B 0 A_JumpIfCloser(24, "Remove")
			GE00 B 1
			Loop
		Remove:
			TNT1 A 0 A_GiveInventory("Goldeneye_ThrowingKnivesAmmo", 1, AAPTR_Target)
			TNT1 A 0 A_GiveInventory("Goldeneye_KnifePickup", 1, AAPTR_Target)
			stop
	}
}

Actor Goldeneye_KnifeProjectileCoop : Goldeneye_KnifeProjectile { +THRUSPECIES Species "Player" }

Actor Goldeneye_KnifePickup : CustomInventory
{
	Inventory.PickupMessage "Picked up a throwing knife."
    +AUTOACTIVATE
	States
    {
       Spawn:
         TNT1 A 0
         Stop	 		 
		 
	   Use:
	     TNT1 A 0
         TNT1 A 0 A_PlaySoundEx("Goldeneye/KnifeSwitch", CHAN_ITEM)
		 stop
    }
}

Actor Goldeneye_KnifePickedUpX : MapCoordinate {}
Actor Goldeneye_KnifePickedUpY : MapCoordinate {}
Actor Goldeneye_KnifePickedUpZ : MapCoordinate {}