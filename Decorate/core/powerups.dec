Actor PartialInvisibility : CustomInventory replaces BlurSphere
{
	RenderStyle Add
	Alpha 0.75
	+FLOATBOB
    +VISIBILITYPULSE
    +INVENTORY.PICKUPFLASH
    +INVENTORY.BIGPOWERUP
    +COUNTITEM
	+INVENTORY.QUIET
    Inventory.PickupAnnouncerEntry "partialinvisibility"
    //Inventory.PickupMessage "$SAMSARA_POWERUP_INVIS"
    Inventory.PickupSound "nosoundforyoubitch"
	States
	{
	Spawn:
		NVSI A 0 NoDelay ACS_NamedExecuteWithResult("Samsara_SwitchableObject",2)
		NVSI A 35 BRIGHT ACS_NamedExecuteAlways("SamsaraClientDecorate", 0, 4, 100, 75)
		wait
	Pickup:
		TNT1 A 0 A_JumpIfInventory("DoomguyClass",1,"PickupDoomguy")
		TNT1 A 0 A_JumpIfInventory("CorvusClass",1,"PickupCorvus")
		TNT1 A 0 A_JumpIfInventory("HexenClass",1,"PickupGhost")
		TNT1 A 0 A_JumpIfInventory("DukeClass",1,"PickupDuke")
		TNT1 A 0 A_JumpIfInventory("MarathonClass",1,"PickupMarathon")
		TNT1 A 0 A_JumpIfInventory("QuakeClass",1,"PickupQuake")
		TNT1 A 0 A_JumpIfInventory("StrifeClass",1,"PickupStrife")
		TNT1 A 0 A_JumpIfInventory("WitchavenClass",1,"PickupWitchaven")
		TNT1 A 0 A_JumpIfInventory("HalfLifeClass",1,"PickupTranslucent")
		TNT1 A 0 A_JumpIfInventory("JonClass",1,"PickupJon")
		TNT1 A 0 A_JumpIfInventory("BittermanClass",1,"PickupBitterman")
		TNT1 A 0 A_JumpIfInventory("Hexen2Class",1,"PickupHexen2")
		TNT1 A 0 A_JumpIfInventory("BondClass",1,"PickupTranslucent")
		TNT1 A 0 A_JumpIfInventory("PainkillerClass",1,"PickupTranslucent")
		TNT1 A 0 A_JumpIfInventory("UnrealClass",1,"PickupTranslucent")
		TNT1 A 0 A_JumpIfInventory("RTCWClass",1,"PickupTranslucent")
		TNT1 A 0 A_JumpIfInventory("Q3Class",1,"PickupSarge")
		TNT1 A 0 A_JumpIfInventory("DescentClass",1,"PickupTranslucent")
		TNT1 A 0 A_JumpIfInventory("DeusExClass",1,"PickupDeusEx")
		TNT1 A -1 A_Jump(256,"PickupNormal")
		wait
	PickupNormal:
		TNT1 A 0 ACS_NamedExecute("InvisPickupMessage")
		TNT1 A 0 A_SetBlend("d7ba45", 0.3, 4)
		TNT1 A 0 A_PlaySound("invisibilityget", CHAN_ITEM)
		TNT1 A 1 A_GiveInventory("SamsaraPowerInvisibilityNormalGiver")
		stop
	PickupTranslucent:	// Also used for 3D classes
		TNT1 A 0 ACS_NamedExecute("InvisPickupMessage")
		TNT1 A 0 A_SetBlend("d7ba45", 0.3, 4)
		TNT1 A 0 A_PlaySound("invisibilityget", CHAN_ITEM)
		TNT1 A 1 A_GiveInventory("SamsaraPowerInvisibilityTranslucentGiver")
		stop
	PickupGhost:
		TNT1 A 0 ACS_NamedExecute("InvisPickupMessage")
		TNT1 A 0 A_SetBlend("d7ba45", 0.3, 4)
		TNT1 A 0 A_PlaySound("invisibilityget", CHAN_ITEM)
		TNT1 A 1 A_GiveInventory("SamsaraPowerInvisibilityGhostGiver")
		stop
	PickupDoomguy:
        TNT1 A 0 A_JumpIfInventory("DoomClassMode",2,2)
		TNT1 A 0 A_JumpIfInventory("DoomClassMode",1,"PickupTranslucent")
		TNT1 A -1 A_Jump(256,"PickupNormal")
		wait
	PickupCorvus:
		TNT1 A 0 ACS_NamedExecute("InvisPickupMessage")
		TNT1 A 0 A_SetBlend("d7ba45", 0.3, 4)
		TNT1 A 0 A_PlaySound("heretic/itemget", CHAN_ITEM)
        TNT1 A 1 A_GiveInventory("PortGhostly")
		stop
	PickupDuke:
		TNT1 A 0 ACS_NamedExecute("InvisPickupMessage")
		TNT1 A 0 A_SetBlend("d7ba45", 0.3, 4)
		TNT1 A 0 A_PlaySound("duke/itemget", CHAN_ITEM)
        TNT1 A 1 A_GiveInventory("ItemHoloDuke",3)
		stop
	PickupMarathon:
		TNT1 A 0 ACS_NamedExecute("InvisPickupMessage")
		TNT1 A 0 A_SetBlend("Green",0.5,6)
        TNT1 A 0 A_PlaySound("marathon/bigitemget", CHAN_ITEM)
		TNT1 A 0 A_GiveInventory("SamsaraPowerInvisibilityNormalGiver")
		TNT1 A 1 A_GiveInventory("SamsaraPowerInvisibilityShadowGiver")
		stop
	PickupQuake:
		TNT1 A 0 ACS_NamedExecute("InvisPickupMessage")
		TNT1 A 0 A_SetBlend("d7ba45", 0.3, 4)
		TNT1 A 0 ACS_NamedExecuteAlways("SamsaraDecorate",0,25,0,0)	//TNT1 A 0 A_PlaySoundEx("quake/invisannouncer","soundslot7",0,2)
		TNT1 A 0 A_GiveInventory("QuakeInvisTimer", 1050)
        TNT1 A 1
		stop
	PickupStrife:
		TNT1 A 0 ACS_NamedExecute("InvisPickupMessage")
		TNT1 A 0 A_SetBlend("d7ba45", 0.3, 4)
        TNT1 A 0 A_PlaySound("strife/itemget", CHAN_ITEM)
        TNT1 A 1 A_GiveInventory("PortShadowArmor")
		stop
	PickupWitchaven:
		TNT1 A 0 ACS_NamedExecute("InvisPickupMessage")
		TNT1 A 0 A_SetBlend("d7ba45", 0.3, 4)
		TNT1 A 0 A_PlaySound("gpickup/phial", CHAN_ITEM)
		TNT1 A 1 A_GiveInventory("WTInvisibilityPhial")
		stop
	PickupJon:
		TNT1 A 0 ACS_NamedExecute("InvisPickupMessage")
		TNT1 A 0 A_SetBlend("d7ba45", 0.3, 4)
		TNT1 A 0 A_PlaySound("Jon/FancyItemPick", CHAN_ITEM)
		TNT1 A 1 A_GiveInventory("EyeOfSiaItem_EX")
		stop
	PickupBitterman:
		TNT1 A 0 ACS_NamedExecute("InvisPickupMessage")
		TNT1 A 0 A_SetBlend("d7ba45", 0.3, 4)
		TNT1 A 0 A_PlaySound("Q2Misc/Pickup", CHAN_ITEM)
		TNT1 A 0 A_Jump(128, "PickupBitterman2")
		TNT1 A 1 A_GiveInventory("Q2Silencer")
		stop
	PickupBitterman2:
		TNT1 A 1 A_GiveInventory("Q2DualFireDamage")
		stop	  
	PickupHexen2:
		TNT1 A 0 ACS_NamedExecute("InvisPickupMessage")
		TNT1 A 0 A_SetBlend("d7ba45", 0.3, 4)
		TNT1 A 0 A_PlaySound("hexen2/artifactpickup", CHAN_ITEM)
        TNT1 A 1 A_GiveInventory("PortGhostly2")
		stop
	PickupSarge:
		TNT1 A 0 ACS_NamedExecute("InvisPickupMessage")
		TNT1 A 0 A_SetBlend("d7ba45", 0.3, 4)
		TNT1 A 0 A_PlaySound("Quake3/Items/Invisibility", CHAN_ITEM)
		TNT1 A 1 A_GiveInventory("Q3InvisibilityCloak",1)
		stop
	PickupDeusEx:
		TNT1 A 0 ACS_NamedExecute("InvisPickupMessage")
		TNT1 A 0 A_SetBlend("d7ba45", 0.3, 4)
		TNT1 A 0 A_PlaySound("invisibilityget", CHAN_ITEM)
		TNT1 A 0 A_GiveInventory("DeusEx_EnviroPoints", 100)
		TNT1 A 0 A_JumpIfInventory("DeusEx_EnviroSkill", 4, "PickupDeusExEnviro4")
		TNT1 A 0 A_JumpIfInventory("DeusEx_EnviroSkill", 3, "PickupDeusExEnviro3")
		TNT1 A 0 A_JumpIfInventory("DeusEx_EnviroSkill", 2, "PickupDeusExEnviro2")
		TNT1 A 0 A_JumpIfInventory("DeusEx_EnviroSkill", 1, "PickupDeusExEnviro1")
		TNT1 A 1 A_GiveInventory("SamsaraPowerInvisibilityTranslucentGiver")
		stop
	PickupDeusExEnviro1:
		TNT1 A 1 A_GiveInventory("SamsaraPowerInvisibilityDXEnviro1Giver")
		stop
	PickupDeusExEnviro2:
		TNT1 A 1 A_GiveInventory("SamsaraPowerInvisibilityDXEnviro2Giver")
		stop
	PickupDeusExEnviro3:
		TNT1 A 1 A_GiveInventory("SamsaraPowerInvisibilityDXEnviro3Giver")
		stop
	PickupDeusExEnviro4:
		TNT1 A 1 A_GiveInventory("SamsaraPowerInvisibilityDXEnviro4Giver")
		stop
	PickupFail:
        NVSI A 1 BRIGHT
        fail
	}
}

Actor SamsaraPowerInvisibilityNormal : PowerInvisibility { +SHADOW Powerup.Duration -60 Powerup.Strength 80 Powerup.Mode "Fuzzy" }
Actor SamsaraPowerInvisibilityTranslucent : PowerInvisibility { +SHADOW Powerup.Duration -60 Powerup.Strength 80 Powerup.Mode "Translucent" }
Actor SamsaraPowerInvisibilityGhost : PowerGhost { +GHOST Powerup.Duration -60 Powerup.Strength 60 Powerup.Mode "None" }
Actor SamsaraPowerInvisibilityShadow : PowerShadow { Powerup.Duration -55 Powerup.Strength 75 Powerup.Mode "Cumulative" }

Actor SamsaraPowerInvisibilityNormalGiver : PowerupGiver
{
	Inventory.MaxAmount 0
	Powerup.Type SamsaraPowerInvisibilityNormal
	+INVENTORY.AUTOACTIVATE
	+INVENTORY.ALWAYSPICKUP
	States
	{
	Spawn:
		TNT1 A 2
		loop
	}
}

Actor SamsaraPowerInvisibilityTranslucentGiver : PowerupGiver
{
	Inventory.MaxAmount 0
	Powerup.Type SamsaraPowerInvisibilityTranslucent
	+INVENTORY.AUTOACTIVATE
	+INVENTORY.ALWAYSPICKUP
	States
	{
	Spawn:
		TNT1 A 2
		loop
	}
}

Actor SamsaraPowerInvisibilityGhostGiver : PowerupGiver
{
	Inventory.MaxAmount 0
	Powerup.Type SamsaraPowerInvisibilityGhost
	+INVENTORY.AUTOACTIVATE
	+INVENTORY.ALWAYSPICKUP
	States
	{
	Spawn:
		TNT1 A 2
		loop
	}
}

Actor SamsaraPowerInvisibilityShadowGiver : PowerupGiver
{
	Inventory.MaxAmount 0
	Powerup.Type SamsaraPowerInvisibilityShadow
	+INVENTORY.AUTOACTIVATE
	+INVENTORY.ALWAYSPICKUP
	States
	{
	Spawn:
		TNT1 A 2
		loop
	}
}

actor PortGhostly : PowerupGiver
{
    tag "Shadowsphere"
    inventory.maxamount 16
    inventory.usesound "heretic/itemuse"
    +inventory.undroppable
    +inventory.hubpower
    Inventory.Icon "ARTINVSI"
	Inventory.RestrictedTo "CorvusPlayer"
    Powerup.Type SamsaraPowerInvisibilityGhost
}

actor QuakeInvisTimer: Counter {}

actor PortShadowArmor : PowerupGiver
{
	+FLOORCLIP
	+VISIBILITYPULSE
	+INVENTORY.INVBAR
	+INVENTORY.UNDROPPABLE
	RenderStyle Translucent
	Inventory.MaxAmount 2
	Powerup.Type Shadow
	Inventory.Icon "I_SHDO"
	Inventory.UseSound "strife/itempickup"
	Inventory.PickupSound "strife/itemget"
	Inventory.PickupMessage "Picked up the Shadow Armor."
	Inventory.RestrictedTo "StrifeguyPlayer"  
	Tag "Shadow Armor"
	States
	{
	Spawn:
		SHD1 A -1 Bright
		Stop
	}
}

actor WTInvisibilityPhial : CustomInventory
{
	Tag "Invisibility Potion"
    inventory.maxamount 10
	inventory.interhubamount 10
    inventory.icon "WIN0F0"
    inventory.usesound "gplayer/drink"
	inventory.pickupmessage "You got an invisibility potion!"
	inventory.pickupsound "gpickup/phial"
	Inventory.RestrictedTo "GrondovalPlayer"
	//+INVENTORY.KEEPDEPLETED
	+INVENTORY.INVBAR
	+INVENTORY.UNDROPPABLE
	-PICKUP
	scale 0.5
	states
	{
		Spawn:
			WIN0 E 12
			WIN0 E 0 A_ChangeFlag("PICKUP",1)
			WIN0 E -1 bright
			stop
		Use:
			WIN0 E 0 A_GiveInventory("WTInvisibility",1)
			stop
		FailPotion:
			WIN0 E 0
			fail
	}
}

actor WTInvisibility : PowerInvisibility { +SHADOW Powerup.Duration -30 Powerup.Strength 80 Powerup.Mode "Fuzzy" }

actor EyeOfSiaItem_EX : PowerupGiver
{
	+INVENTORY.INVBAR
	+INVENTORY.UNDROPPABLE
	Inventory.MaxAmount 3
	Powerup.Type SamsaraPowerInvisibilityGhost
	Inventory.Icon "_EX3E0"
	Inventory.UseSound "Jon/itemuse"
	Inventory.PickupMessage "You found the Eye Of Sia!"
	Inventory.RestrictedTo "PSPlayer"
	Tag "Eye of Sia"
}

actor PortGhostly2 : PowerupGiver
{
    tag "Shadowsphere"
    inventory.maxamount 16
    inventory.usesound "hexen2/artiuse"
    +inventory.undroppable
    +inventory.hubpower
    Inventory.Icon "H2INVT08"
	Inventory.RestrictedTo "Demoness"
    Powerup.Type SamsaraPowerInvisibilityGhost
}

Actor SamsaraPowerInvisibilityDXEnviro1 : PowerInvisibility { +SHADOW Powerup.Duration -75 Powerup.Strength 80 Powerup.Mode "Translucent" }
Actor SamsaraPowerInvisibilityDXEnviro2 : PowerInvisibility { +SHADOW Powerup.Duration -90 Powerup.Strength 80 Powerup.Mode "Translucent" }
Actor SamsaraPowerInvisibilityDXEnviro3 : PowerInvisibility { +SHADOW Powerup.Duration -105 Powerup.Strength 80 Powerup.Mode "Translucent" }
Actor SamsaraPowerInvisibilityDXEnviro4 : PowerInvisibility { +SHADOW Powerup.Duration -120 Powerup.Strength 80 Powerup.Mode "Translucent" }

Actor SamsaraPowerInvisibilityDXEnviro1Giver : PowerupGiver
{
	Inventory.MaxAmount 0
	Powerup.Type SamsaraPowerInvisibilityDXEnviro1
	+INVENTORY.AUTOACTIVATE
	+INVENTORY.ALWAYSPICKUP
	States
	{
	Spawn:
		TNT1 A 2
		loop
	}
}

Actor SamsaraPowerInvisibilityDXEnviro2Giver : PowerupGiver
{
	Inventory.MaxAmount 0
	Powerup.Type SamsaraPowerInvisibilityDXEnviro2
	+INVENTORY.AUTOACTIVATE
	+INVENTORY.ALWAYSPICKUP
	States
	{
	Spawn:
		TNT1 A 2
		loop
	}
}

Actor SamsaraPowerInvisibilityDXEnviro3Giver : PowerupGiver
{
	Inventory.MaxAmount 0
	Powerup.Type SamsaraPowerInvisibilityDXEnviro3
	+INVENTORY.AUTOACTIVATE
	+INVENTORY.ALWAYSPICKUP
	States
	{
	Spawn:
		TNT1 A 2
		loop
	}
}

Actor SamsaraPowerInvisibilityDXEnviro4Giver : PowerupGiver
{
	Inventory.MaxAmount 0
	Powerup.Type SamsaraPowerInvisibilityDXEnviro4
	+INVENTORY.AUTOACTIVATE
	+INVENTORY.ALWAYSPICKUP
	States
	{
	Spawn:
		TNT1 A 2
		loop
	}
}

/*
actor InvisTrail
{
    Renderstyle Add
    Alpha 0.35
    Scale 0.95
    -Solid
    +Noclip
    +Nogravity
    +Nointeraction
    +CLIENTSIDEONLY
    States
    {
      Spawn:
        NVSI A 2 A_FadeOut(0.125)
        Loop
    }
}
*/

actor InvulnPowerup : CustomInventory replaces InvulnerabilitySphere
{
    RenderStyle Add
    Alpha 0.95
    +Floatbob
    +INVENTORY.BIGPOWERUP
    +INVENTORY.PICKUPFLASH
    +COUNTITEM
    Inventory.PickupAnnouncerEntry "invulnerability"
    Inventory.PickupMessage "$SAMSARA_POWERUP_INVULN"
    Inventory.PickupSound "nosoundforyoubitch"
    states
    {
      Spawn:
        NVLN A 0 
        TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("SamsaraDecorate",28,0,0) == 1, "NoInvuln")
        NVLN A 35 BRIGHT ACS_NamedExecuteAlways("SamsaraClientDecorate", 0, 4, 100, 95)
        wait
      Pickup:
      PickupInvuln:
        TNT1 A 0 A_JumpIfInventory("HexenClass",1,"PickupInvulnHexen")
		TNT1 A 0 A_JumpIfInventory("Hexen2Class",1,"PickupInvulnHexen2")
        TNT1 A 1 A_JumpIfInventory("CorvusClass",1,"PickupInvulnHeretic")
        TNT1 A 1 A_JumpIfInventory("DukeClass",1,"PickupInvulnDuke")
        TNT1 A 0 A_JumpIfInventory("QuakeClass",1,"PickupInvulnQuake")
		TNT1 A 0 A_JumpIfInventory("RottClass", 1, "PickupInvulnRott")	  
        TNT1 A 1 A_JumpIfInventory("DoomguyClass",1,"PickupInvulnDoomguy")	
		//TNT1 A 1 A_JumpIfInventory("KatarnClass",1,"PickupInvulnKatarn")		
		TNT1 A 1 A_JumpIfInventory("WitchavenClass",1,"PickupInvulnWitchaven")
		TNT1 A 0 A_JumpIfInventory("JonClass", 1, "PickupInvulnJon")		
		TNT1 A 0 A_JumpIfInventory("POGreedClass", 1, "PickupInvulnIPOG")
		TNT1 A 1 A_JumpIfInventory("BittermanClass",1,"PickupInvulnBitterman")
		TNT1 A 0 A_JumpIfInventory("CatacombClass", 1, "PickupInvulnCatacomb")
		TNT1 A 0 A_JumpIfInventory("Q3Class", 1, "PickupInvulnSarge")
        TNT1 A 0 A_PlaySound("invulnget")
        TNT1 A 1 A_GiveInventory("PowerFakeInvulnerable")
        stop
      PickupInvulnDoomguy:
        TNT1 A 0 A_PlaySound("invulnget")
        TNT1 A 0 A_JumpIfInventory("DoomClassMode",2,2)
		TNT1 A 0 A_JumpIfInventory("DoomClassMode",1,"PickupInvulnDoom64")
        TNT1 A 1 A_GiveInventory("PowerFakeInvulnerable")
        stop
      PickupInvulnDoom64:
        TNT1 A 1 A_GiveInventory("PowerFakeInvulnerable64")
        stop
	  PickupInvulnRott:
		TNT1 A 0 A_JumpIfInventory("DogProtection", 1, "PickupFail")
		TNT1 A 0 A_JumpIfInventory("GodProtection", 1, "PickupFail")
		TNT1 A 0 A_Jump(128,"PickupInvulnRott2")
		TNT1 A 0 A_PlaySound("gen/godmode")
		TNT1 A 0 A_GiveInventory("God Hand", 1)
		TNT1 A 0 A_GiveInventory("GodProtection")
		TNT1 A 0 A_Selectweapon("God Hand")
		Stop
	  PickupInvulnRott2:
		TNT1 A 0 A_PlaySound("gen/dogmode")
		TNT1 A 0 A_GiveInventory("Doggie", 1)
		TNT1 A 0 A_GiveInventory("DogProtection")
		TNT1 A 0 ACS_NamedExecuteWithResult("RottDogModeHandler")	
		TNT1 A 0 A_GiveInventory("DogMode")
		TNT1 A 0 A_Selectweapon("Doggie")
		Stop
	  /*PickupInvulnKatarn:
		TNT1 A 0 A_PlaySound("invulnget")
		TNT1 A 1 A_GiveInventory("PowerFakeInvulnerableKatarn")
		stop*/
	  PickupInvulnWitchaven:
		TNT1 A 0 A_PlaySound("gpickup/invul")
		TNT1 A 1 A_GiveInventory("PowerFakeInvulnerable")
		stop
	  PickupInvulnJon:
		TNT1 A 0 A_PlaySound("Jon/SpecialItemPick")
		TNT1 A 1 A_GiveInventory("DivineScarab_Ex")
		stop
	  PickupInvulnIPOG:
	    TNT1 A 0 A_PlaySound("greed/pickup")
		TNT1 A 1 A_GiveInventory("IPOGReversoPill")
		stop
	  PickupInvulnBitterman:
		TNT1 A 0 A_PlaySound("Q2Misc/Pickup")
		TNT1 A 1 A_GiveInventory("Q2Invulnerability")
		stop
      PickupInvulnHeretic:
        TNT1 A 0 A_JumpIfInventory("PortRingInvuln",0,"PickupFail")
        TNT1 A 0 A_PlaySound("heretic/itemget")
        TNT1 A 1 A_GiveInventory("PortRingInvuln")
        stop
      PickupInvulnHexen:
        TNT1 A 0 A_JumpIfInventory("PortIconDefender",0,"PickupFail")
        TNT1 A 0 A_PlaySound("hexen/artiget")
        TNT1 A 1 A_GiveInventory("PortIconDefender")
        stop
      PickupInvulnHexen2:
        TNT1 A 0 A_JumpIfInventory("PortIconDefender2",0,"PickupFail")
        TNT1 A 0 A_PlaySound("hexen2/artifactpickup")
        TNT1 A 1 A_GiveInventory("PortIconDefender2")
        stop		
      PickupInvulnQuake:
        TNT1 A 0 A_GiveInventory("QuakePentTimer", 1050)
        stop
	  PickupInvulnDuke:
		TNT1 A 0 A_PlaySound("invulnget")
        TNT1 A 1 A_GiveInventory("PowerFakeInvulnerableDuke")
        TNT1 A 0 A_JumpIfInventory("DukeBallgag", 1, "PickupStop")
		TNT1 A 0 A_TakeInventory("DukeTauntCooldown")
		TNT1 A 0 A_StopSound(CHAN_7)
        TNT1 A 0 A_GiveInventory("DukeTauntCooldown", 5) // was 15 despite the max being 5
		TNT1 A 0 ACS_NamedExecuteAlways("DukeTauntCooldown")
        TNT1 A 0 A_PlaySoundEx("duke/invuln", "soundslot7", 0, 0)
        stop
	  PickupInvulnCatacomb:
		TNT1 A 0 A_PlaySound("Catacomb/Hourglass", CHAN_ITEM)
		TNT1 A 1 A_GiveInventory("Catacomb_Hourglass", 1)
		Stop
	  PickupInvulnSarge:
		TNT1 A 0 A_PlaySound("Quake3/Items/QuadDamage",CHAN_6)
		TNT1 A 1 A_GiveInventory("Q3QuadDamageFactor",1)
		Stop
      PickupFail:
        NVLN A 1 BRIGHT
        fail
      NoInvuln:
        TNT1 A 1
        stop
	  PickupStop:
        TNT1 A 0
        stop		
    }
}

Actor DivineScarab_Ex : PowerupGiver
{
	+FLOATBOB
    +INVENTORY.UNDROPPABLE
    +INVENTORY.PICKUPFLASH
    +INVENTORY.HUBPOWER	
    Inventory.MaxAmount 2
    Inventory.Icon "_EX3F0"
    Inventory.UseSound "Jon/itemuse"
    Inventory.PickupMessage "You found a Divine Scarab!"
	Inventory.RestrictedTo "PSPlayer"
    Powerup.Type FakeInvulnerable
	Tag "Divine Scarab"
	States
	{
		Spawn:
			NULL A -1
			Stop
	}
}

ACTOR PowerFakeInvulnerable : PowerProtection
{
  Powerup.Duration -30
  //inventory.icon "SPSHLD0"
  Powerup.Color InverseMap
  damagefactor "normal", 0.0
  damagefactor "Pistol", 0.0
  DamageFactor "DoomFist", 0.0
  damagefactor "ZorchPistol", 0.0
  damagefactor "Wraithverge", 0.0
  damagefactor "zorch", 0.0
  damagefactor "fire", 0.0
  damagefactor "ice", 0.0
  damagefactor "slime", 0.0
  damagefactor "bfg", 0.0
  damagefactor "bfgspray", 0.0
  damagefactor "disintegrate", 0.0
  damagefactor "electric", 0.0
  DamageFactor "BFG", 0.0
  DamageFactor "BFGSpray", 0.0
  DamageFactor "Poison", 0.0
  DamageFactor "PoisonCloud", 0.0
  DamageFactor "Mace", 0.0
  DamageFactor "DragonClaw", 0.0
  DamageFactor "WolfenFlamethrower", 0.0
  DamageFactor "DukeDamage", 0.0
  DamageFactor "DukeExplosive", 0.0
  DamageFactor "DukeSpectral", 0.0
  DamageFactor "MightyBoot", 0.0
  DamageFactor "DukeIce", 0.0
  DamageFactor "DukePistol", 0.0
  DamageFactor "MarathonPistol", 0.0
  DamageFactor "Explosive", 0.0
  DamageFactor "DoomPlasma", 0.0
  DamageFactor "CorvusCrossbow", 0.0
  DamageFactor "CorvusHellstaff", 0.0
  DamageFactor "CorvusHellstaffTomed", 0.0
  DamageFactor "MarathonPlasma", 0.0
  DamageFactor "BJSpear", 0.0
  DamageFactor "DoomCacodemon", 0.0
  DamageFactor "DoomHellNoble", 0.0
  DamageFactor "DoomSpiderPlasma", 0.0
  DamageFactor "DoomTheseGuysAreTheBest", 0.0
  DamageFactor "HereNitrogolem", 0.0
  DamageFactor "HereAxeGreen", 0.0
  DamageFactor "HereAxeRed", 0.0
  DamageFactor "Wizard", 0.0
  DamageFactor "HereLichWind", 0.0
  DamageFactor "HereDsparil", 0.0
  DamageFactor "HexBishop", 0.0
  DamageFactor "HexSlaughtaur", 0.0
  DamageFactor "HexGreenFire", 0.0
  DamageFactor "HexStalkerShot", 0.0
  DamageFactor "HexHeresiarchPurple", 0.0
  DamageFactor "QuakePistol", 0.0
  DamageFactor "NotQuadded", 0.0
  DamageFactor "SpectralNoQuad", 0.0

  DamageFactor "MarathonFusion", 1.0
  DamageFactor "Kamikaze", 1.0
  DamageFactor "ZorchKamikaze", 1.0
  DamageFactor "Suicide", 1.0
  DamageFactor "NotSuicide", 0.0		// Used for monsters with suicide attacks
  DamageFactor "Telefrag", 1.0

  DamageFactor "PunchDagger", 0.0
  DamageFactor "StrifePistol", 0.0
  DamageFactor "ElectricBolt", 0.0
  DamageFactor "PoisonBolt", 0.0
  DamageFactor "MiniExplosive", 0.0
  DamageFactor "StrifeExplosive", 0.0
  DamageFactor "PhosFire", 0.0  
  Damagefactor "RottExplosive", 0.0
  DamageFactor "RottFire", 0.0
  DamageFactor "RottBullet", 0.0
  DamageFactor "BlakePlasma", 0.0
  DamageFactor "BlakeBullet", 0.0
  DamageFactor "Dynamite", 0.0
  DamageFactor "LifeLeech", 0.0
  DamageFactor "Tesla", 0.0
  DamageFactor "CalebBullet", 0.0
  DamageFactor "CalebNapalm", 0.0
  DamageFactor "CalebFire", 0.0  
  DamageFactor "C7MineBoom", 0.0
  DamageFactor "EradCoopGreenFire", 0.0  
  DamageFactor "EradCoopExplosive2", 0.0  
  DamageFactor "RMR-BigPlasma", 0.0		
  DamageFactor "RMR-CyanPlasma", 0.0  
  DamageFactor "RMR-YellowPlasma", 0.0  
  DamageFactor "RMR-YellowPlasma2", 0.0    
  DamageFactor "RMR-GreenPlasma", 0.0  
  DamageFactor "RMR-Bullet", 0.0  
  DamageFactor "RMR-DiscoBall", 0.0  
  DamageFactor "PGBullet", 0.0
  DamageFactor "PGPlasma", 0.0
  DamageFactor "PGLaser", 0.0
  DamageFactor "PGFire", 0.0
  DamageFactor "PGExplosive", 0.0  
  DamageFactor "Disruptoruniversaldamageshit4", 0.0
  DamageFactor "Disruptoruniversaldamageshit3", 0.0
  DamageFactor "Disruptoruniversaldamageshit2",	0.0
  DamageFactor "Disruptoruniversaldamageshit1", 0.0
  DamageFactor "DisruptorWall", 0.0
  DamageFactor "WTMelee", 0.0
  DamageFactor "WTRanged", 0.0
  DamageFactor "WTRangedFire", 0.0
  DamageFactor "WTMeleeIce", 0.0
  DamageFactor "WTRangedIce", 0.0
  DamageFactor "Nuke", 0.0
  DamageFactor "HLSqueak", 0.0
  DamageFactor "HLExplosive", 0.0
  DamageFactor "HLRPGExplosive", 0.0
  DamageFactor "HLLaser", 0.0
  DamageFactor "HLBarnacle", 0.0
  DamageFactor "HLBullet", 0.0  
}

actor PowerFakeInvulnerableDuke : PowerFakeInvulnerable { Powerup.Color GoldMap }

actor QuakePentagram: PowerFakeInvulnerable
{
    Powerup.Duration 0x7FFFFFFF
    Powerup.Color "FF 20 00", 0.15
}

actor QuakePentTimer: Counter { inventory.interhubamount 0 }

actor InvulnTrail
{
    Renderstyle Add
    Alpha 0.4
    Scale 0.95
    -Solid
    +Noclip
    +Nogravity
    +Nointeraction
    +CLIENTSIDEONLY
    States
    {
      Spawn:
        NVLN A 2 A_FadeOut(0.125)
        Loop
    }
}

actor PowerFakeInvulnerable64: PowerFakeInvulnerable { Powerup.Color "FF FF FF", 0.35 }
actor PowerFakeInvulnerableKatarn : PowerFakeInvulnerable { Powerup.Color InverseMap }

Actor BioSuit : CustomInventory replaces RadSuit
{
    RenderStyle Add
    Alpha 0.95
    +FLOATBOB
    +INVENTORY.PICKUPFLASH
    +Inventory.AlwaysPickup
    +Inventory.AutoActivate
	Inventory.PickupMessage "$SAMSARA_POWERUP_RADSUIT"
	Inventory.PickupSound "nosoundforyoubitch"
	States
	{
	  Spawn:
			RDST A 0 BRIGHT
			RDST A 35 BRIGHT ACS_NamedExecuteAlways("SamsaraClientDecorate", 0, 4, 100, 95)
			wait
	  Pickup:
			TNT1 A 0 A_JumpIfInventory("RottClass", 1, "PickupRott")
	        TNT1 A 1 A_JumpIfInventory("StrifeClass", 1, "PickupStrife")
			TNT1 A 0 A_JumpIfInventory("Hexen2Class", 1, "PickupHexen2")
	        TNT1 A 0 A_JumpIfInventory("DoomguyClass", 1, "PickupDoomguy")
			TNT1 A 0 A_JumpIfInventory("KatarnClass",1,"PickupKatarn")
			TNT1 A 0 A_JumpIfInventory("WitchavenClass",1,"PickupWitchaven")
			TNT1 A 0 A_JumpIfInventory("BittermanClass",1,"PickupBitterman")
			TNT1 A 0 A_JumpIfInventory("Q3Class",1,"PickupSarge")
			TNT1 A 0 A_PlaySound("antisterileget", CHAN_ITEM)
			TNT1 A 0 A_GiveInventory("BioSuitPowerup")
			Stop
      PickupDoomguy:
			TNT1 A 0 A_PlaySound("antisterileget", CHAN_ITEM)
            TNT1 A 0 A_JumpIfInventory("DoomClassMode",2,2)
			TNT1 A 0 A_JumpIfInventory("DoomClassMode",1,"PickupDoom64")
			TNT1 A 0 A_GiveInventory("BioSuitPowerup")
			Stop
      PickupDoom64:
			TNT1 A 0 A_GiveInventory("BioSuitPowerup64")
			stop
	  PickupRott:
			TNT1 A 0 A_PlaySound("gen/asbestos")
			TNT1 A 0 A_GiveInventory("AsbestosArmor", 1)
			TNT1 A 0 A_GiveInventory("AsbestosIronFeet", 1)
			TNT1 A 0 A_TakeInventory("BulletProofVest", 1)
			TNT1 A 0 ACS_NamedExecuteAlways("RottGasMask",0,0,0,0)
			Stop
	  PickupStrife:
			TNT1 A 0 A_JumpIfInventory("PortEnviSuit", 0, "PickupFail")
			TNT1 A 0 A_PlaySound("strife/itemget")
			TNT1 A 1 A_GiveInventory("PortEnviSuit")
			stop
	  PickupKatarn:
			TNT1 A 0 A_PlaySound("antisterileget", CHAN_ITEM)
			TNT1 A 0 A_GiveInventory("BioSuitPowerupKatarn")
			stop
	  PickupWitchaven:
			TNT1 A 0 A_PlaySound("gpickup/phial")		
			TNT1 A 0 A_GiveInventory("WTFireProofPhial")
			TNT1 A 0 A_GiveInventory("BioSuitPowerup")
			stop
	  PickupBitterman:
			TNT1 A 0 A_PlaySound("Q2Misc/Pickup")
			TNT1 A 0 A_GiveInventory("Q2EnvironmentSuit")
			stop
	  PickupSarge:
			TNT1 A 0 A_PlaySound("Quake3/Items/BioSuit",CHAN_6)
			TNT1 A 0 A_GiveInventory("Q3BattleSuitProtection",1)
			stop
	  PickupHexen2:
			TNT1 A 0 A_PlaySound("Hexen2/RingPickup")
			Goto PickupSuccess
	  PickupSuccess:
			TNT1 A 0 A_GiveInventory("BioSuitPowerup")
			Stop		
	  PickupFail:
			RDST A 1 BRIGHT
			fail
	}
}

ACTOR BioSuitPowerup : PowerupGiver { -COUNTITEM +Inventory.AutoActivate Powerup.Type "IronFeet" Powerup.Duration -60 Powerup.Color "Green", 0.125 Inventory.MaxAmount 0 }
ACTOR BioSuitPowerupKatarn : PowerupGiver { -COUNTITEM +Inventory.AutoActivate Powerup.Type "IronFeet" Powerup.Duration -60 Powerup.Color "Green", 0.00 Inventory.MaxAmount 0 }
ACTOR BioSuitPowerup64 : PowerupGiver { -COUNTITEM +Inventory.AutoActivate Powerup.Type "IronFeet" Powerup.Duration -60 Powerup.Color "Green", 0.15 Inventory.MaxAmount 0 }

actor BioTrail
{
    Renderstyle Add
    Alpha 0.4
    Scale 0.95
    -Solid
    +Noclip
    +Nogravity
    +Nointeraction
    +CLIENTSIDEONLY
    States
    {
      Spawn:
        RDST A 2 A_FadeOut(0.125)
        Loop
    }
}

actor PortEnviSuit : PowerupGiver
{
	+FLOORCLIP
	+INVENTORY.INVBAR
	+INVENTORY.PICKUPFLASH
	+INVENTORY.UNDROPPABLE
	Inventory.MaxAmount 5
	Powerup.Type "IronFeet"
	Inventory.Icon "I_GASM"
	Inventory.UseSound "strife/itempickup"
	Inventory.PickupSound "strife/itemget"
	Inventory.PickupMessage "You picked up the Environmental Suit."
	Inventory.RestrictedTo "StrifeguyPlayer"  
	Tag "Environmental Suit"
	States
	{
	Spawn:
		MASK A -1
		Stop
	}
}

actor WTFireProofPhial : CustomInventory
{
	Tag "Fire Immunity Potion"
    inventory.maxamount 10
	inventory.interhubamount 10
    inventory.icon "WIN0D0"
    inventory.usesound "gplayer/drink"
	inventory.pickupmessage "You got a fire immunity potion!"
	inventory.pickupsound "gpickup/phial"
	Inventory.RestrictedTo "GrondovalPlayer"
	//+INVENTORY.KEEPDEPLETED
	+INVENTORY.INVBAR
	-PICKUP
	scale 0.5
	states
	{
		Spawn:
			WIN0 C 12
			WIN0 C 0 A_ChangeFlag("PICKUP",1)
			WIN0 C -1 bright
			stop
		Use:
			WIN0 C 0 A_GiveInventory("WTFireProof",1)
			stop
		FailPotion:
			WIN0 C 0
			fail
	}
}

actor WTFireProof : PowerProtection 
{ 
	Powerup.Duration -30 
	Powerup.Color "OrangeRed", 0.25
	DamageFactor "Fire", 0.0
	DamageFactor "TotenkopfFire", 0.0
	DamageFactor "PhosFireCoop", 0.0
	DamageFactor "PGFire", 0.0
	DamageFactor "HexGreenFire", 0.0
	DamageFactor "QuakeFire", 0.0
	DamageFactor "WTRangedFire", 0.0
	DamageFactor "FireExplosive", 0.0
	DamageFactor "WolfenFlamethrower", 0.0
	DamageFactor "MarathonPlasma", 0.0
	DamageFactor "RottFire", 0.0
	DamageFactor "Hexen2Fire", 0.0
	DamageFactor "SWFlame", 0.0
    DamageFactor "SWFlame2", 0.0
    DamageFactor "SWFlame2Coop", 0.0
	DamageFactor "SWFlame3", 0.0
	DamageFactor "PSFire", 0.0
}

actor Visor : CustomInventory replaces Infrared
{
    RenderStyle Add
    Alpha 0.85
    +Floatbob
    +INVENTORY.PICKUPFLASH
    Inventory.PickupMessage "$SAMSARA_POWERUP_INFRARED"
    Inventory.PickupSound "nosoundforyoubitch"
    States
    {
      Spawn:
        VISR A 0 NoDelay ACS_NamedExecuteWithResult("Samsara_SwitchableObject",1)
      Spawn2:
        VISR A 20 Bright ACS_NamedExecuteAlways("SamsaraClientDecorate", 0, 4, 100, 85) //A_SpawnItemEx("VisorTrail", 0, 0, 2.5, 0, 0, 0, 0, 128)
        VISR A 20
        loop
      Pickup:
        TNT1 A 0 A_JumpIfInventory("MarathonClass",1,"PickupMarathon")
        TNT1 A 0 A_JumpIfInventory("DukeClass",1,"PickupDuke")
        TNT1 A 0 A_JumpIfInventory("HexenClass",1,"PickupHexen")
		TNT1 A 0 A_JumpIfInventory("Hexen2Class",1,"PickupHexen2")
        TNT1 A 1 A_JumpIfInventory("CorvusClass",1,"PickupHeretic")
		TNT1 A 0 A_JumpIfInventory("CalebClass", 1, "PickupCaleb")
		TNT1 A 0 A_JumpIfInventory("RottClass", 1, "PickupRott")		
		TNT1 A 0 A_JumpIfInventory("JonClass", 1, "PickupJon")		
		TNT1 A 0 A_JumpIfInventory("Q3Class", 1, "PickupSarge")		
        TNT1 A 0 A_PlaySound("lettherebelight")
        TNT1 A 1 A_GiveInventory("Infrared")
        stop
	  PickupCaleb:
		TNT1 A 0 A_Playsound("Caleb/Powerup")
		TNT1 A 0 A_GiveInventory("BeastVision")
		Stop
	  PickupRott:
		TNT1 A 0 A_PlaySound("gen/vest")
        TNT1 A 1 A_GiveInventory("Infrared")		
		TNT1 A 0 A_GiveInventory("BulletProofVest")
		TNT1 A 0 A_TakeInventory("AsbestosArmor", 1)
		TNT1 A 0 A_TakeInventory("AsbestosIronFeet", 1)
		Stop
	  PickupJon:
		TNT1 A 0 A_PlaySound("Jon/NoramItemPick")
        TNT1 A 1 A_GiveInventory("LighterofGumercindo_EX")		
		Stop
      PickupHeretic:
        TNT1 A 0 A_JumpIfInventory("PortTorch",0,"PickupFail")
        TNT1 A 0 A_PlaySound("heretic/itemget")
        TNT1 A 1 A_GiveInventory("PortTorch")
        stop
      PickupHexen:
        TNT1 A 0 A_JumpIfInventory("PortTorch2",0,"PickupFail")
        TNT1 A 0 A_PlaySound("hexen/artiget")
        TNT1 A 1 A_GiveInventory("PortTorch2")
        stop
      PickupHexen2:
        TNT1 A 0 A_JumpIfInventory("PortTorch3",0,"PickupFail")
        TNT1 A 0 A_PlaySound("hexen/artiget")
        TNT1 A 1 A_GiveInventory("PortTorch3")
        stop		
      PickupDuke:
        TNT1 A 0 A_JumpIfInventory("DukeVisionFuel",0,"PickupFail")
        TNT1 A 0 A_PlaySound("Duke/itemget")
        TNT1 A 1 A_GiveInventory("DukePortNiVi")
        TNT1 A 1 A_GiveInventory("DukeVisionFuel",100)
        stop
      PickupMarathon:
        TNT1 A 0 A_PlaySound("marathon/bigitemget")
        TNT1 A 1 A_GiveInventory("MarathonInfrared")
        stop
	  PickupSarge:
		TNT1 A 0 A_PlaySound("Quake3/Items/Haste",CHAN_6)
		TNT1 A 1 A_GiveInventory("Q3HasteTurbo",1)
		Stop
      PickupFail:
        VISR A 1 BRIGHT
        fail		
    }
}

actor MarathonInfrared : PowerLightAmp { Powerup.Color BlueMap }

actor VisorTrail
{
    Renderstyle Add
    Alpha 0.4
    Scale 0.95
    -Solid
    +Noclip
    +Nogravity
    +Nointeraction
    +CLIENTSIDEONLY
    States
    {
      Spawn:
        VISR A 2 A_FadeOut(0.125)
        Loop
    }
}

Actor LighterofGumercindo_EX : PowerupGiver
{    
	+FLOATBOB
    +INVENTORY.UNDROPPABLE
    +INVENTORY.PICKUPFLASH
    Inventory.MaxAmount 6
    Inventory.Icon "_EX3D0"
    Inventory.UseSound "Jon/itemuse"
    Inventory.PickupMessage "You picked up a Lighter of Gumercindo!"
	Inventory.RestrictedTo "PSPlayer"
    Powerup.Type Torch
	Tag "Lighter of Gumercindo"
	States
	{
		Spawn:
			NULL A -1
			Stop
	}
}

Actor SamsaraAllMap : AllMap replaces AllMap
{
    RenderStyle Add
    Alpha 0.85
	Scale 0.3
    +Floatbob
    +INVENTORY.PICKUPFLASH	
	Inventory.PickupMessage "You found a map of the area!"
    Inventory.PickupSound "igotamap"
	States
	{
		 Spawn:
			TNT1 A 0 NoDelay ACS_NamedExecuteWithResult("Samsara_SwitchableObject",0)
		  Spawn2:
			AMAP A 20 Bright //A_SpawnItemEx("VisorTrail", 0, 0, 2.5, 0, 0, 0, 0, 128)
			AMAP A 20
			loop	
		Pickup:
			TNT1 A 1
			TNT1 A 1 A_GiveInventory("AllMap")
			stop	
	}
}			

actor PortTorch : PowerupGiver
{
    tag "Torch"
    +FLOATBOB
    +INVENTORY.UNDROPPABLE
    +INVENTORY.PICKUPFLASH
    Inventory.MaxAmount 16
    Inventory.Icon ARTITRCH
    Inventory.UseSound "heretic/itemuse"
    Inventory.PickupMessage "You picked up a Torch!"
	Inventory.RestrictedTo "CorvusPlayer"
    Powerup.Type Torch
    States
    {
      Spawn:
        TRCH ABC 3 Bright
        Loop
    }
}

actor PortRingInvuln : PowerupGiver
{
    tag "Ring of Invulnerability"
    +INVENTORY.UNDROPPABLE
    +inventory.hubpower
    Inventory.MaxAmount 16
    Inventory.Icon "ARTIINVU"
    Powerup.Type FakeInvulnerable
    inventory.usesound "heretic/itemuse"
	Inventory.RestrictedTo "CorvusPlayer"
    Powerup.Color GoldMap
}

actor PortTorch2 : PowerupGiver
{
    tag "Torch"
    +FLOATBOB
    +INVENTORY.UNDROPPABLE
    +INVENTORY.PICKUPFLASH
    Inventory.MaxAmount 16
    Inventory.Icon ARTITRCH
    Inventory.UseSound "hexen/artiuse"
    Inventory.PickupMessage "You picked up a Torch!"
	Inventory.RestrictedTo "HexenPlayer"
    Powerup.Type Torch
    States
    {
      Spawn:
        TRCH ABC 3 Bright
        Loop
    }
}

actor PortTorch3 : PowerupGiver
{
    tag "Torch"
    +FLOATBOB
    +INVENTORY.UNDROPPABLE
    +INVENTORY.PICKUPFLASH
    Inventory.MaxAmount 16
    Inventory.Icon "H2INVT03"
    Inventory.UseSound "hexen2/artiuse"
    Inventory.PickupMessage "You picked up a Torch!"
	Inventory.RestrictedTo "Demoness"
    Powerup.Type Torch
}	

actor PortIconDefender : PowerupGiver
{
    tag "Icon of the Defender"
    +INVENTORY.UNDROPPABLE
    +inventory.hubpower
    Inventory.MaxAmount 16
    Inventory.Icon "ARTIDFND"
    Powerup.Type Invulnerable
    inventory.usesound "hexen/artiuse"
	Inventory.RestrictedTo "HexenPlayer"
    Powerup.Color Grey, 0.1
}

actor PortIconDefender2 : PowerupGiver
{
    tag "Icon of the Defender"
    +INVENTORY.UNDROPPABLE
    +inventory.hubpower
    Inventory.MaxAmount 16
    Inventory.Icon "H2INVT07"
    Powerup.Type Invulnerable
    inventory.usesound "hexen2/artiuse"
	Inventory.RestrictedTo "Demoness"
    Powerup.Color Grey, 0.1
}