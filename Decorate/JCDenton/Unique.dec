Actor DeusEx_LAMMayPlant : Boolean {}

Actor DeusEx_LAM : DeusExWeapon
{
	Weapon.SelectionOrder 1900
	Weapon.SlotNumber 9
	Weapon.SlotPriority 0
	Weapon.AmmoType "RocketAmmo"
	Weapon.AmmoUse 1
	Weapon.AmmoGive 5
	Tag "LightWeight Attack Munition"
	+WEAPON.EXPLOSIVE
	+WEAPON.NOAUTOFIRE
	Weapon.UpSound "DeusEx/LAM/Select"
	Inventory.PickupMessage "You found a LAM."
	Obituary "%o was blown up with %k's LAM."
	States
	{
		Spawn:
			DX99 A -1
			Stop
		Select:
			TNT1 AAAAAAAAAAAAAAAAAAAA 0 A_Raise
			TNT1 A 1 A_Raise
			loop
		Ready:
			DX00 B 0 ACS_NamedExecuteWithResult("DeusEx_LAMTrigger")
			DX00 B 0 A_JumpIfInventory("RocketAmmo", 1, 1)
			Goto ReadyNothing
			DX00 B 0 A_GiveInventory("DeusEx_LAMEquipped", 1)
			DX00 BCDEFGHIJKLM 2
			DX00 A 0 A_TakeInventory("DeusEx_Reloading", 1)
			Goto ReadyLoop
		ReadyLoop:
			DX00 A 1 A_WeaponReady DX00 A 0 A_Jump(4,"Idle1", "Idle2", "Idle3") DX00 A 0 A_JumpIfInventory("DeusEx_LAMMayPlant", 1, "MayPlant")
			Loop
		MayPlant:
			DX00 "\]" 5
			DX01 AB 5
		PlantLoop:
			DX01 C 1 A_WeaponReady DX01 C 0 A_JumpIfInventory("DeusEx_LAMMayPlant", 1, "PlantLoop")
			Goto CantPlant
		CantPlant:
			DX01 D 0
			DX01 EFGH 5
			Goto ReadyLoop
		Idle1:
			DX01 OPQRSTUV 5 A_WeaponReady
			Goto ReadyLoop
		Idle2:
			DX01 "WXYZ[\]" 5 A_WeaponReady
			DX02 A 5 A_WeaponReady
			Goto ReadyLoop
		Idle3:
			DX02 BCDEFGHI 5 A_WeaponReady
			Goto ReadyLoop
		Fire:
			DX00 N 0 A_JumpIfInventory("RocketAmmo", 1, 1)
			Goto Deselect
			DX00 N 0 A_JumpIfInventory("DeusEx_LAMMayPlant", 1, "FirePlant")
			DX00 NOPQRS 2
			DX00 U 0 A_JumpIfInventory("CoopModeOn",1,2)
			DX00 U 2 A_FireCustomMissile("DeusEx_LAMProjectile", Random(-3,3), 1, 16, 5, 0, 5)
			Goto FireEnd
			DX00 U 2 A_FireCustomMissile("DeusEx_LAMProjectileCoop", Random(-3,3), 1, 16, 5, 0, 5)
			Goto FireEnd
		FireEnd:
			DX00 V 2
			Goto GrabAnother
		FirePlant:
			DX01 IJ 2
			DX01 K 2 A_FireCustomMissile("DeusEx_LAMPlantMissile", 0, 0, 4, 16)
			DX01 LMN 2
			Goto GrabAnother
		GrabAnother:
			TNT1 A 0 A_JumpIfInventory("RocketAmmo", 1, "ReloadSuccess")
			Goto ReadyNothing
		ReloadSuccess:
			DX00 B 0 A_PlaySound("DeusEx/LAM/Select", CHAN_WEAPON)
			DX00 BCDEFGHIJKLM 2
			Goto ReadyLoop
		ReadyNothing:
			TNT1 A 0 A_JumpIfInventory("RocketAmmo", 1, "ReloadSuccess")
			TNT1 A 1 A_WeaponReady
			Loop
		Deselect:
			DX00 W 0 A_JumpIfInventory("RocketAmmo", 1, 1)
			Goto DeselectNothing
			DX00 W 0 A_GiveInventory("DeusEx_LAMEquipped", 1)
			DX00 W 0 A_GiveInventory("DeusEx_Reloading", 1)
			DX00 "WXYZ[" 2 
			Goto Super::InstantDeselect
		DeselectNothing:
			TNT1 AA 1
			Goto Super::InstantDeselect
	}
}

Actor DeusEX_LAMTrigger : Trigger
{
	States
	{
		Pickup:
			TNT1 A 0 A_FireCustomMissile("DeusEx_LAMWallMissile")
			Stop
	}
}

Actor DeusEx_LAMProjectile
{
	Projectile
	-NOGRAVITY
	+BOUNCEONWALLS
	+BOUNCEONCEILINGS
	+BOUNCEONFLOORS
	+FORCERADIUSDMG
	+USEBOUNCESTATE
	BounceSound "DeusEx/LAM/Bounce"
	BounceType Doom
	BounceCount 5
	Radius 5
	Height 5
	Gravity 0.66
	Speed 12
	Damage (1)
	DamageType "DeusExLAM"
	Var Int User_Angle;
	States
	{
		Spawn:
			TNT1 A 0 NoDelay A_Jump(128,2)
			TNT1 A 0 A_SetUserVar(User_Angle,Random(1,6))
			Goto SpawnLoop
			TNT1 A 0 A_SetUserVar(User_Angle,Random(-6,-1))
			Goto SpawnThrust
		SpawnThrust:
			DX00 A 0 ThrustThingZ(0,10,0,1)
			Goto SpawnLoop
		SpawnLoop:
			DX00 A 0 A_JumpIfInventory("DeusEx_LAMTimer", 0, "Detonate")
			DX00 A 0 A_SetAngle(Angle+User_Angle)
			DX00 AAABB 1 A_SetPitch(Pitch-15)
			DX00 B 1 A_GiveInventory("DeusEx_LAMTimer", 1)
			Loop
		Bounce:
			DX00 A 0 A_ChangeFlag("USEBOUNCESTATE",0)
			DX00 A 0 A_JumpIfInventory("DeusEx_LAMTimer", 0, "Detonate")
			DX00 A 0 A_SetAngle(Angle+User_Angle)
			DX00 AAABB 1 A_SetPitch(Pitch-15)
			DX00 B 1 A_GiveInventory("DeusEx_LAMTimer", 1)
			Goto OnFloor+1
		OnFloor:
			DX00 A 0 A_GiveInventory("DeusEx_LAMTimer",1)
			DX00 ABABAB 3 A_JumpIfInventory("DeusEx_LAMTimer",0,"Detonate")
			Loop
		Death:
			RW00 A 0 A_Stop
			RW00 A 0 A_JumpIfInventory("DeusEx_LAMTimer",0,"Detonate")
			Goto OnFloor
		Detonate:
			DX00 A 3 A_AlertMonsters(72)
			DX00 B 3 A_PlaySound("DeusEx/LAM/Beep", CHAN_BODY)
			DX00 A 3 A_AlertMonsters(72)
			DX00 B 3 A_PlaySound("DeusEx/LAM/Beep", CHAN_BODY)
			DX00 A 3 A_AlertMonsters(72)
			DX00 B 3 A_PlaySound("DeusEx/LAM/Beep", CHAN_BODY)
			DX00 A 3 A_AlertMonsters(72)
			DX00 B 3 A_PlaySound("DeusEx/LAM/Beep", CHAN_BODY)
			DX00 A 3 A_AlertMonsters(72)
			DX00 B 3 A_PlaySound("DeusEx/LAM/Beep", CHAN_BODY)
			DX00 A 3 A_AlertMonsters(72)
			Goto XPlode
		Crash:
		XDeath:
		XPlode:
			TNT1 A 0 A_CheckCeiling(1)
			Goto XPlode+2
			TNT1 A 0 A_SpawnItemEx("DeusEx_ExplosionCraterCeiling")
			TNT1 A 0 A_CheckFloor(1)
			Goto XPlode+4
			TNT1 A 0 A_SpawnItemEx("DeusEx_ExplosionCraterFloor")
			TNT1 A 0 A_PlaySound("DeusEx/LAM/Explode", CHAN_BODY)
			TNT1 A 0 A_AlertMonsters(2400)
			TNT1 AAAAAAAA 0 A_SpawnItemEx("DeusEx_FireCometLAM",0,0,0,frandom(2.0,6.0),0,frandom(4.0,8.0),random(0,360))
			TNT1 A 0 A_SpawnItemEX("DeusEx_ExplosionMid", 0,0,0,0,0,0,0, SXF_NOCHECKPOSITION|SXF_CLIENTSIDE)
			TNT1 A 0 A_SpawnItemEX("DeusEx_ShockWaveSpawner", 0,0,0,0,0,0,0, SXF_NOCHECKPOSITION|SXF_CLIENTSIDE)
			TNT1 A 2 A_Explode(CallACS("DeusEx_WeaponSkillDamage", 2, 50), 77)
			TNT1 A 0 A_SpawnItemEx("DeusEx_SmokeTrail",0,0,0,frandom(-0.25,0.25),frandom(-0.25,0.25),1.0)
			TNT1 A 2 A_Explode(CallACS("DeusEx_WeaponSkillDamage", 2, 50), 154)
			TNT1 A 0 A_SpawnItemEx("DeusEx_SmokeTrail",0,0,0,frandom(-0.25,0.25),frandom(-0.25,0.25),1.0)
			TNT1 A 2 A_Explode(CallACS("DeusEx_WeaponSkillDamage", 2, 50), 230)
			TNT1 A 0 A_SpawnItemEx("DeusEx_SmokeTrail",0,0,0,frandom(-0.25,0.25),frandom(-0.25,0.25),1.0)
			TNT1 A 2 A_Explode(CallACS("DeusEx_WeaponSkillDamage", 2, 50), 307)
			TNT1 A 0 A_SpawnItemEx("DeusEx_SmokeTrail",0,0,0,frandom(-0.25,0.25),frandom(-0.25,0.25),1.0)
			TNT1 A 2 A_Explode(CallACS("DeusEx_WeaponSkillDamage", 2, 50), 384)
			TNT1 AAAAAAAAA 2 A_SpawnItemEx("DeusEx_SmokeTrail",0,0,0,frandom(-0.25,0.25),frandom(-0.25,0.25),1.0)
			Stop
	}
}

Actor DeusEx_LAMProjectileCoop : DeusEx_LAMProjectile { Species "Player" +THRUSPECIES }

Actor DeusEx_LAMWallMissile : DeusExBullet
{
	Damage(0)
	+THRUACTORS
	Speed 32
	Decal None
	States
	{
		Spawn:
			TNT1 A 0 NODELAY
			TNT1 A 1 A_TakeFromTarget("DeusEx_LAMMayPlant", 999)
			Stop
		XDeath:
		Crash:
			TNT1 A 0 
			TNT1 A 1 A_TakeFromTarget("DeusEx_LAMMayPlant", 999)
			Stop
		Death:
			TNT1 A 0 //A_PlaySound("DeusEx/Knife/HitHard", CHAN_BODY)
			TNT1 A 1 A_GiveToTarget("DeusEx_LAMMayPlant", 1)
			Stop
	}
}

Actor DeusEx_LAMStatic
{
	+LOOKALLAROUND
	+ISMONSTER
	-COUNTKILL
	-SHOOTABLE
	+VULNERABLE
	+NOGRAVITY
	+MOVEWITHSECTOR
	+THRUACTORS
	+NOBLOOD
	+FORCERADIUSDMG
	Speed 0
	Mass 10000
	Health 10
	DamageType "DeusExLAM"
	Height 5
	Radius 5
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_TransferPointer(AAPTR_TRACER,AAPTR_DEFAULT,AAPTR_TARGET,AAPTR_MASTER)
			TNT1 A 0 A_CopyFriendliness(AAPTR_MASTER)
			TNT1 A 0 A_CheckFloor("SetFloor")
			TNT1 A 0 A_CheckCeiling("SetCeiling")
			DX00 A 0 A_SetAngle(angle)
		Set:
			DX00 A 0 A_SetPitch(0)
			Goto Prime
		SetFloor:
			DX01 A 0 A_SetPitch(270)
			Goto Prime
		SetCeiling:
			DX02 A 0 A_SetPitch(90)
			Goto Prime
		Prime:
			"####" A 0 A_SpawnItemEx("DeusEx_LAMStaticGlow",0,0,0,0,0,0,0,SXF_TRANSFERPITCH)
			"####" "#" 0 A_PlaySound("DeusEx/LAM/Beep", CHAN_BODY)
			"####" AAAA 3 A_LookEx(0, 0, 128, 128, 0, "Detonate")
			"####" A 0 A_SpawnItemEx("DeusEx_LAMStaticGlow",0,0,0,0,0,0,0,SXF_TRANSFERPITCH)
			"####" "#" 0 A_PlaySound("DeusEx/LAM/Beep", CHAN_BODY)
			"####" AAAA 3 A_LookEx(0, 0, 128, 128, 0, "Detonate")
			"####" A 0 A_SpawnItemEx("DeusEx_LAMStaticGlow",0,0,0,0,0,0,0,SXF_TRANSFERPITCH)
			"####" "#" 0 A_PlaySound("DeusEx/LAM/Beep", CHAN_BODY)
			"####" AAAA 3 A_LookEx(0, 0, 128, 128, 0, "Detonate")
			"####" A 0 A_SpawnItemEx("DeusEx_LAMStaticGlow",0,0,0,0,0,0,0,SXF_TRANSFERPITCH)
			"####" "#" 0 A_PlaySound("DeusEx/LAM/Beep", CHAN_BODY)
			"####" AAA 3 A_LookEx(0, 0, 128, 128, 0, "Detonate")
			"####" A 0 A_SpawnItemEx("DeusEx_LAMStaticGlow",0,0,0,0,0,0,0,SXF_TRANSFERPITCH)
			"####" "#" 0 A_PlaySound("DeusEx/LAM/Beep", CHAN_BODY)
			"####" AAA 3 A_LookEx(0, 0, 128, 128, 0, "Detonate")
			"####" A 0 A_SpawnItemEx("DeusEx_LAMStaticGlow",0,0,0,0,0,0,0,SXF_TRANSFERPITCH)
			"####" "#" 0 A_PlaySound("DeusEx/LAM/Beep", CHAN_BODY)
			"####" AAA 3 A_LookEx(0, 0, 128, 128, 0, "Detonate")
			"####" A 0 A_SpawnItemEx("DeusEx_LAMStaticGlow",0,0,0,0,0,0,0,SXF_TRANSFERPITCH)
			"####" "#" 0 A_PlaySound("DeusEx/LAM/Beep", CHAN_BODY)
			"####" AA 3 A_LookEx(0, 0, 128, 128, 0, "Detonate")
			"####" A 0 A_SpawnItemEx("DeusEx_LAMStaticGlow",0,0,0,0,0,0,0,SXF_TRANSFERPITCH)
			"####" "#" 0 A_PlaySound("DeusEx/LAM/Beep", CHAN_BODY)
			"####" AA 3 A_LookEx(0, 0, 128, 128, 0, "Detonate")
			"####" A 0 A_SpawnItemEx("DeusEx_LAMStaticGlow",0,0,0,0,0,0,0,SXF_TRANSFERPITCH)
			"####" "#" 0 A_PlaySound("DeusEx/LAM/Beep", CHAN_BODY)
			"####" AA 3 A_LookEx(0, 0, 128, 128, 0, "Detonate")
			"####" A 0 A_SpawnItemEx("DeusEx_LAMStaticGlow",0,0,0,0,0,0,0,SXF_TRANSFERPITCH)
			"####" "#" 0 A_PlaySound("DeusEx/LAM/Beep", CHAN_BODY)
			"####" AA 2 A_LookEx(0, 0, 128, 128, 0, "Detonate")
			"####" A 0 A_SpawnItemEx("DeusEx_LAMStaticGlow",0,0,0,0,0,0,0,SXF_TRANSFERPITCH)
			"####" "#" 0 A_PlaySound("DeusEx/LAM/Beep", CHAN_BODY)
			"####" AA 2 A_LookEx(0, 0, 128, 128, 0, "Detonate")
			"####" A 0 A_SpawnItemEx("DeusEx_LAMStaticGlow",0,0,0,0,0,0,0,SXF_TRANSFERPITCH)
			"####" "#" 0 A_PlaySound("DeusEx/LAM/Beep", CHAN_BODY)
			"####" AA 2 A_LookEx(0, 0, 128, 128, 0, "Detonate")
			Goto SpawnLoop
		SpawnLoop:
			"####" A 0 A_SpawnItemEx("DeusEx_LAMStaticGlow",0,0,0,0,0,0,0,SXF_TRANSFERPITCH)
			"####" AAAA 1 A_LookEx(0, 0, 128, 128, 0, "Detonate")
			Loop
		Detonate:
			"####" "##" 2 A_SpawnItemEx("DeusEx_LAMStaticGlow",0,0,0,0,0,0,0,SXF_TRANSFERPITCH)
			"####" "#" 0 A_PlaySound("DeusEx/LAM/Beep", CHAN_BODY)
			"####" "##" 2 A_SpawnItemEx("DeusEx_LAMStaticGlow",0,0,0,0,0,0,0,SXF_TRANSFERPITCH)
			"####" "#" 0 A_PlaySound("DeusEx/LAM/Beep", CHAN_BODY)
			"####" "##" 2 A_SpawnItemEx("DeusEx_LAMStaticGlow",0,0,0,0,0,0,0,SXF_TRANSFERPITCH)
			"####" "#" 0 A_PlaySound("DeusEx/LAM/Beep", CHAN_BODY)
			"####" "##" 2 A_SpawnItemEx("DeusEx_LAMStaticGlow",0,0,0,0,0,0,0,SXF_TRANSFERPITCH)
			"####" "#" 0 A_PlaySound("DeusEx/LAM/Beep", CHAN_BODY)
			"####" "##" 2 A_SpawnItemEx("DeusEx_LAMStaticGlow",0,0,0,0,0,0,0,SXF_TRANSFERPITCH)
			"####" "#" 0 A_PlaySound("DeusEx/LAM/Beep", CHAN_BODY)
			"####" "##" 2 A_SpawnItemEx("DeusEx_LAMStaticGlow",0,0,0,0,0,0,0,SXF_TRANSFERPITCH)
			"####" "#" 0 A_PlaySound("DeusEx/LAM/Beep", CHAN_BODY)
		Death:	
			TNT1 A 0 A_CheckCeiling(1)
			Goto Death+2
			TNT1 A 0 A_SpawnItemEx("DeusEx_ExplosionCraterCeiling")
			TNT1 A 0 A_CheckFloor(1)
			Goto Death+4
			TNT1 A 0 A_SpawnItemEx("DeusEx_ExplosionCraterFloor")
			TNT1 A 15 A_CustomMissile("DeusEx_LAMExplosion",0)
			Stop
	}
}

Actor DeusEx_LAMStaticGlow
{
	Height 2
	Radius 1
	+NOINTERACTION
	+NOGRAVITY
	States
	{
		Spawn:
			DX00 A 0 NoDelay ACS_NamedExecuteWithResult("DeusEX_LAMMineGlowPlacement")
			TNT1 A 1
			Wait
		SpawnNormal:
			DX00 A 2 Bright
			Stop
		SpawnFloor:
			DX01 A 2 Bright
			Stop
		SpawnFloor:
			DX02 A 2 Bright
			Stop
	}
}

Actor DeusEx_LAMExplosion
{
	Projectile
	Damage (0)
	Speed 0
	Height 2
	Radius 1
	Decal "DeusExExplosionDecal"
	+THRUACTORS
	+BLOODLESSIMPACT
	States
	{
		Spawn:
			TNT1 A 1 NoDelay A_Die
		Death:
			TNT1 A 0 A_TransferPointer(AAPTR_Target,AAPTR_Default,AAPTR_Master,AAPTR_Target)
			TNT1 A 0 A_PlaySound("DeusEx/LAM/Explode", CHAN_BODY)
			TNT1 A 0 A_AlertMonsters(2400)
			TNT1 AAAAAAAA 0 A_SpawnItemEx("DeusEx_FireCometLAM",0,0,0,frandom(2.0,6.0),0,frandom(4.0,8.0),random(0,360))
			TNT1 A 0 A_SpawnItemEX("DeusEx_ExplosionMid", 0,0,0,0,0,0,0, SXF_NOCHECKPOSITION|SXF_CLIENTSIDE)
			TNT1 A 0 A_SpawnItemEX("DeusEx_ShockWaveSpawner", 0,0,0,0,0,0,0, SXF_NOCHECKPOSITION|SXF_CLIENTSIDE)
			TNT1 A 2 A_Explode(CallACS("DeusEx_WeaponSkillDamage", 2, 50), 77)
			TNT1 A 0 A_SpawnItemEx("DeusEx_SmokeTrail",0,0,0,frandom(-0.25,0.25),frandom(-0.25,0.25),1.0)
			TNT1 A 2 A_Explode(CallACS("DeusEx_WeaponSkillDamage", 2, 50), 154)
			TNT1 A 0 A_SpawnItemEx("DeusEx_SmokeTrail",0,0,0,frandom(-0.25,0.25),frandom(-0.25,0.25),1.0)
			TNT1 A 2 A_Explode(CallACS("DeusEx_WeaponSkillDamage", 2, 50), 230)
			TNT1 A 0 A_SpawnItemEx("DeusEx_SmokeTrail",0,0,0,frandom(-0.25,0.25),frandom(-0.25,0.25),1.0)
			TNT1 A 2 A_Explode(CallACS("DeusEx_WeaponSkillDamage", 2, 50), 307)
			TNT1 A 0 A_SpawnItemEx("DeusEx_SmokeTrail",0,0,0,frandom(-0.25,0.25),frandom(-0.25,0.25),1.0)
			TNT1 A 2 A_Explode(CallACS("DeusEx_WeaponSkillDamage", 2, 50), 384)
			TNT1 AAAAAAAAA 2 A_SpawnItemEx("DeusEx_SmokeTrail",0,0,0,frandom(-0.25,0.25),frandom(-0.25,0.25),1.0)
			Stop
	}
}

Actor DeusEx_LAMPlantMissile : DeusExBullet
{
	Damage(0)
	+THRUACTORS
	Speed 32
	Decal None
	States
	{
		Spawn:
			TNT1 A 0 NODELAY
			TNT1 A 1 //A_TakeFromTarget("DeusEx_LAMMayPlant", 999)
			Stop
		XDeath:
		Crash:
			TNT1 A 0
			TNT1 A 1 //A_TakeFromTarget("DeusEx_LAMMayPlant", 999)
			Stop
		Death:
			TNT1 A 0 A_TakeFromTarget("RocketAmmo", 1, TIF_NOTAKEINFINITE)
			TNT1 A 0 A_PlaySound("DeusEx/LAM/Bounce", CHAN_BODY)
			TNT1 A 3 ACS_NamedExecuteWithResult("DeusEx_PlantMine")
			Stop
	}
}

Actor DeusEx_LAMTimer : Inventory { +INVENTORY.UNDROPPABLE Inventory.MaxAmount 5 Inventory.InterHubAmount 0  }

Actor DeusEx_NanoSword : DeusEx_CombatKnife
{
	Weapon.SlotNumber 9
	Weapon.SlotPriority 2
	-WEAPON.WIMPY_WEAPON
	Tag "Dragon's Tooth Sword"
	Weapon.UpSound "DeusEx/NanoSword/Select"
	Inventory.PickupMessage "You found the Dragon Tooth Sword!"
	Obituary "%o was shown %h's large Dragon's Tooth Sword."		
	States
	{
		Spawn:
			DX99 A -1 Bright
			Stop
		Select:
			TNT1 AAAAAAAAAAAAAAAAAAAA 0 A_Raise
			TNT1 A 1 A_Raise
			loop
		Ready:
			DX00 B 0 A_GiveInventory("DeusEx_NanoSwordEquipped", 1)
			DX00 B 0 A_GunFlash("ReadyGlow",GFF_NOEXTCHANGE)
			DX00 BCDEFGHIJKLM 3
			DX00 A 0 A_TakeInventory("DeusEx_Reloading", 1)
			Goto ReadyLoop
		ReadyGlow:
			DX03 ABCDEFGHIJKL 3 Bright
			Stop
		ReadyLoop:
			DX00 A 0 A_Jump(64, "Idle1", "Idle2", "Idle3")
			DX00 A 0 A_GunFlash("ReadyLoopGlow",GFF_NOEXTCHANGE)
			DX00 AAAAAAAAAAAAAAAA 1 A_WeaponReady 
			Loop
		ReadyLoopGlow:
			DX04 ABCDEFGH 2 Bright
			Loop
		Idle1:
			DX00 A 0 A_GunFlash("Idle1Glow",GFF_NOEXTCHANGE)
			DX00 A 6 A_WeaponReady
			DX01 "VWXYZ[\]" 6 A_WeaponReady
			Goto ReadyLoop
		Idle1Glow:
			"####" "#" 6 Bright
			DX05 ABCDEFGH 6 Bright
			Stop
		Idle2:
			DX00 A 0 A_GunFlash("Idle2Glow",GFF_NOEXTCHANGE)
			DX00 A 6 A_WeaponReady
			DX02 ABCDEFGH 6 A_WeaponReady
			Goto ReadyLoop
		Idle2Glow:
			"####" "#" 6 Bright
			DX06 ABCDEFGH 6 Bright
			Stop
		Idle3:
			DX00 A 0 A_GunFlash("Idle3Glow",GFF_NOEXTCHANGE)
			DX00 A 6 A_WeaponReady
			DX02 IJKLMNOP 6 A_WeaponReady
			Goto ReadyLoop
		Idle3Glow:
			"####" "#" 6 Bright
			DX07 ABCDEFGH 6 Bright
			Stop
		Fire:
			DX00 M 0 A_Jump(256, "Attack1", "Attack2")
			Goto Attack1
		Attack1:
			DX00 N 0 A_GiveInventory("DeusEx_Firing",1)
			DX00 N 0 A_JumpIfInventory("DeusEx_LowTechSkill", 4, "Attack1_Master")
			DX00 N 0 A_JumpIfInventory("DeusEx_LowTechSkill", 3, "Attack1_Adv")
			DX00 N 0 A_JumpIfInventory("DeusEx_LowTechSkill", 2, "Attack1_Pro")
			DX00 N 0 A_JumpIfInventory("DeusEx_LowTechSkill", 1, "Attack1_Trained")
			DX00 N 0 A_GunFlash("Attack1Glow",GFF_NOEXTCHANGE)
			DX00 NOPQRS 2
			DX00 T 2 A_PlaySound("DeusEx/NanoSword/Fire", CHAN_WEAPON)
			DX00 U 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 8, 0, 0, -4)
			DX00 U 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 4, 0, 0, -2)
			DX00 U 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 0, 0, 0, 0)
			DX00 U 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", -4, 0, 0, 2)
			DX00 U 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", -8, 0, 0, 4)
			DX00 "UVWXYZ[\" 2
			DX00 A 2 A_Refire
			Goto ReadyLoop
		Attack1_Trained:
			DX00 N 0 A_GunFlash("Attack1Glow_Trained",GFF_NOEXTCHANGE)
			DX00 N 1
			DX00 OPQ 2
			DX00 R 1
			DX00 S 2
			DX00 T 2 A_PlaySound("DeusEx/NanoSword/Fire", CHAN_WEAPON)
			DX00 U 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 8, 0, 0, -4)
			DX00 U 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 4, 0, 0, -2)
			DX00 U 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 0, 0, 0, 0)
			DX00 U 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", -4, 0, 0, 2)
			DX00 U 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", -8, 0, 0, 4)
			DX00 U 1
			DX00 VW 2
			DX00 XYZ 2
			DX00 "[" 1
			DX00 "\" 2
			DX00 A 2 A_Refire
			Goto ReadyLoop
		Attack1_Pro:
			DX00 N 0 A_GunFlash("Attack1Glow_Pro",GFF_NOEXTCHANGE)
			DX00 NO 1
			DX00 PQ 2
			DX00 R 1
			DX00 S 2
			DX00 T 2 A_PlaySound("DeusEx/NanoSword/Fire", CHAN_WEAPON)
			DX00 U 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 8, 0, 0, -4)
			DX00 U 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 4, 0, 0, -2)
			DX00 U 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 0, 0, 0, 0)
			DX00 U 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", -4, 0, 0, 2)
			DX00 U 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", -8, 0, 0, 4)
			DX00 UV 2
			DX00 W 1
			DX00 XY 2
			DX00 Z 1
			DX00 "[" 2
			DX00 "\" 1
			DX00 A 2 A_Refire
			Goto ReadyLoop
		Attack1_Adv:
			DX00 N 0 A_GunFlash("Attack1Glow_Adv",GFF_NOEXTCHANGE)
			DX00 NOP 1
			DX00 Q 2
			DX00 RS 1
			DX00 T 1 A_PlaySound("DeusEx/NanoSword/Fire", CHAN_WEAPON)
			DX00 U 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 8, 0, 0, -4)
			DX00 U 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 4, 0, 0, -2)
			DX00 U 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 0, 0, 0, 0)
			DX00 U 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", -4, 0, 0, 2)
			DX00 U 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", -8, 0, 0, 4)
			DX00 UVW 1
			DX00 X 2
			DX00 "YZ[" 1
			DX00 "\" 2
			DX00 A 2 A_Refire
			Goto ReadyLoop
		Attack1_Master:
			DX00 N 0 A_GunFlash("Attack1Glow_Master",GFF_NOEXTCHANGE)
			DX00 NOPQRS 1
			DX00 T 1 A_PlaySound("DeusEx/NanoSword/Fire", CHAN_WEAPON)
			DX00 U 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 8, 0, 0, -4)
			DX00 U 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 4, 0, 0, -2)
			DX00 U 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 0, 0, 0, 0)
			DX00 U 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", -4, 0, 0, 2)
			DX00 U 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", -8, 0, 0, 4)
			DX00 "UVWXYZ[\" 1
			DX00 A 1 A_Refire
			Goto ReadyLoop
		Attack1Glow:
			DX09 ABCDEFGHIJKLMNO 2 Bright
			DX04 H 2 Bright
			Stop
		Attack1Glow_Trained:
			DX09 A 1 Bright
			DX09 BCD 2 Bright
			DX09 E 1 Bright
			DX09 FG 2 Bright
			DX09 H 1 Bright
			DX09 IJKLM 2 Bright
			DX09 N 1 Bright
			DX09 O 2 Bright
			DX04 H 2 Bright
			Stop
		Attack1Glow_Pro:
			DX09 AB 1 Bright
			DX09 CD 2 Bright
			DX09 E 1 Bright
			DX09 FGHI 2 Bright
			DX09 J 1 Bright
			DX09 KL 2 Bright
			DX09 M 1 Bright
			DX09 N 2 Bright
			DX09 O 1 Bright
			DX04 H 2 Bright
			Stop
		Attack1Glow_Adv:
			DX09 ABC 1 Bright
			DX09 D 2 Bright
			DX09 EFGHIJ 1 Bright
			DX09 K 2 Bright
			DX09 LMN 1 Bright
			DX09 O 2 Bright
			DX04 H 2 Bright
			Stop
		Attack1Glow_Master:
			DX09 ABCDEFGHIJKLMNO 1 Bright
			DX04 H 1 Bright
			Stop
		Attack2:
			DX00 "]" 0 A_JumpIfInventory("DeusEx_LowTechSkill", 4, "Attack2_Master")
			DX00 "]" 0 A_JumpIfInventory("DeusEx_LowTechSkill", 3, "Attack2_Adv")
			DX00 "]" 0 A_JumpIfInventory("DeusEx_LowTechSkill", 2, "Attack2_Pro")
			DX00 "]" 0 A_JumpIfInventory("DeusEx_LowTechSkill", 1, "Attack2_Trained")
			DX00 "]" 0 A_GunFlash("Attack2Glow",GFF_NOEXTCHANGE)
			DX00 "]" 2
			DX01 ABCDE 2
			DX01 F 2 A_PlaySound("DeusEx/NanoSword/Fire", CHAN_WEAPON)
			DX01 G 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 12, 0, 0, 2)
			DX01 G 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 6, 0, 0, 2)
			DX01 G 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 0, 0, 0, 2)
			DX01 G 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", -6, 0, 0, 2)
			DX01 G 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", -12, 0, 0, 2)
			DX01 GHIJKLMN 2
			DX00 A 2 A_Refire
			Goto ReadyLoop
		Attack2_Trained:
			DX00 "]" 0 A_GunFlash("Attack2Glow_Trained",GFF_NOEXTCHANGE)
			DX00 "]" 2
			DX01 A 1
			DX01 BC 2
			DX01 D 1
			DX01 E 2
			DX01 F 2 A_PlaySound("DeusEx/NanoSword/Fire", CHAN_WEAPON)
			DX01 G 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 12, 0, 0, 2)
			DX01 G 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 6, 0, 0, 2)
			DX01 G 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 0, 0, 0, 2)
			DX01 G 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", -6, 0, 0, 2)
			DX01 G 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", -12, 0, 0, 2)
			DX01 G 2
			DX01 H 1
			DX01 IJ 2
			DX01 K 1
			DX01 LM 2
			DX01 N 1
			DX00 A 2 A_Refire
			Goto ReadyLoop
		Attack2_Pro:
			DX00 "]" 0 A_GunFlash("Attack2Glow_Pro",GFF_NOEXTCHANGE)
			DX00 "]" 2
			DX01 AB 1
			DX01 C 2
			DX01 DE 1
			DX01 F 2 A_PlaySound("DeusEx/NanoSword/Fire", CHAN_WEAPON)
			DX01 G 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 12, 0, 0, 2)
			DX01 G 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 6, 0, 0, 2)
			DX01 G 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 0, 0, 0, 2)
			DX01 G 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", -6, 0, 0, 2)
			DX01 G 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", -12, 0, 0, 2)
			DX01 G 2
			DX01 HI 1
			DX01 J 2
			DX01 KL 1
			DX01 M 2
			DX01 N 1
			DX00 A 2 A_Refire
			Goto ReadyLoop
		Attack2_Adv:
			DX00 "]" 0 A_GunFlash("Attack2Glow_Adv",GFF_NOEXTCHANGE)
			DX00 "]" 1
			DX01 ABCD 1
			DX01 E 2
			DX01 F 1 A_PlaySound("DeusEx/NanoSword/Fire", CHAN_WEAPON)
			DX01 G 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 12, 0, 0, 2)
			DX01 G 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 6, 0, 0, 2)
			DX01 G 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 0, 0, 0, 2)
			DX01 G 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", -6, 0, 0, 2)
			DX01 G 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", -12, 0, 0, 2)
			DX01 G 2
			DX01 HIJKLM 1
			DX01 N 2
			DX00 A 2 A_Refire
			Goto ReadyLoop
		Attack2_Master:
			DX00 "]" 0 A_GunFlash("Attack2Glow_Master",GFF_NOEXTCHANGE)
			DX01 ABCDE 1
			DX01 F 1 A_PlaySound("DeusEx/NanoSword/Fire", CHAN_WEAPON)
			DX01 G 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 12, 0, 0, 2)
			DX01 G 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 6, 0, 0, 2)
			DX01 G 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", 0, 0, 0, 2)
			DX01 G 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", -6, 0, 0, 2)
			DX01 G 0 A_FireCustomMissile("DeusEx_NanoSwordMissile", -12, 0, 0, 2)
			DX01 GHIJKLMN 1
			DX00 A 1 A_Refire
			Goto ReadyLoop
		Attack2Glow:
			DX10 ABCDEFGHIJKLMNO 2 Bright
			DX04 H 2 Bright
			Stop
		Attack2Glow_Trained:
			DX10 A 2 Bright
			DX10 B 1 Bright
			DX10 CD 2 Bright
			DX10 E 1 Bright
			DX10 FGH 2 Bright
			DX10 I 1 Bright
			DX10 JK 2 Bright
			DX10 L 1 Bright
			DX10 MN 2 Bright
			DX10 O 1 Bright
			DX04 H 2 Bright
			Stop
		Attack2Glow_Pro:
			DX10 A 2 Bright
			DX10 BC 1 Bright
			DX10 D 2 Bright
			DX10 EF 1 Bright
			DX10 GH 2 Bright
			DX10 IJ 1 Bright
			DX10 K 2 Bright
			DX10 LM 1 Bright
			DX10 N 2 Bright
			DX10 O 1 Bright
			DX04 H 2 Bright
			Stop
		Attack2Glow_Adv:
			DX10 A 1 Bright
			DX10 BCDE 1 Bright
			DX10 F 2 Bright
			DX10 G 1 Bright
			DX10 H 2 Bright
			DX10 IJKLMN 1 Bright
			DX10 O 2 Bright
			DX04 H 2 Bright
			Stop
		Attack2Glow_Master:
			DX10 ABCDEFGHIJKLMNO 1 Bright
			DX04 H 1 Bright
			Stop
		Deselect:
			DX01 O 0 A_GunFlash("DeselectGlow",GFF_NOEXTCHANGE)
			DX01 O 0 A_GiveInventory("DeusEx_Reloading", 1)
			DX01 OPQRSTU 3
			TNT1 A 0 A_TakeInventory("DeusEx_NanoSwordEquipped", 1)
			Goto Super::InstantDeselect
		DeselectGlow:
			DX08 ABCDEFG 3 Bright
			Stop
	}
}	

Actor DeusEx_NanoSwordMissile : DeusExBullet
{
	Damage(CallACS("DeusEx_WeaponSkillDamage", 2, 10))
	Speed 60
	Decal none
	DamageType "DeusExMelee"
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 1 
			Stop
		Crash:
			TNT1 A 0 A_PlaySound("DeusEx/NanoSword/HitSoft", CHAN_BODY)
			TNT1 A 1 A_Explode(CallACS("DeusEx_BackDamage",CallACS("DeusEx_WeaponSkillDamage", 2, 10)),8,!XF_HURTSOURCE,0,8)
			Stop
		Death:
			TNT1 A 1 A_PlaySound("DeusEx/NanoSword/HitHard", CHAN_BODY)
			Stop
		XDeath:
			TNT1 A 0 A_PlaySound("DeusEx/NanoSword/HitFlesh", CHAN_BODY)
			TNT1 A 0 A_Explode(CallACS("DeusEx_BackDamage",CallACS("DeusEx_WeaponSkillDamage", 2, 10)),8,!XF_HURTSOURCE,0,8)
			TNT1 A 0 ACS_NamedExecuteWithResult("DeusEx_BloodGenerator_Offsets")
			TNT1 A 1 A_GiveInventory("DeusEx_BloodGenerator",1,AAPTR_TRACER)
			stop
	}
}