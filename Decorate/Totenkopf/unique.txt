actor Totenkopf_Flamethrower : InstantSwitchWeapon
{
    Tag "FlammenWerfer"
	Weapon.SelectionOrder 400
    Weapon.SlotNumber 8
    Inventory.PickUpSound "Totenkopf/getweapon"
    Weapon.AmmoUse 1
    Weapon.AmmoGive 40
    Weapon.AmmoType "Totenkopf_FlamethrowerFuel"
    +THRUGHOST
    +DONTBOB
    +INVENTORY.UNDROPPABLE
    Inventory.PickupMessage "Flamethrower"
    Obituary ""
    Weapon.YAdjust 16
    States
    {
      Spawn:
		TK06 F 4
        Loop

      Ready:
        TK06 A 1 A_WeaponReady
        loop

      Fire:
        TK06 B 2
		Goto Hold

      Hold:
		TK06 C 0 A_JumpIfInventory("CoopModeOn", 1, "CoopHold")
        TK06 C 0 A_PlaySound("Totenkopf/flamethrower",CHAN_WEAPON)
        TK06 C 2 Bright A_FireCustomMissile("Totenkopf_Flamethrower_Projectile",0,1,0,8)
        TK06 D 2 Bright A_FireCustomMissile("Totenkopf_Flamethrower_Projectile",0,0,0,8)
		TK06 C 2 Bright A_FireCustomMissile("Totenkopf_Flamethrower_Projectile",0,1,0,8)
		TK06 D 2 Bright A_FireCustomMissile("Totenkopf_Flamethrower_Projectile",0,0,0,8)
		TK06 C 2 Bright A_FireCustomMissile("Totenkopf_Flamethrower_Projectile",0,1,0,8)
		TK06 D 2 Bright A_FireCustomMissile("Totenkopf_Flamethrower_Projectile",0,0,0,8)
        TK06 D 2 Bright
		TK06 D 0 A_Refire
		TK06 E 3
        Goto Ready
	  CoopHold:
        TK06 C 0 A_PlaySound("Totenkopf/flamethrower",CHAN_WEAPON)
        TK06 C 2 Bright A_FireCustomMissile("Totenkopf_Flamethrower_ProjectileCoop",0,1,0,8)
        TK06 D 2 Bright A_FireCustomMissile("Totenkopf_Flamethrower_ProjectileCoop",0,0,0,8)
		TK06 C 2 Bright A_FireCustomMissile("Totenkopf_Flamethrower_ProjectileCoop",0,1,0,8)
		TK06 D 2 Bright A_FireCustomMissile("Totenkopf_Flamethrower_ProjectileCoop",0,0,0,8)
		TK06 C 2 Bright A_FireCustomMissile("Totenkopf_Flamethrower_ProjectileCoop",0,1,0,8)
		TK06 D 2 Bright A_FireCustomMissile("Totenkopf_Flamethrower_ProjectileCoop",0,0,0,8)
        TK06 D 2 Bright
		TK06 D 0 A_Refire
		TK06 E 3
        Goto Ready	  
    }
}

Actor Totenkopf_Flamethrower_Projectile
{
	Speed 16
	Damage (random(0,256)>>3)
	Height 16
	Radius 8
	Projectile
	DamageType "TotenkopfFire"
	+BLOODLESSIMPACT
	+NOEXTREMEDEATH
	+NODAMAGETHRUST
	States
	{
		Spawn:
			TK52 ABABCDCD 3 Bright
		Death:
			TK52 A 0 A_Stop
			TK52 EFG 2 Bright
			Stop
	}
} 
Actor Totenkopf_Flamethrower_ProjectileCoop : Totenkopf_Flamethrower_Projectile { Species "Player" +THRUSPECIES }

Actor Totenkopf_FlameThrowerFuel : Ammo 
{
	Inventory.MaxAmount 200
	Ammo.BackPackMaxAmount 400
	Ammo.BackPackAmount 40
	Inventory.Icon "AMSMN0"
}	

actor Totenkopf_MG42 : InstantSwitchWeapon
{
	Tag "Portable MG42"
    Weapon.SelectionOrder 750
    Weapon.SlotNumber 9
    Inventory.PickUpSound "Totenkopf/getweapon"
    Weapon.AmmoUse 1
    Weapon.AmmoGive 80
    Weapon.AmmoType "Cell"
    +THRUGHOST
    +DONTBOB
    +INVENTORY.UNDROPPABLE
    Inventory.PickupMessage "MG42 Portable Machine Gun"
    Obituary ""
    Weapon.YAdjust 16
    States
    {
      Spawn:
		TK11 F 4
        Loop

      Ready:
        TK11 A 1 A_WeaponReady
        loop

      Fire:
        TK11 B 2
		Goto Hold

      Hold:
		TK11 C 0 A_JumpIfInventory("CoopModeON", 1, "CoopHold")
        TK11 C 0 A_PlaySound("Totenkopf/atkmg42",CHAN_WEAPON)
        TK11 C 3 Bright A_FireCustomMissile("Totenkopf_Tracer_MG42",random(-4,4))
        TK11 D 2 Bright A_FireCustomMissile("Totenkopf_Tracer_MG42",random(-4,4))
		TK11 C 0 A_PlaySound("Totenkopf/atkmg42",CHAN_WEAPON)
		TK11 C 3 Bright A_FireCustomMissile("Totenkopf_Tracer_MG42",random(-4,4))
        TK11 D 2 Bright
		TK11 D 0 A_Refire
        TK11 E 3
        Goto Ready
		
	  CoopHold:
        TK11 C 0 A_PlaySound("Totenkopf/atkmg42",CHAN_WEAPON)
        TK11 C 3 Bright A_FireCustomMissile("Totenkopf_Tracer_MG42Coop",random(-4,4))
        TK11 D 2 Bright A_FireCustomMissile("Totenkopf_Tracer_MG42Coop",random(-4,4))
		TK11 C 0 A_PlaySound("Totenkopf/atkmg42",CHAN_WEAPON)
		TK11 C 3 Bright A_FireCustomMissile("Totenkopf_Tracer_MG42Coop",random(-4,4))
        TK11 D 2 Bright
		TK11 D 0 A_Refire
        TK11 E 3
        Goto Ready	  
    }
} 

Actor Totenkopf_Tracer_MG42 : Totenkopf_Tracer { Damage (8 + (random(0,256)%28)) }
Actor Totenkopf_Tracer_MG42Coop : Totenkopf_Tracer_MG42 { Species "Player" +THRUSPECIES }

actor Totenkopf_Sniper : Totenkopf_Kar98K
{
	Tag "Kar98k Rifle (Scope)"
    Weapon.SelectionOrder 900
	Weapon.SlotPriority 2
	Weapon.AmmoGive 0
    Inventory.PickupMessage "Kar98k Sniper Rifle"
	Inventory.RestrictedTo "TotenkopfPlayer"	
	+WEAPON.NO_AUTO_SWITCH
    States
    {
      Spawn:
		TK12 M 4
        Loop

	  Deselect:
	    TNT1 A 0 A_ZoomFactor(1.0,ZOOM_INSTANT)
		Goto Super::Deselect

      Ready:
		TNT1 A 0 A_ZoomFactor(4.0,ZOOM_INSTANT)
		TNT1 A 0 A_JumpIf(CallACS("Totenkopf_SniperScope")==1,1)
        TNT1 A 1 A_WeaponReady
        loop

      Fire:
		TNT1 B 0 A_JumpIfInventory("CoopModeOn", 1, "CoopFire")
        TNT1 B 3
		TNT1 C 0 A_PlaySound("Totenkopf/atkkar98",CHAN_WEAPON)
		TNT1 C 3 Bright A_FireCustomMissile("Totenkopf_Tracer_Sniper")
		TNT1 D 5
		TNT1 E 0 A_JumpIfNoAmmo("Ready")
		TNT1 E 0 A_PlaySound("Totenkopf/kar98bolt",CHAN_5)
		TNT1 E 5
		TNT1 F 5
		TNT1 GHI 2
		TNT1 JK 5
		TNT1 L 3
		Goto Ready
	  CoopFire:
        TNT1 B 3
		TNT1 C 0 A_PlaySound("Totenkopf/atkkar98",CHAN_WEAPON)
		TNT1 C 3 Bright A_FireCustomMissile("Totenkopf_Tracer_SniperCoop")
		TNT1 D 5
		TNT1 E 0 A_JumpIfNoAmmo("Ready")
		TNT1 E 0 A_PlaySound("Totenkopf/kar98bolt",CHAN_5)
		TNT1 E 5
		TNT1 F 5
		TNT1 GHI 2
		TNT1 JK 5
		TNT1 L 3
		Goto Ready	  
    }
} 

Actor Totenkopf_Tracer_Sniper : Totenkopf_Tracer { Damage ((125+random(0,256)%25)) }
Actor Totenkopf_Tracer_SniperCoop : Totenkopf_Tracer_Sniper { Species "Player" +THRUSPECIES }

Actor Totenkopf_SniperPickup : CustomInventory
{
	Inventory.PickupMessage "Scoped Kar98k Rifle"
	Inventory.PickUpSound "Totenkopf/getweapon"
	+INVENTORY.AUTOACTIVATE
	States
	{
		Spawn:
			TK12 M 4
			Loop
		Pickup:
			TNT1 A 0 A_JumpIfInventory("Shell",0,1)
			Goto Pickup+3
			TNT1 A 0 A_JumpIfInventory("Totenkopf_Sniper",1,1)
			Goto Pickup+3
			TNT1 A 0 A_JumpIfInventory("Totenkopf_Kar98K",1,"PickupFailure")
			TNT1 A 0 A_GiveInventory("Totenkopf_Sniper",1)
			TNT1 A 0 A_GiveInventory("Totenkopf_Kar98K",1)
			TNT1 A 0 A_GiveInventory("Shell",5)
			Stop
		PickupFailure:
			TNT1 A 0 A_Railwait
			fail
	}
}