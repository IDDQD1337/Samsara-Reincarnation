actor Totenkopf_Kar98K : InstantSwitchWeapon
{
    Weapon.SelectionOrder 800
    Weapon.SlotNumber 1
    Inventory.PickUpSound "Totenkopf/getweapon"
    Weapon.AmmoUse 1
    Weapon.AmmoGive 5
    Weapon.AmmoType "Shell"
	+WEAPON.NOAUTOFIRE
    +THRUGHOST
    +DONTBOB
    +INVENTORY.UNDROPPABLE
    Inventory.PickupMessage "Kar98k Rifle"
    Obituary ""
    Weapon.YAdjust 16
	Weapon.SlotPriority 3
    States
    {
      Spawn:
		TK03 M 4
        Loop

      Ready:
		TK03 A 0 A_JumpIfInventory("Totenkopf_Sniper",1,2)
        TK03 A 1 A_WeaponReady
        loop
		TK12 A 1 A_WeaponReady
		loop

      Fire:
		TK03 B 0 A_JumpIfInventory("CoopModeOn", 1, "CoopFire")
		TK03 B 0 A_JumpIfInventory("Totenkopf_Sniper",1,15)
        TK03 B 3
		TK03 C 0 A_PlaySound("Totenkopf/atkkar98",CHAN_WEAPON)
		TK03 C 3 Bright A_FireCustomMissile("Totenkopf_Tracer_Kar98k")
		TK03 D 5
		TK03 E 0 A_JumpIfNoAmmo("Ready")
		TK03 E 0 A_PlaySound("Totenkopf/kar98bolt",CHAN_5)
		TK03 E 5
		TK03 F 5
		TK03 GHI 2
		TK03 JK 5
		TK03 L 3
		Goto Ready
        TK12 B 3
		TK12 C 0 A_PlaySound("Totenkopf/atkkar98",CHAN_WEAPON)
		TK12 C 3 Bright A_FireCustomMissile("Totenkopf_Tracer_Kar98k")
		TK12 D 5
		TK12 E 0 A_JumpIfNoAmmo("Ready")
		TK12 E 0 A_PlaySound("Totenkopf/kar98bolt",CHAN_5)
		TK12 E 5
		TK12 F 5
		TK12 GHI 2
		TK12 JK 5
		TK12 L 3
		Goto Ready
	  CoopFire:
		TK03 B 0 A_JumpIfInventory("Totenkopf_Sniper",1,15)
        TK03 B 3
		TK03 C 0 A_PlaySound("Totenkopf/atkkar98",CHAN_WEAPON)
		TK03 C 3 Bright A_FireCustomMissile("Totenkopf_Tracer_Kar98kCoop")
		TK03 D 5
		TK03 E 0 A_JumpIfNoAmmo("Ready")
		TK03 E 0 A_PlaySound("Totenkopf/kar98bolt",CHAN_5)
		TK03 E 5
		TK03 F 5
		TK03 GHI 2
		TK03 JK 5
		TK03 L 3
		Goto Ready
        TK12 B 3
		TK12 C 0 A_PlaySound("Totenkopf/atkkar98",CHAN_WEAPON)
		TK12 C 3 Bright A_FireCustomMissile("Totenkopf_Tracer_Kar98kCoop")
		TK12 D 5
		TK12 E 0 A_JumpIfNoAmmo("Ready")
		TK12 E 0 A_PlaySound("Totenkopf/kar98bolt",CHAN_5)
		TK12 E 5
		TK12 F 5
		TK12 GHI 2
		TK12 JK 5
		TK12 L 3
		Goto Ready
    }
} 

Actor Totenkopf_Tracer_Kar98k : Totenkopf_Tracer { Damage ((50+random(0,256)%10)) }
Actor Totenkopf_Tracer_Kar98kCoop : Totenkopf_Tracer_Kar98k { Species "Player" +THRUSPECIES }