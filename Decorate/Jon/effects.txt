/////// EFFECTS
actor PSBulletPuff : BulletPuff
{  
  Scale 0.55
  renderstyle Normal
  attacksound "PS/Ricoch"
  DamageType "PSBullet"
  +NOBLOCKMAP
  +NOGRAVITY
  +ALLOWPARTICLES
  +RANDOMIZE
  VSpeed 0
  states
  {
  Spawn:
    TNT1 A 0
  Melee:
    TNT1 A 0 A_SpawnitemEx("PSBulletPuff2",0,0,0,0,0,0,0,128,0)  
    MCAS NNNOOOPPPQQQRRRSSS 1 Bright
    stop
  }
}

Actor PSBulletPuffCoop : PSBulletPuff { +MTHRUSPECIES +THRUSPECIES Species "Player" }

Actor PSBulletPuff2
{ 
  Radius 3
  Height 4
  Speed 25
  renderstyle Add  
  Scale 0.55
  +NOBLOCKMAP
  +NOGRAVITY
  +DONTSPLASH
  +RANDOMIZE
  states
  {
  Spawn:            
    MCAS TTUU 2 bright
    stop
  }
}

actor PSMacheteSparkPuff : BulletPuff
{  
  Scale 0.55
  renderstyle Normal
  DamageType "PSBullet"
  +NOBLOCKMAP
  +NOGRAVITY
  +ALLOWPARTICLES
  +RANDOMIZE
  VSpeed 0
  ActiveSound "PS/SlashSwing" 
  states
  {
  Spawn:
  Crash:
    TNT1 A 0 A_PlaySound("PS/SlashHit")
	KNF_ KKJJ 1 Bright 
	KNF_ J 1 Bright A_FadeOut
	Stop
  Melee:
	TNT1 A 1 A_PlaySound("PS/SlashFlesh")
	Stop
  }
}

Actor PSMacheteSparkPuff_UnderWater : PSMacheteSparkPuff { ActiveSound "PS/SlashWater" }

Actor ExM60CaseSpawner 
{
	Speed 25
	Projectile
	+NOCLIP
	+CLIENTSIDEONLY
	States 
	{
		Spawn:
			NULL A 0
			NULL A 1 A_CustomMissile("ExM60BulletCase", 16, 30, random(-80, -100), CMF_AIMDIRECTION, random(40, 80))
			stop
	}
}

actor ExM60BulletCase 
{
	Height 4
	Radius 4
	Speed 5
	Scale 0.25
	ReactionTime 15
	Mass 1
	Projectile
	-NOGRAVITY
	+DONTSPLASH
	+MOVEWITHSECTOR
	+FORCEXYBILLBOARD
	+CLIENTSIDEONLY
    +THRUACTORS
	+DROPOFF
	+MISSILE
	+NOTELEPORT
	-TELESTOMP
	+TOUCHY
	States 
	{
		Spawn:
		    M60B D 3 A_Countdown
			NULL A 0 A_ScaleVelocity(0.85)
			loop
		Death:
		    NULL A 1
			Stop
	}
}

Actor ExShellCasing : ExM60BulletCase
{
	BounceType "Doom"
	BounceFactor 0.5
	BounceCount 4
	MaxStepHeight 4	
	BounceSound ""	
	+BOUNCEONACTORS
	+ALLOWBOUNCEONACTORS
	+BOUNCEAUTOOFF
	+BOUNCEONWALLS
	-TOUCHY
	states
	{
		Spawn:
			CAS2 ABCDEFGH 3 A_CountDown
			NULL A 0 A_ScaleVelocity(0.85)
			loop
		Death:
			CAS2 A 0 A_Jump(256,"Rest1","Rest2","Rest3","Rest4","Rest5","Rest6")
			Goto Rest1			
		Rest1:
			CAS2 I 500
			CAS2 I 1 A_FadeOut
			Goto Rest1+1
		Rest2:
			CAS2 J 500
			CAS2 J 1 A_FadeOut
			Goto Rest2+1
		Rest3:
			CAS2 K 500
			CAS2 K 1 A_FadeOut
			Goto Rest3+1
		Rest4:
			CAS2 L 500
			CAS2 L 1 A_FadeOut
			Goto Rest4+1
		Rest5:
			CAS2 M 500
			CAS2 M 1 A_FadeOut
			Goto Rest5+1
		Rest6:
			CAS2 N 500
			CAS2 N 1 A_FadeOut
			Goto Rest6+1
	}
}

actor ExAbstractChunk_PS
{
	Radius 8
	Height 8
	Scale 0.7
	Mass 50
	+NOBLOCKMAP
	+NOTRIGGER
	+DONTSPLASH
	-SOLID
	+CLIENTSIDEONLY
	States 
	{
		Vanish:
			NULL A 1
			stop
	}
}

actor ExBloodParticle_PS : ExAbstractChunk_PS 
{
	Scale 0.1
	Gravity 0.8
	+FORCEXYBILLBOARD
	-SOLID
	+NOBLOCKMAP
	+CLIENTSIDEONLY
	States 
	{
		Spawn:
			_EX2 RST 8
			stop
	}
}

actor ExBloodCloud_PS : ExBloodParticle_PS 
{
	Scale 1.3
	RenderStyle Translucent
	Alpha 0.5
	Gravity 0.1
	+CLIENTSIDEONLY
}

actor ExAbstractGoreChunk_PS 
{
	Radius 4
	Height 8
	Mass 20
	Damage 0
	BounceType "Doom"
	BounceCount 1
	Scale 0.6
	Gravity 0.6
	DeathSound "PS/GoreSplat"
	Projectile
	-NOGRAVITY
	-SOLID
	+CANBOUNCEWATER
	+BOUNCEAUTOOFF
	+MOVEWITHSECTOR
	+FORCEXYBILLBOARD
	+DONTSPLASH
	+NOBLOCKMAP
	+CLIENTSIDEONLY
	States 
	{
		Spawn:
			"----" "#" 0 A_SpawnItemEx("ExBloodSplash_PS",0,0)
			"----" "#" 0			
			loop
		Death:
		Crash:
			"----" "#" 250
			"----" "#" 0 A_JumpIf(ACS_NamedExecuteWithResult("SamsaraDecorate",31) == 1, "Crash")
			"----" "#" 1 A_FadeOut
			Goto Crash+2
		Vanish:
			NULL A 1
			stop
	}
}

actor ExPlayerGoreHead_PS : ExAbstractGoreChunk_PS 
{
	Gravity 0.8
	+CLIENTSIDEONLY
	States 
	{
		Spawn:
			_EX2 B 1 A_SpawnItemEx("ExBloodParticle_PS", Random(-1, 1), Random(-1, 1), 0)
			_EX2 BBBBBBBBBBBBB 1 
			loop
		Crash:
			_EX2 A 500
			_EX2 A 0 A_JumpIf(ACS_NamedExecuteWithResult("SamsaraDecorate",31) == 1, "Crash")
			_EX2 A 1 A_FadeOut
			Goto Crash+2
	}
}

actor ExPlayerGoreFoot_PS : ExAbstractGoreChunk_PS
{
	Gravity 0.85
	+CLIENTSIDEONLY
	States 
	{
		Spawn:
			_EX1 A 1 A_SpawnItemEx("ExBloodParticle_PS", Random(-1, 1), Random(-1, 1), 0)
			_EX1 AAAAAAAAAAAAA 1 
			loop
		Crash:
			_EX1 A 500
			_EX1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("SamsaraDecorate",31) == 1, "Crash")
			_EX1 A 1 A_FadeOut
			Goto Crash+2
	}
}

//BLOOD
actor ExBloodSplash_PS
{
	+NOBLOCKMAP
	+NOGRAVITY
	+CLIENTSIDEONLY
	-SOLID
	States 
	{
		Spawn:
			NULL A 2
			NULL AAAAAAAAAAA 0 A_SpawnItemEx("ExBloodDrop_PS", Random(-1, 1), Random(-1, 1), 1, Random(-3, 3), Random(-3, 3), Random(1, 3), 0, SXF_TRANSFERTRANSLATION, 70)
			stop
	}
}

actor ExSmallBloodSplash_PS
{
	+NOBLOCKMAP
	+NOGRAVITY
	+CLIENTSIDEONLY
	-SOLID	
	States 
	{
		Spawn:
			NULL A 2
			NULL AAAAAA 0 A_SpawnItemEx("ExBloodParticle_PS", Random(-1, 1), Random(-1, 1), 1, Random(-2, 2), Random(-2, 2), Random(1, 3), 0, SXF_TRANSFERTRANSLATION, 70)
			stop
	}
}

actor ExBloodDrop_PS : ExAbstractGoreChunk_PS
{
	Gravity 0.4
	Scale 0.3
	Mass 1
	+THRUACTORS
	+CLIENTSIDEONLY
	States 
	{
		Spawn:
			_EX2 U 1
			loop
		Death:
			_EX2 VWX 3
			_EX2 X 80
			_EX2 X 1 A_FadeOut
			Goto Death+4
	}
}

//spawned when actor is hit
actor ExBloodHit_PS
{
	Mass 5
	Scale 0.3
	-SOLID
	+CLIENTSIDEONLY
	+NOBLOCKMAP
	+NOGRAVITY
	+NOTELEPORT
	-ALLOWPARTICLES
	+FORCEXYBILLBOARD
	States 
	{
		Spawn:
			_EX2 Y 1
			_EX2 YYY 1 A_SpawnItemEx("ExBloodDrop_PS",0,0,0,Random(-2, 2),Random(-2, 2),Random(-1, 1),0,SXF_TRANSFERTRANSLATION,128)
			NULL AAA 0 A_SpawnItemEx("ExBloodDrop_PS",0,0,0,Random(-2, 2),Random(-2, 2),Random(-1, 1),0,SXF_TRANSFERTRANSLATION,128)
			_EX2 Z 3
			_EX3 A 3
		Vanish:
			_EX3 BBC 1
			_EX3 C 1 A_FadeOut
			Goto Vanish+3
	}
}

actor ExBloodSplatter_PS
{
	Radius 4
	Height 8
	Mass 2
	Scale 0.4
	-SOLID
	+CLIENTSIDEONLY
	+NOBLOCKMAP
	+MISSILE
	+DROPOFF
	+NOTELEPORT
	+CANNOTPUSH
	-ALLOWPARTICLES
	+FORCEXYBILLBOARD
	States 
	{
		Spawn:
			_EX2 Y 1
			_EX2 YYY 1 A_SpawnItemEx("ExBloodDrop_PS",0,0,0,Random(-2, 2),Random(-2, 2),Random(-1, 1),0,SXF_TRANSFERTRANSLATION,128)
			NULL AAA 0 A_SpawnItemEx("ExBloodDrop_PS",0,0,0,Random(-2, 2),Random(-2, 2),Random(-1, 1),0,SXF_TRANSFERTRANSLATION,128)
			_EX2 Y 3
			_EX3 A 3
			_EX3 B 2
			_EX3 C 2
		Death:
			_EX3 C 1 a_FadeOut
			loop
	}
}

//GORE
actor ExGore1_PS : ExAbstractGoreChunk_PS
{
	Gravity 0.7
	+CLIENTSIDEONLY
	States 
	{
		Spawn:
			_EX2 L 1 A_SpawnItemEx("ExBloodParticle_PS",Random(-1, 1),Random(-1, 1),0,0,0,0,0,SXF_TRANSFERTRANSLATION) //ExBloodParticle
			loop
		Crash:
			_EX2 M 250
			_EX2 M 0 A_JumpIf(ACS_NamedExecuteWithResult("SamsaraDecorate",31) == 1, "Crash")
			_EX2 M 1 A_FadeOut
			Goto Crash+2
	}
}

actor ExGore2_PS : ExAbstractGoreChunk_PS 
{
	Gravity 0.5
	+CLIENTSIDEONLY
	States 
	{
		Spawn:
			_EX2 N 1 A_SpawnItemEx("ExBloodParticle_PS",Random(-1, 1),Random(-1, 1),0,0,0,0,0,SXF_TRANSFERTRANSLATION)
			loop
		Crash:
			_EX2 N 250
			_EX2 N 0 A_JumpIf(ACS_NamedExecuteWithResult("SamsaraDecorate",31) == 1, "Crash")
			_EX2 N 1 A_FadeOut
			Goto Crash+2
	}
}

actor ExGore3_PS : ExAbstractGoreChunk_PS 
{
	Gravity 0.4
	+CLIENTSIDEONLY
	States 
	{
		Spawn:
			_EX2 O 1 A_SpawnItemEx("ExBloodParticle_PS",Random(-1, 1),Random(-1, 1),0,0,0,0,0,SXF_TRANSFERTRANSLATION)
			loop
		Crash:
			_EX2 O 250
			_EX2 O 0 A_JumpIf(ACS_NamedExecuteWithResult("SamsaraDecorate",31) == 1, "Crash")
			_EX2 O 1 A_FadeOut
			Goto Crash+2
	}
}

actor ExGore4_PS : ExAbstractGoreChunk_PS 
{
	Gravity 0.65
	+CLIENTSIDEONLY
	States 
	{
		Spawn:
			_EX2 P 1 A_SpawnItemEx("ExBloodParticle_PS",Random(-1, 1),Random(-1, 1),0,0,0,0,0,SXF_TRANSFERTRANSLATION)
			loop
		Crash:
			_EX2 P 250
			_EX2 P 0 A_JumpIf(ACS_NamedExecuteWithResult("SamsaraDecorate",31) == 1, "Crash")
			_EX2 P 1 A_FadeOut
			Goto Crash+2
	}
}

actor ExGore5_PS : ExAbstractGoreChunk_PS 
{
	+CLIENTSIDEONLY
	States 
	{
		Spawn:
			_EX2 Q 1 A_SpawnItemEx("ExBloodParticle_PS",Random(-1, 1),Random(-1, 1),0,0,0,0,0,SXF_TRANSFERTRANSLATION)
			loop
		Crash:
			_EX2 Q 250
			_EX2 Q 0 A_JumpIf(ACS_NamedExecuteWithResult("SamsaraDecorate",31) == 1, "Crash")
			_EX2 Q 1 A_FadeOut
			Goto Crash+2

	}
}

actor ExGoreGuts_PS : ExAbstractGoreChunk_PS 
{
	+CLIENTSIDEONLY
	States 
	{
		Spawn:
			_EX2 E 1 A_SpawnItemEx("ExBloodParticle_PS",Random(-1, 1),Random(-1, 1),0,0,0,0,0,SXF_TRANSFERTRANSLATION)
			loop			
		Crash:
			_EX2 G 15
		Crash2:
			_EX2 H 235
			_EX2 H 0 A_JumpIf(ACS_NamedExecuteWithResult("SamsaraDecorate",31) == 1, "Crash2")
			_EX2 H 1 A_FadeOut
			Goto Crash+2
	}
}

actor ExGore7_PS : ExAbstractGoreChunk_PS
{
	Gravity 0.9
	+CLIENTSIDEONLY
	States 
	{
		Spawn:
			_EX2 F 1 A_SpawnItemEx("ExBloodParticle_PS",Random(-1, 1),Random(-1, 1),0,0,0,0,0,SXF_TRANSFERTRANSLATION)
			loop
		Crash:
			_EX2 G 15
		Crash2:
			_EX2 H 235
			_EX2 H 0 A_JumpIf(ACS_NamedExecuteWithResult("SamsaraDecorate",31) == 1, "Crash2")
			_EX2 H 1 A_FadeOut
			Goto Crash+2
	}
}

actor ExGoreRibcage_PS : ExAbstractGoreChunk_PS 
{
	Gravity 0.95
	+CLIENTSIDEONLY
	States 
	{
		Spawn:
			_EX2 CCCCCCCCCCCCCCCC 1 A_SpawnItemEx("ExBloodParticle_PS",Random(-1, 1),Random(-1, 1),0,0,0,0,0,SXF_TRANSFERTRANSLATION)
			loop
		Crash:
			_EX2 D 250
			_EX2 D 0 A_JumpIf(ACS_NamedExecuteWithResult("SamsaraDecorate",31) == 1, "Crash")
			_EX2 D 1 A_FadeOut
			Goto Crash+2
	}
}

actor PSGibSpawner
{
	+CLIENTSIDEONLY
	+NOINTERACTION
	+NOCLIP
	-TELESTOMP
	-SOLID
	+NOGRAVITY
	States
	{
		Spawn:
		TNT1 A 0
		NULL A 0 A_SpawnItemEx("ExGore1_PS",0, 0, 32, random(3.0,5.0),random(3.0,5.0),random(0.0,10.0),random(0.0,360.0), SXF_ABSOLUTEANGLE|SXF_TRANSFERTRANSLATION, 0)
		NULL A 0 A_SpawnItemEx("ExGore2_PS",0, 0, 32, random(3.0,5.0),random(3.0,5.0),random(0.0,10.0),random(0.0,360.0), SXF_ABSOLUTEANGLE|SXF_TRANSFERTRANSLATION, 0)
		NULL A 0 A_SpawnItemEx("ExGore3_PS",0, 0, 32, random(3.0,5.0),random(3.0,5.0),random(0.0,10.0),random(0.0,360.0), SXF_ABSOLUTEANGLE|SXF_TRANSFERTRANSLATION, 0)
		NULL A 0 A_SpawnItemEx("ExGore4_PS",0, 0, 32, random(3.0,5.0),random(3.0,5.0),random(0.0,10.0),random(0.0,360.0), SXF_ABSOLUTEANGLE|SXF_TRANSFERTRANSLATION, 0)
		NULL A 0 A_SpawnItemEx("ExGore5_PS",0, 0, 32, random(3.0,5.0),random(3.0,5.0),random(0.0,10.0),random(0.0,360.0), SXF_ABSOLUTEANGLE|SXF_TRANSFERTRANSLATION, 0)
		NULL A 0 A_SpawnItemEx("ExGore7_PS",0, 0, 32, random(3.0,5.0),random(3.0,5.0),random(0.0,10.0),random(0.0,360.0), SXF_ABSOLUTEANGLE|SXF_TRANSFERTRANSLATION, 0)
		NULL A 0 A_SpawnItemEx("ExGoreRibcage_PS",0, 0, 32, random(3.0,5.0),random(3.0,5.0),random(0.0,10.0),random(0.0,360.0), SXF_ABSOLUTEANGLE|SXF_TRANSFERTRANSLATION, 0)
		NULL A 0 A_SpawnItemEx("ExGoreGuts_PS",0, 0, 32, random(3.0,5.0),random(3.0,5.0),random(0.0,10.0),random(0.0,360.0), SXF_ABSOLUTEANGLE|SXF_TRANSFERTRANSLATION, 0)
		NULL A 0 A_SpawnItemEx("ExBloodCloud_PS", 0, 0, 35, 0, 0, 0, 0, SXF_ABSOLUTEANGLE|SXF_TRANSFERTRANSLATION)
		TNT1 A 0 A_PlaySound("Jon/XGibs",CHAN_BODY,1.0)	
		Stop
	}
}

Actor FriendlyAnubisWarrior
{
    health 100
    radius 16
    height 56
    speed 6.4
    scale 0.52
    mass 5000
    painchance 96
	obituary "%o was killed by an Anubis Warrior's fireball."
    hitobituary "%o was clawed by an Anubis Warrior."
	MONSTER	
	+FLOORCLIP
	+FRIENDLY
	+MISSILEMORE
	-SOLID
	Species "Player"
    seesound "anubis/sight"
    activesound "anubis/active"
    painsound "anubis/pain"
    deathsound "anubis/death"
    States
    {
    Spawn:
		ANUB A 5 A_Look
		loop
    See:
		ANUB B 3 A_Chase
		ANUB B 2 A_Chase
		ANUB C 3 A_Chase
		ANUB C 2 A_Chase("", "")
		ANUB D 3 A_Chase
		ANUB D 2 A_Chase
		ANUB E 3 A_Chase
		ANUB E 2 A_Chase("", "")
		ANUB D 3 A_Chase
		ANUB D 2 A_Chase("", "")
		ANUB C 3 A_Chase
		ANUB C 2 A_Chase
		Loop
    Melee:
		ANUB FG 3 A_FaceTarget
		ANUB H 3 A_CustomMeleeAttack(random(1, 3) * 5, "anubis/meleehit")
		ANUB IJ 3 A_FaceTarget
		ANU2 AB 3 A_FaceTarget
		ANU2 C 3 A_CustomMeleeAttack(random(1, 3) * 5, "anubis/meleehit")
		ANU2 DE 3 A_FaceTarget
		goto See
    Missile:
		ANUB FG 4 A_FaceTarget
		ANUB H 3 A_FaceTarget
		ANUB I 3
		ANUB J 3 A_CustomMissile("FriendlyAnubisMissile",32,0)
		ANUB JJ 3
		goto See
    Pain:
		ANUB K 2
		ANUB L 2 A_Pain
		ANUB MNML 2
		goto See
    Death:
		ANUB O 2 ThrustThingZ(0,16,0,0)
		ANUB P 2
		ANUB Q 4 A_Scream
		ANUB RST 4
		ANUB U 4 A_NoBlocking
		ANUB U -1
		Stop
    XDeath:
		ANUB V 4 A_Scream	
		ANUB WW 3
		TNT1 A 0 A_NoBlocking
		ANUB X 3 A_PlaySound("anubis/xdeath", CHAN_BODY)
		ANUB Y 0 A_CustomMissile("FriendlyAnubisGib1",0+Random(24,45),0+Random(9,-9),0+Random(0,370),2,0+random(5,50))  
		ANUB Y 0 A_CustomMissile("FriendlyAnubisGib2",0+Random(24,45),0+Random(9,-9),0+Random(0,370),2,0+random(5,50))  
		ANUB Y 0 A_CustomMissile("FriendlyAnubisGib3",0+Random(24,45),0+Random(9,-9),0+Random(0,370),2,0+random(5,50))  
		ANUB Y 0 A_CustomMissile("FriendlyAnubisGib4",0+Random(24,45),0+Random(9,-9),0+Random(0,370),2,0+random(5,50))  
		ANUB Y 3
		ANUB Z 4
		ANUB "[" 4
		ANUB "[" -1
		stop
  }
}

Actor FriendlyAnubisMissile
{
    height 8
    radius 6
    damage (Random(1,3)*5)
    speed 23.8
    scale 0.70
    seesound "anubis/fireball"
    RenderStyle SoulTrans
    PROJECTILE
    +MISSILE
	Species "Player"
	+THRUSPECIES
    states
    {
    Spawn:
	ANFB ABC 3 Bright
	loop
    Death:
	ANFB DEFG 4 Bright
	stop
    }
}

Actor FriendlyAnubisGib1
{
    BounceFactor 0.38
    +DOOMBOUNCE
    Speed 8
    Projectile
    Scale 0.75
	+CLIENTSIDEONLY	
    -NOGRAVITY
    -NOBLOCKMAP
    states
    {
    Spawn:
	TNT1 A 0
	TNT1 A 0 ThrustThingZ(0,random(10,60),0,1)
	ANU2 FFFFFFFFFFFFFFF 2
    Death:
	ANU2 F 300
	ANU2 F 1 A_FadeOut
	goto Death+1
    }
}

Actor FriendlyAnubisGib2 : FriendlyAnubisGib1
{
    states
    {
    Spawn:
	TNT1 A 0
	TNT1 A 0 ThrustThingZ(0,random(10,60),0,1)
	ANU2 GGGGGGGGGGGGGGG 2
    Death:
	ANU2 G 300
	ANU2 G 1 A_FadeOut
	goto Death+1
    }
}

Actor FriendlyAnubisGib3 : FriendlyAnubisGib1
{
    states
    {
    Spawn:
	TNT1 A 0
	TNT1 A 0 ThrustThingZ(0,random(10,60),0,1)
	ANU2 HHHHHHHHHHHHHHH 2
    Death:
	ANU2 H 300
	ANU2 H 1 A_FadeOut
	goto Death+1
    }
}

Actor FriendlyAnubisGib4 : FriendlyAnubisGib1
{
    states
    {
    Spawn:
	TNT1 A 0
	TNT1 A 0 ThrustThingZ(0,random(10,60),0,1)
	ANU2 IIIIIIIIIIIIIII 2
    Death:
	ANU2 I 300
	ANU2 I 1 A_FadeOut
	goto Death+1
    }
}