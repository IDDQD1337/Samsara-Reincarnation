actor "Punch Dagger" : SamsaraStrifeguyWeapon
{
    Weapon.SlotNumber 0
    Weapon.SelectionOrder 3900
    Obituary "%k \cibackstabbed\c- %o\ci."
    Tag "Punch Dagger"
    +MELEEWEAPON
    +NOALERT
    +WIMPY_WEAPON
    States
    {
      Ready:
        PDAG A 1 A_WeaponReady
        loop

      Deselect:
        PDAG A 1 A_Lower
        loop

      Select:
        PDAG A 1 A_Raise
        loop

    Fire:
        PDAG B 4
        PDAG C 4 A_GiveInventory("SamsaraStrifePunchDaggerAttackHandler")
        PDAG D 5
        PDAG C 4
        PDAG B 5 A_ReFire
        goto Ready
    }
}

actor SamsaraStrifePunchDaggerAttackHandler : Trigger
{
    States
    {
      // Attack stuff
      Pickup:
        TNT1 A 0 A_JumpIfInventory("StaminaUpgradeDamage",0,"Pickup100")
        TNT1 A 0 A_JumpIfInventory("StaminaUpgradeDamage",90,"Pickup90")
        TNT1 A 0 A_JumpIfInventory("StaminaUpgradeDamage",80,"Pickup80")
        TNT1 A 0 A_JumpIfInventory("StaminaUpgradeDamage",70,"Pickup70")
        TNT1 A 0 A_JumpIfInventory("StaminaUpgradeDamage",60,"Pickup60")
        TNT1 A 0 A_JumpIfInventory("StaminaUpgradeDamage",50,"Pickup50")
        TNT1 A 0 A_JumpIfInventory("StaminaUpgradeDamage",40,"Pickup40")
        TNT1 A 0 A_JumpIfInventory("StaminaUpgradeDamage",30,"Pickup30")
        TNT1 A 0 A_JumpIfInventory("StaminaUpgradeDamage",20,"Pickup20")
        TNT1 A 0 A_JumpIfInventory("StaminaUpgradeDamage",10,"Pickup10")
      // 0 stamina upgrades
      Pickup0:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"Pickup0Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"Pickup0Coop")
      Pickup0DM:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasSpread",1,"Pickup0DMSpread")
        TNT1 A 0 A_CustomPunch(3*random(1,8),true,0,"PunchDaggerPuff")
        stop

      Pickup0DMSpread:
        TNT1 A 0 A_CustomPunch((3*random(1,8))*3,true,0,"PunchDaggerPuff")
        stop

      Pickup0Coop:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasSpread",1,"Pickup0CoopSpread")
        TNT1 A 0 A_CustomPunch(3*random(1,8),true,0,"PunchDaggerPuffCoop")
        stop

      Pickup0CoopSpread:
        TNT1 A 0 A_CustomPunch((3*random(1,8))*3,true,0,"PunchDaggerPuffCoop")
        stop

      // 1 stamina upgrade
      Pickup10:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"Pickup10Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"Pickup10Coop")
      Pickup10DM:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasSpread",1,"Pickup0DMSpread")
        TNT1 A 0 A_CustomPunch(4*random(1,9),true,0,"PunchDaggerPuff")
        stop

      Pickup10DMSpread:
        TNT1 A 0 A_CustomPunch((4*random(1,9))*3,true,0,"PunchDaggerPuff")
        stop

      Pickup10Coop:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasSpread",1,"Pickup0CoopSpread")
        TNT1 A 0 A_CustomPunch(4*random(1,9),true,0,"PunchDaggerPuffCoop")
        stop

      Pickup10CoopSpread:
        TNT1 A 0 A_CustomPunch((4*random(1,9))*3,true,0,"PunchDaggerPuffCoop")
        stop

      // 2 stamina upgrades
      Pickup20:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"Pickup20Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"Pickup20Coop")
      Pickup20DM:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasSpread",1,"Pickup0DMSpread")
        TNT1 A 0 A_CustomPunch(5*random(1,10),true,0,"PunchDaggerPuff")
        stop

      Pickup20DMSpread:
        TNT1 A 0 A_CustomPunch((5*random(1,10))*3,true,0,"PunchDaggerPuff")
        stop

      Pickup20Coop:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasSpread",1,"Pickup0CoopSpread")
        TNT1 A 0 A_CustomPunch(5*random(1,10),true,0,"PunchDaggerPuffCoop")
        stop

      Pickup20CoopSpread:
        TNT1 A 0 A_CustomPunch((5*random(1,10))*3,true,0,"PunchDaggerPuffCoop")
        stop

      // 3 stamina upgrades
      Pickup30:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"Pickup30Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"Pickup30Coop")
      Pickup30DM:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasSpread",1,"Pickup0DMSpread")
        TNT1 A 0 A_CustomPunch(6*random(1,11),true,0,"PunchDaggerPuff")
        stop

      Pickup30DMSpread:
        TNT1 A 0 A_CustomPunch((6*random(1,11))*3,true,0,"PunchDaggerPuff")
        stop

      Pickup30Coop:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasSpread",1,"Pickup0CoopSpread")
        TNT1 A 0 A_CustomPunch(6*random(1,11),true,0,"PunchDaggerPuffCoop")
        stop

      Pickup30CoopSpread:
        TNT1 A 0 A_CustomPunch((6*random(1,11))*3,true,0,"PunchDaggerPuffCoop")
        stop

      // 4 stamina upgrades
      Pickup40:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"Pickup40Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"Pickup40Coop")
      Pickup40DM:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasSpread",1,"Pickup0DMSpread")
        TNT1 A 0 A_CustomPunch(7*random(1,12),true,0,"PunchDaggerPuff")
        stop

      Pickup40DMSpread:
        TNT1 A 0 A_CustomPunch((7*random(1,12))*3,true,0,"PunchDaggerPuff")
        stop

      Pickup40Coop:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasSpread",1,"Pickup0CoopSpread")
        TNT1 A 0 A_CustomPunch(7*random(1,12),true,0,"PunchDaggerPuffCoop")
        stop

      Pickup40CoopSpread:
        TNT1 A 0 A_CustomPunch((7*random(1,12))*3,true,0,"PunchDaggerPuffCoop")
        stop

      // 5 stamina upgrades
      Pickup50:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"Pickup50Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"Pickup50Coop")
      Pickup50DM:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasSpread",1,"Pickup0DMSpread")
        TNT1 A 0 A_CustomPunch(8*random(1,13),true,0,"PunchDaggerPuff")
        stop

      Pickup50DMSpread:
        TNT1 A 0 A_CustomPunch((8*random(1,13))*3,true,0,"PunchDaggerPuff")
        stop

      Pickup50Coop:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasSpread",1,"Pickup0CoopSpread")
        TNT1 A 0 A_CustomPunch(8*random(1,13),true,0,"PunchDaggerPuffCoop")
        stop

      Pickup50CoopSpread:
        TNT1 A 0 A_CustomPunch((8*random(1,13))*3,true,0,"PunchDaggerPuffCoop")
        stop

      // 6 stamina upgrades
      Pickup60:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"Pickup60Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"Pickup60Coop")
      Pickup60DM:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasSpread",1,"Pickup0DMSpread")
        TNT1 A 0 A_CustomPunch(9*random(1,14),true,0,"PunchDaggerPuff")
        stop

      Pickup60DMSpread:
        TNT1 A 0 A_CustomPunch((9*random(1,14))*3,true,0,"PunchDaggerPuff")
        stop

      Pickup60Coop:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasSpread",1,"Pickup0CoopSpread")
        TNT1 A 0 A_CustomPunch(9*random(1,14),true,0,"PunchDaggerPuffCoop")
        stop

      Pickup60CoopSpread:
        TNT1 A 0 A_CustomPunch((9*random(1,14))*3,true,0,"PunchDaggerPuffCoop")
        stop

      // 7 stamina upgrades
      Pickup70:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"Pickup70Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"Pickup70Coop")
      Pickup70DM:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasSpread",1,"Pickup0DMSpread")
        TNT1 A 0 A_CustomPunch(10*random(1,15),true,0,"PunchDaggerPuff")
        stop

      Pickup70DMSpread:
        TNT1 A 0 A_CustomPunch((10*random(1,15))*3,true,0,"PunchDaggerPuff")
        stop

      Pickup70Coop:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasSpread",1,"Pickup0CoopSpread")
        TNT1 A 0 A_CustomPunch(10*random(1,15),true,0,"PunchDaggerPuffCoop")
        stop

      Pickup70CoopSpread:
        TNT1 A 0 A_CustomPunch((10*random(1,15))*3,true,0,"PunchDaggerPuffCoop")
        stop

      // 8 stamina upgrades
      Pickup80:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"Pickup80Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"Pickup80Coop")
      Pickup80DM:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasSpread",1,"Pickup0DMSpread")
        TNT1 A 0 A_CustomPunch(11*random(1,16),true,0,"PunchDaggerPuff")
        stop

      Pickup80DMSpread:
        TNT1 A 0 A_CustomPunch((11*random(1,16))*3,true,0,"PunchDaggerPuff")
        stop

      Pickup80Coop:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasSpread",1,"Pickup0CoopSpread")
        TNT1 A 0 A_CustomPunch(11*random(1,16),true,0,"PunchDaggerPuffCoop")
        stop

      Pickup80CoopSpread:
        TNT1 A 0 A_CustomPunch((11*random(1,16))*3,true,0,"PunchDaggerPuffCoop")
        stop

      // 9 stamina upgrades
      Pickup90:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"Pickup90Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"Pickup90Coop")
      Pickup90DM:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasSpread",1,"Pickup0DMSpread")
        TNT1 A 0 A_CustomPunch(12*random(1,17),true,0,"PunchDaggerPuff")
        stop

      Pickup90DMSpread:
        TNT1 A 0 A_CustomPunch((12*random(1,17))*3,true,0,"PunchDaggerPuff")
        stop

      Pickup90Coop:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasSpread",1,"Pickup0CoopSpread")
        TNT1 A 0 A_CustomPunch(12*random(1,17),true,0,"PunchDaggerPuffCoop")
        stop

      Pickup90CoopSpread:
        TNT1 A 0 A_CustomPunch((12*random(1,17))*3,true,0,"PunchDaggerPuffCoop")
        stop

      // 10 stamina upgrades
      Pickup100:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"Pickup100Coop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"Pickup100Coop")
      Pickup100DM:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasSpread",1,"Pickup0DMSpread")
        TNT1 A 0 A_CustomPunch(13*random(1,18),true,0,"PunchDaggerPuff")
        stop

      Pickup100DMSpread:
        TNT1 A 0 A_CustomPunch((13*random(1,18))*3,true,0,"PunchDaggerPuff")
        stop

      Pickup100Coop:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasSpread",1,"Pickup0CoopSpread")
        TNT1 A 0 A_CustomPunch(13*random(1,18),true,0,"PunchDaggerPuffCoop")
        stop

      Pickup100CoopSpread:
        TNT1 A 0 A_CustomPunch((13*random(1,18))*3,true,0,"PunchDaggerPuffCoop")
        stop
    }
}

actor PunchDaggerPuff : StrifeSpark
{
    DamageType "PunchDagger"
    SeeSound "dsempty"
    ActiveSound "strife/punchswing"
    AttackSound "strife/punchswing"
    +FORCEXYBILLBOARD
    +PUFFGETSOWNER
    +PUFFONACTORS
    States
    {
      Spawn:
        SPW3 ABCDEFGH 3
        stop

      Melee:
        TNT1 A 0 A_GiveInventory("SamsaraStrifePunchDaggerHitMetalSoundPlayer",1,AAPTR_TARGET)
        goto Spawn

      XDeath:
        TNT1 A 1 A_GiveInventory("SamsaraStrifePunchDaggerHitMeatSoundPlayer",1,AAPTR_TARGET)
        stop

      Crash:
        SPW2 ABCD 4
        stop
    }
}

actor PunchDaggerPuffCoop : PunchDaggerPuff { +MTHRUSPECIES }

actor SamsaraStrifePunchDaggerHitMeatSoundPlayer : Trigger
{
    States
    {
      // Sound stuff
      Pickup:
        TNT1 A 0 A_PlaySound("strife/hitmeat",CHAN_WEAPON)
        stop
    }
}

actor SamsaraStrifePunchDaggerHitMetalSoundPlayer : Trigger
{
    States
    {
      // Sound stuff
      Pickup:
        TNT1 A 0 A_PlaySound("strife/hitmetal",CHAN_WEAPON)
        stop
    }
}
