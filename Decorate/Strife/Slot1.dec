Actor StrifeBeaconCooldown : Inventory
{
	+Inventory.UNDROPPABLE
	-INVBAR
	Inventory.MaxAmount 120
}	

Actor StrifeBeaconItem5 : StrifeBeaconItem
{
	Inventory.Amount 1
	Inventory.MaxAmount 1
	+INVENTORY.UNDROPPABLE
	+INVENTORY.HUBPOWER
	Radius 16
    Height 16
	Inventory.PickupMessage "Rebel Reinforcements!"
	Inventory.Icon "I_BEAC"
	Inventory.RestrictedTo "StrifePlayer"
	Tag "Ally Beacon"  
	States
	{		
		Spawn:
			BEAC A -1
			stop
		Use:
			TNT1 A 0 A_JumpIfInventory("StrifeBeaconCooldown", 1, "UseFail")	
			TNT1 A 0 A_FireCustomMissile("StrifeSuperRebelSpawner", 0, 0)
			TNT1 A 1 ACS_NamedExecuteAlways("SAMSARA_STRIFECOOLDOWN")
			TNT1 A 0 A_GiveInventory("StrifeBeaconCooldown", 120)
			fail	
		UseFail:
			TNT1 A 1 A_Print("The Front is training more units, try again later.")
			Fail
	}
}

Actor StrifeSuperRebelSpawner : StrifeBeaconSpawner
{
	States
	{
		Spawn:
		  BEAC A 0
		  Goto SpawnLoop
		FuckYouImAPickup:
          "----" A 0 A_PlaySound("weapons/hegrenadebang")
          "----" A 0 A_SpawnItemEx("Bang4Cloud")
          //"----" A 0 A_SpawnItemEx("StrifeBeaconItem", 0,0,0, random(0,4),0,random(0,8), random(0, 360))
		  "----" A 0 A_TakeFromTarget("StrifeBeaconCooldown", 120)
          stop
	}	  
}

Actor FriendlySuperRebelSpawner
{
	+ISMONSTER
	-COUNTKILL
	+FRIENDLY
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_Jump(256, "SpawnRifle", "SpawnFlamer", "SpawnMissile", "SoawnGren", "SpawnMauler")
			Goto SpawnRifle
		SpawnRifle:
			TNT1 A 0 A_SpawnItemEx("FriendlyRebelRifle",0,0,0,(1-(random(0,1)*2))*8,(1-(random(0,1)*2))*8,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
			stop
		SpawnFlamer:
			TNT1 A 0 A_SpawnItemEx("FriendlyRebelFlamer",0,0,0,(1-(random(0,1)*2))*8,(1-(random(0,1)*2))*8,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
			stop
		SpawnMissile:
			TNT1 A 0 A_SpawnItemEx("FriendlyRebelMissile",0,0,0,(1-(random(0,1)*2))*8,(1-(random(0,1)*2))*8,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
			stop
		SpawnGren:
			TNT1 A 0 A_SpawnItemEx("FriendlyRebelGrenade",0,0,0,(1-(random(0,1)*2))*8,(1-(random(0,1)*2))*8,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
			stop		
		SpawnMauler:
			TNT1 A 0 A_SpawnItemEx("FriendlyRebelMauler",0,0,0,(1-(random(0,1)*2))*8,(1-(random(0,1)*2))*8,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
			stop				
	}
}

Actor FriendlyRebelRifle
{  
	Health 100
	MaxStepHeight 24
	MaxDropoffHeight 24
	MaxTargetRange 640
	PainChance 250
	Speed 8
	Radius 16
	Height 50
	Monster
	+MISSILEMORE
	+FLOORCLIP
	+FRIENDLY
	-SOLID
	MinMissileChance 150
	SeeSound "strife/rebel/sight"
	PainSound "strife/rebel/pain"
	DeathSound "strife/rebel/death"
	ActiveSound "strife/rebel/active"
	Obituary "%o was gunned down by the Rebel army."
	Species "Player"
	Tag "Rifle Rebel"
	DamageFactor "Fire", 0.5
	DamageFactor "RebelMissile", 0
	States
	{
	Spawn:
		HMN1 AB 12 A_Look
		loop
	See:
		HMN1 AABBCCDD 3 A_Chase
		loop
	Melee:
	Missile:
		HMN1 E 0 A_AlertMonsters(1024, AMF_TARGETEMITTER)
		HMN1 E 6 A_FaceTarget
		HMN1 F 0 A_PlayWeaponSound("strife/riflefire")
		HMN1 F 6 A_CustomMissile("RebelBullet_5",0,1,0,8,0)
		HMN1 E 0 A_MonsterRefire(0,"See")
		Loop
	Pain:
		HMN1 O 3
		HMN1 O 3 A_Pain
		Goto See
	Death:
		HMN1 G 5 A_ScreamandUnblock
		HMN1 H 5 
		HMN1 IJKLM 4
		HMN1 L -1
		Stop
	Death.HexGreenFire:
	Death.QuakeFire:
	Death.FireExplosive:
	Death.PhosFireCoop:
	Burn:
		SBRN A 3 Bright A_PlaySoundEx("strife/burndeath", CHAN_VOICE)
		SBRN B 3 Bright A_DropFire
		SBRN C 3 Bright A_Wander
		SBRN D 3 Bright A_NoBlocking
		SBRN E 5 Bright A_DropFire
		SBRN FGH 5 Bright A_Wander
		SBRN I 5 Bright A_DropFire
		SBRN JKL 5 Bright A_Wander
		SBRN M 5 Bright A_DropFire
		SBRN NOPQPQ 5 Bright
		SBRN RSTU 7 Bright
		SBRN V -1
		Stop	
	Disintegrate:
		SDIS A 5 A_PlaySoundEx("strife/disruptdeath", CHAN_VOICE)
		SDIS BC 5
		SDIS D 5 A_NoBlocking
		SDIS EF 5
		SDIS GHIJ 4
		TNT1 A -1
		stop	
	Death:
		HMN1 G 5
		HMN1 H 5 A_Scream
		HMN1 I 3 A_NoBlocking
		HMN1 J 4
		HMN1 KLM 3
		HMN1 N -1
		Stop
	XDeath:
		RGIB A 4 A_TossGib
		RGIB B 4 
		TNT1 A 0 A_Playsound("Strife/GibDead")
		RGIB C 3 A_NoBlocking
		RGIB DEF 3 A_TossGib
		RGIB G 3
		RGIB H -1
		Stop
	Crush:
		DIE1 A 0 A_Jump(128,"Crush2")
		DIE1 A -1
		Stop
	Crush2:
		DIE2 A -1
		Stop
	}
}	

Actor FriendlyRebelFlamer : FriendlyRebelRifle
{
	Tag "Flamethrower Rebel"
	MaxTargetRange 264
	States
	{
	Melee:
	Missile:
		HMN1 E 2 A_FaceTarget
	FlamerLoop:
		HMN1 E 0 A_AlertMonsters(512, AMF_TARGETEMITTER)
		HMN1 F 2 Bright A_CustomMissile("RebelFlameMissile_2")
		HMN1 F 3 Bright A_FaceTarget
		HMN1 E 0 A_MonsterRefire(0,"See")
		Loop
	}
}

Actor FriendlyRebelMissile : FriendlyRebelRifle
{
	Tag "Mini Missile Rebel"
	MaxTargetRange 2048
	States
	{
	Melee:
	Missile:
		HMN1 E 0 A_AlertMonsters(1024, AMF_TARGETEMITTER)
		HMN1 E 10 A_FaceTarget
		HMN1 F 5 Bright A_CustomMissile("RebelMiniMissile_2",32.0, 0, random(-100.0,120.0)/100)
		Goto See
	}
}

Actor FriendlyRebelGrenade : FriendlyRebelRifle
{
	Tag "Grenade Rebel"
	MaxTargetRange 2048
	States
	{
	Melee:
	Missile:
		HMN1 E 0 A_AlertMonsters(1024, AMF_TARGETEMITTER)
		HMN1 E 10 A_FaceTarget
		HMN1 F 5 Bright A_CustomMissile("RebelHEGrenade_2",32.0, -10)
		HMN1 E 10 A_FaceTarget
		HMN1 F 5 Bright A_CustomMissile("RebelHEGrenade_2",32.0, 10)		
		Goto See
	}
}

Actor FriendlyRebelMauler : FriendlyRebelRifle
{
	Tag "Mauler Rebel"
	MaxTargetRange 2048
	States
	{
	Melee:
	Missile:
		HMN1 E 0 A_AlertMonsters(1024, AMF_TARGETEMITTER)
		HMN1 E 8 A_FaceTarget
		HMN1 F 0 Bright A_PlaySound("strife/maulerfire1")
		HMN1 FFFFFFFFF 0 A_CustomMissile("StrifeMaulerBulletRebel", 32.0, 0, random(-1125,1125)/100, CMF_AIMDIRECTION, Random(-7,7))
		HMN1 F 8 Bright A_CustomMissile("StrifeMaulerBulletRebel", 32.0, 0, random(-1125,1125)/100, CMF_AIMDIRECTION, Random(-7,7))
		Goto See
	}
}

actor RebelBullet_5 : FastProjectile
{
    Damage (Random(1,3)*5)
    Radius 1
    Height 1
    Speed 320
    Projectile
    Renderstyle "Normal"
    Species "Player"	
    +BLOODSPLATTER
    +THRUSPECIES
    +NOTIMEFREEZE
    Alpha 1.0
    Decal Bulletchip
    DamageType "StrifeRebelBullet"
    States
    {
      Spawn:
        TNT1 A 1
        loop
      Death:
        TNT1 A 1 A_SpawnItem("StrifeBulletPuff")
        stop
      XDeath:
        TNT1 A 1
        stop
    }
}