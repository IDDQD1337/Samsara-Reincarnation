actor DukePipebombSpeed : Counter { Inventory.MaxAmount 100 }
actor DukeThrownPipebomb : Boolean {}
actor DukePipebombHold : DukeThrownPipebomb {}
actor DukePipebombFired : DukeThrownPipebomb {}
actor DukePipebombNoAmmoFired : DukeThrownPipebomb {}

actor Pipebombs : DukeWeapon
{
	Weapon.SlotNumber 1
	Weapon.SelectionOrder 2200
	Weapon.AmmoUse 1
	Weapon.AmmoGive 5
	Weapon.AmmoType "RocketAmmo"
	//Obituary "%k gave %o the pipe."
	Inventory.Pickupmessage "You got the Pipebombs!"
	Inventory.PickupSound "duke/itemget"
	//scale 0.5
	+NOALERT
	+INVENTORY.UNDROPPABLE
	+WEAPON.AMMO_OPTIONAL
	+WEAPON.EXPLOSIVE
	+WEAPON.NOAUTOAIM
	Tag "Pipebombs"
	States
	{
	  Spawn:
		WPBM A -1
		Stop

	  ReadyB:
		TNT1 A 0 A_JumpIfInventory("DB1",1,"AltFireB1")
		TNT1 A 0 A_JumpIfInventory("DB2",1,"AltFireB2")
		TNT1 A 0 A_JumpIfInventory("DB3",1,"AltFireB3")
		TNT1 A 0 A_JumpIfInventory("DB4",1,"AltFireB4")
		TNT1 A 0 A_JumpIfInventory("DB5",1,"AltFireB5")
		TNT1 A 0 A_JumpIfInventory("DB6",1,"AltFireB6")
		TNT1 A 0 A_JumpIfInventory("DB7",1,"AltFireB7")
		TNT1 A 0 A_JumpIfInventory("DB8",1,"AltFireB8")
		TNT1 A 0 A_JumpIfInventory("DB9",1,"AltFireB9")
		TNT1 A 0 A_JumpIfInventory("DB10",1,"AltFireB10")
		TNT1 A 0 A_JumpIfInventory("DB11",1,"AltFireB11")
		TNT1 A 0 A_JumpIfInventory("DB12",1,"AltFireB12")
		TNT1 A 0 A_JumpIfInventory("DB13",1,"AltFireB13")
		TNT1 A 0 A_JumpIfInventory("DB14",1,"AltFireB14")
		TNT1 A 0 A_JumpIfInventory("DB15",1,"AltFireB15")
		TNT1 A 0 A_JumpIfInventory("DB16",1,"AltFireB16")
		TNT1 A 0 A_JumpIfInventory("DB17",1,"AltFireB17")
		TNT1 A 0 A_JumpIfInventory("DB18",1,"AltFireB18")
		TNT1 A 0 A_JumpIfInventory("DukeReady",1,"IntroTaunt")
		TNT1 A 0 A_JumpIfInventory("DukeWaiting",15,"WaitingTaunt")
		TNT1 AA 1 A_WeaponReady(WRF_NOPRIMARY|WRF_NOSWITCH)
		TNT1 A 0 A_ReFire
		TNT1 A 0 A_JumpIfInventory("DBSHOT1",1,"ReadyB")
		Goto ReadyA
	  ReadyA:
		TNT1 A 0 A_JumpIfInventory("DBSHOT1",1,"ReadyB")
		Goto Super::ReadyA
	  Ready:
		TNT1 A 0 A_JumpIfInventory("RocketAmmo",1,1)
		goto Ready3
		TNT1 A 0 A_JumpIfInventory("DBSHOT",1,"ReadyA")
		TNT1 A 0 A_JumpIfInventory("DBSHOT1",1,"ReadyB")
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"ReadyB")
		TNT1 A 0 A_JumpIfInventory("DukeReady",1,"IntroTaunt")
		TNT1 A 0 A_JumpIfInventory("DukeWaiting",15,"WaitingTaunt")
		TNT1 A 0 A_JumpIfInventory("DukeGiveMoney",1,"GiveMoney")
		TNT1 A 0 A_JumpIfInventory("DukeThrownPipebomb",1,"Ready2")
		TNT1 A 0 A_JumpIfInventory("DukeStomp", 1, "Stomp")
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 2)
		DKPB A 1 A_WeaponReady
		Loop
		DKPA A 1 A_WeaponReady
		Loop
	  Ready2:
		TNT1 A 0 A_JumpIfInventory("DukeStomp", 1, "Stomp")
		TNT1 A 0 A_JumpIfInventory("DukeReady",1,"IntroTaunt")
		TNT1 A 0 A_JumpIfInventory("DukeWaiting",15,"WaitingTaunt")
		DKPB O 1 A_WeaponReady
		Loop
	  Ready3:
		TNT1 A 0 A_JumpIfInventory("DukeStomp", 1, "Stomp")
		TNT1 A 0 A_JumpIfInventory("DukeThrownPipebomb",1,"Ready2")
		TNT1 A 0 A_JumpIfInventory("DukeReady",1,"IntroTaunt")
		TNT1 A 0 A_JumpIfInventory("DukeWaiting",15,"WaitingTaunt")
		TNT1 A 1 A_WeaponReady
		Goto Ready

	  Deselect:
		TNT1 A 0 A_TakeInventory("DukePipebombSpeed",999)
		TNT1 A 0 A_TakeInventory("DukePipebombHold",1)
		TNT1 A 0 A_TakeInventory("DukePipebombFired",1)
		TNT1 A 0 A_JumpIfInventory("DukeThrownPipebomb",1,"DeselectDetonator")
		TNT1 A 0 A_TakeInventory("DukeThrownPipebomb",1)
		TNT1 A 0 A_JumpIfInventory("RocketAmmo",1,1)
		Goto Super::Deselect
		DKPB A 0 A_JumpIfInventory("DukeLABToken", 1, "DeselectLAB")
		Goto Super::Deselect
	  DeselectLAB:
		DKPA A 0
		Goto Super::Deselect
	  DeselectDetonator:
		DKPB O 0 A_TakeInventory("DukeThrownPipebomb",1)
		Goto Super::Deselect

	  Select:
		TNT1 A 0 A_TakeInventory("DukePipebombSpeed",999)
		TNT1 A 0 A_TakeInventory("DukeThrownPipebomb",1)
		TNT1 A 0 A_TakeInventory("DukePipebombHold",1)
		TNT1 A 0 A_TakeInventory("DukePipebombFired",1)
		TNT1 A 0 A_JumpIfInventory("RocketAmmo",1,1)
		Goto Super::Deselect
		DKPB A 0 A_JumpIfInventory("DukeLABToken", 1, "SelectLAB")
		Goto Super::Select
	  SelectLAB:
		DKPA A 0
		Goto Super::Select

	  Fire:
		TNT1 A 0 A_JumpIfInventory("DukeStomp", 1, "Stomp")
		TNT1 A 0 A_JumpIfInventory("DukeThrownPipebomb",1,"FireD")
		TNT1 A 0 A_JumpIfNoAmmo("Nothing")
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"FireB")
		TNT1 A 0 A_JumpIfInventory("DukePipebombFired",1,"ReadyB")
		TNT1 A 0 A_JumpIfInventory("DBSHOT",1,"ReadyB")
		TNT1 A 0 A_GiveInventory("DBSHOT",1)
		TNT1 A 0 A_GunFlash
		TNT1 A 0 A_JumpIfInventory("DB1",1,"AltFireA1")
		TNT1 A 0 A_JumpIfInventory("DB2",1,"AltFireA2")
		TNT1 A 0 A_JumpIfInventory("DB3",1,"AltFireA3")
		TNT1 A 0 A_JumpIfInventory("DB4",1,"AltFireA4")
		TNT1 A 0 A_JumpIfInventory("DB5",1,"AltFireA5")
		TNT1 A 0 A_JumpIfInventory("DB6",1,"AltFireA6")
		TNT1 A 0 A_JumpIfInventory("DB7",1,"AltFireA7")
		TNT1 A 0 A_JumpIfInventory("DB8",1,"AltFireA8")
		TNT1 A 0 A_JumpIfInventory("DB9",1,"AltFireA9")
		TNT1 A 0 A_JumpIfInventory("DB10",1,"AltFireA10")
		TNT1 A 0 A_JumpIfInventory("DB11",1,"AltFireA11")
		TNT1 A 0 A_JumpIfInventory("DB12",1,"AltFireA12")
		TNT1 A 0 A_JumpIfInventory("DB13",1,"AltFireA13")
		TNT1 A 0 A_JumpIfInventory("DB14",1,"AltFireA14")
		TNT1 A 0 A_JumpIfInventory("DB15",1,"AltFireA15")
		TNT1 A 0 A_JumpIfInventory("DB16",1,"AltFireA16")
		TNT1 A 0 A_JumpIfInventory("DB17",1,"AltFireA17")
		TNT1 A 0 A_JumpIfInventory("DB18",1,"AltFireA18")
		Goto ReadyA

	  FireB:
		TNT1 A 0 A_GiveInventory("DBSHOT1",3)
		TNT1 A 0 A_GunFlash
		TNT1 A 0 A_JumpIfInventory("DB1",1,"AltFireB1")
		TNT1 A 0 A_JumpIfInventory("DB2",1,"AltFireB2")
		TNT1 A 0 A_JumpIfInventory("DB3",1,"AltFireB3")
		TNT1 A 0 A_JumpIfInventory("DB4",1,"AltFireB4")
		TNT1 A 0 A_JumpIfInventory("DB5",1,"AltFireB5")
		TNT1 A 0 A_JumpIfInventory("DB6",1,"AltFireB6")
		TNT1 A 0 A_JumpIfInventory("DB7",1,"AltFireB7")
		TNT1 A 0 A_JumpIfInventory("DB8",1,"AltFireB8")
		TNT1 A 0 A_JumpIfInventory("DB9",1,"AltFireB9")
		TNT1 A 0 A_JumpIfInventory("DB10",1,"AltFireB10")
		TNT1 A 0 A_JumpIfInventory("DB11",1,"AltFireB11")
		TNT1 A 0 A_JumpIfInventory("DB12",1,"AltFireB12")
		TNT1 A 0 A_JumpIfInventory("DB13",1,"AltFireB13")
		TNT1 A 0 A_JumpIfInventory("DB14",1,"AltFireB14")
		TNT1 A 0 A_JumpIfInventory("DB15",1,"AltFireB15")
		TNT1 A 0 A_JumpIfInventory("DB16",1,"AltFireB16")
		TNT1 A 0 A_JumpIfInventory("DB17",1,"AltFireB17")
		TNT1 A 0 A_JumpIfInventory("DB18",1,"AltFireB18")
		Goto ReadyB

	  FireC:
		TNT1 A 0 A_JumpIfInventory("DB1",1,"AltFireA1")
		TNT1 A 0 A_JumpIfInventory("DB2",1,"AltFireA2")
		TNT1 A 0 A_JumpIfInventory("DB3",1,"AltFireA3")
		TNT1 A 0 A_JumpIfInventory("DB4",1,"AltFireA4")
		TNT1 A 0 A_JumpIfInventory("DB5",1,"AltFireA5")
		TNT1 A 0 A_JumpIfInventory("DB6",1,"AltFireA6")
		TNT1 A 0 A_JumpIfInventory("DB7",1,"AltFireA7")
		TNT1 A 0 A_JumpIfInventory("DB8",1,"AltFireA8")
		TNT1 A 0 A_JumpIfInventory("DB9",1,"AltFireA9")
		TNT1 A 0 A_JumpIfInventory("DB10",1,"AltFireA10")
		TNT1 A 0 A_JumpIfInventory("DB11",1,"AltFireA11")
		TNT1 A 0 A_JumpIfInventory("DB12",1,"AltFireA12")
		TNT1 A 0 A_JumpIfInventory("DB13",1,"AltFireA13")
		TNT1 A 0 A_JumpIfInventory("DB14",1,"AltFireA14")
		TNT1 A 0 A_JumpIfInventory("DB15",1,"AltFireA15")
		TNT1 A 0 A_JumpIfInventory("DB16",1,"AltFireA16")
		TNT1 A 0 A_JumpIfInventory("DB17",1,"AltFireA17")
		TNT1 A 0 A_JumpIfInventory("DB18",1,"AltFireA18")
		Goto ReadyA

	  FireD:
		TNT1 A 0 A_GunFlash
		TNT1 A 0 A_JumpIfInventory("DB1",1,"AltFireA1")
		TNT1 A 0 A_JumpIfInventory("DB2",1,"AltFireA2")
		TNT1 A 0 A_JumpIfInventory("DB3",1,"AltFireA3")
		TNT1 A 0 A_JumpIfInventory("DB4",1,"AltFireA4")
		TNT1 A 0 A_JumpIfInventory("DB5",1,"AltFireA5")
		TNT1 A 0 A_JumpIfInventory("DB6",1,"AltFireA6")
		TNT1 A 0 A_JumpIfInventory("DB7",1,"AltFireA7")
		TNT1 A 0 A_JumpIfInventory("DB8",1,"AltFireA8")
		TNT1 A 0 A_JumpIfInventory("DB9",1,"AltFireA9")
		TNT1 A 0 A_JumpIfInventory("DB10",1,"AltFireA10")
		TNT1 A 0 A_JumpIfInventory("DB11",1,"AltFireA11")
		TNT1 A 0 A_JumpIfInventory("DB12",1,"AltFireA12")
		TNT1 A 0 A_JumpIfInventory("DB13",1,"AltFireA13")
		TNT1 A 0 A_JumpIfInventory("DB14",1,"AltFireA14")
		TNT1 A 0 A_JumpIfInventory("DB15",1,"AltFireA15")
		TNT1 A 0 A_JumpIfInventory("DB16",1,"AltFireA16")
		TNT1 A 0 A_JumpIfInventory("DB17",1,"AltFireA17")
		TNT1 A 0 A_JumpIfInventory("DB18",1,"AltFireA18")
		Goto ReadyA

	  Flash:
		TNT1 A 0 A_JumpIfInventory("DukeThrownPipebomb",1,"Fire2")
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"FlashHold")
		TNT1 A 0 A_JumpIfInventory("DBSHOT1",1,"FlashHold")
		TNT1 A 0 A_JumpIfInventory("DBSHOT",1,"FlashA")
		stop
	  Flash2:
		TNT1 A 0 A_TakeInventory("DBSHOT",1)
		Goto FlashHold
	  FlashA:
		TNT1 A 0 A_JumpIfInventory("DukePipebombFired",1,"Flash2")
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"FlashHold")
		TNT1 A 0 A_JumpIfInventory("DBSHOT1",1,"FlashHold")
		TNT1 A 0 A_GiveInventory("DBSHOT",60)
		TNT1 A 0 A_GiveInventory("DukePipebombFired",1)
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, "FlashALAB")
		DKPB AABCDE 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DKPB E 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_TakeInventory("DukePipebombFired",1)
		TNT1 A 0 A_GiveInventory("DukePipebombHold",1)
		TNT1 A 0 A_TakeInventory("DBSHOT",99)
		DKPB E 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_GiveInventory("DBSHOT1",3)
		Goto FlashHold
	  FlashALAB:
		DKPA AABCDE 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DKPA E 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_TakeInventory("DukePipebombFired",1)
		TNT1 A 0 A_GiveInventory("DukePipebombHold",1)
		TNT1 A 0 A_TakeInventory("DBSHOT",99)
		DKPA E 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_GiveInventory("DBSHOT1",3)
		Goto FlashHold
	  FlashHold:
		TNT1 A 0 A_GiveInventory("DukePipebombSpeed",1)
		TNT1 A 0 A_TakeInventory("DukePipebombFired",1)
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, "FlashHoldLAB")
		DKPB F 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_TakeInventory("DBSHOT1",1)
		TNT1 A 0 A_TakeInventory("DBSHOT",1)
		TNT1 A 0 A_GiveInventory("DukePipebombSpeed",1)
		DKPB F 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_TakeInventory("DBSHOT1",1)
		TNT1 A 0 A_GiveInventory("DukePipebombSpeed",1)
		DKPB F 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_TakeInventory("DBSHOT1",1)
		TNT1 A 0 A_GiveInventory("DukePipebombSpeed",1)
		DKPB F 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		goto Release

	  FlashHoldLAB:
		DKPA F 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_TakeInventory("DBSHOT1",1)
		TNT1 A 0 A_TakeInventory("DBSHOT",1)
		TNT1 A 0 A_GiveInventory("DukePipebombSpeed",1)
		DKPA F 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_TakeInventory("DBSHOT1",1)
		TNT1 A 0 A_GiveInventory("DukePipebombSpeed",1)
		DKPA F 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_TakeInventory("DBSHOT1",1)
		TNT1 A 0 A_GiveInventory("DukePipebombSpeed",1)
		DKPA F 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		Goto Release
	  Release:
		TNT1 A 0 A_TakeInventory("DBSHOT1",99)
		TNT1 A 0 A_GiveInventory("DBSHOT",60)
		TNT1 A 0 A_TakeInventory("DukeKaboom",9)
		TNT1 A 0 A_TakeInventory("DukePipebombHold",9)
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 5)
		DKPB FFGH 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		Goto ReleaseConsider
		DKPA FFGH 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		Goto ReleaseConsider
	  ReleaseConsider:
		DKPB I 1 A_JumpIfInventory("DukeLABToken", 1, "ReleaseConsiderLAB")
		TNT1 A 0 A_JumpIfInventory("DukePipebombSpeed",100,"ReleaseSpeed11")
		TNT1 A 0 A_JumpIfInventory("DukePipebombSpeed",90,"ReleaseSpeed10")
		TNT1 A 0 A_JumpIfInventory("DukePipebombSpeed",80,"ReleaseSpeed9")
		TNT1 A 0 A_JumpIfInventory("DukePipebombSpeed",70,"ReleaseSpeed8")
		TNT1 A 0 A_JumpIfInventory("DukePipebombSpeed",60,"ReleaseSpeed7")
		TNT1 A 0 A_JumpIfInventory("DukePipebombSpeed",50,"ReleaseSpeed6")
		TNT1 A 0 A_JumpIfInventory("DukePipebombSpeed",40,"ReleaseSpeed5")
		TNT1 A 0 A_JumpIfInventory("DukePipebombSpeed",30,"ReleaseSpeed4")
		TNT1 A 0 A_JumpIfInventory("DukePipebombSpeed",20,"ReleaseSpeed3")
		TNT1 A 0 A_JumpIfInventory("DukePipebombSpeed",10,"ReleaseSpeed2")
		DKPB I 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		Goto ReleaseSpeed1
	  ReleaseConsiderLAB:
		DKPA I 1
		TNT1 A 0 A_JumpIfInventory("DukePipebombSpeed",100,"ReleaseSpeed11")
		TNT1 A 0 A_JumpIfInventory("DukePipebombSpeed",90,"ReleaseSpeed10")
		TNT1 A 0 A_JumpIfInventory("DukePipebombSpeed",80,"ReleaseSpeed9")
		TNT1 A 0 A_JumpIfInventory("DukePipebombSpeed",70,"ReleaseSpeed8")
		TNT1 A 0 A_JumpIfInventory("DukePipebombSpeed",60,"ReleaseSpeed7")
		TNT1 A 0 A_JumpIfInventory("DukePipebombSpeed",50,"ReleaseSpeed6")
		TNT1 A 0 A_JumpIfInventory("DukePipebombSpeed",40,"ReleaseSpeed5")
		TNT1 A 0 A_JumpIfInventory("DukePipebombSpeed",30,"ReleaseSpeed4")
		TNT1 A 0 A_JumpIfInventory("DukePipebombSpeed",20,"ReleaseSpeed3")
		TNT1 A 0 A_JumpIfInventory("DukePipebombSpeed",10,"ReleaseSpeed2")
		DKPA I 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		Goto ReleaseSpeed1
	  ReleaseSpeed1:
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 2)
		TNT1 A 0 A_FireCustomMissile("DukePipebomb",0,0,2,0,0,15)
		goto ReleaseFinish
		TNT1 A 0 A_FireCustomMissile("DukePipebombBeach",0,0,2,0,0,15)
		goto ReleaseFinish
	  ReleaseSpeed2:
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 3)
		DKPB I 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_FireCustomMissile("DukePipebomb2",0,0,2,0,0,15)
		goto ReleaseFinish
		DKPA I 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_FireCustomMissile("DukePipebombBeach2",0,0,2,0,0,15)
		goto ReleaseFinish
	  ReleaseSpeed3:
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 3)
		DKPB I 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_FireCustomMissile("DukePipebomb3",0,0,2,0,0,15)
		goto ReleaseFinish
		DKPA I 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_FireCustomMissile("DukePipebombBeach3",0,0,2,0,0,15)
		goto ReleaseFinish
	  ReleaseSpeed4:
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 3)
		DKPB I 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_FireCustomMissile("DukePipebomb4",0,0,2,0,0,15)
		goto ReleaseFinish
		DKPA I 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_FireCustomMissile("DukePipebombBeach4",0,0,2,0,0,15)
		goto ReleaseFinish
	  ReleaseSpeed5:
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 3)
		DKPB I 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_FireCustomMissile("DukePipebomb5",0,0,2,0,0,15)
		goto ReleaseFinish
		DKPA I 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_FireCustomMissile("DukePipebombBeach5",0,0,2,0,0,15)
		goto ReleaseFinish
	  ReleaseSpeed6:
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 3)
		DKPB I 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_FireCustomMissile("DukePipebomb6",0,0,2,0,0,15)
		goto ReleaseFinish
		DKPA I 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_FireCustomMissile("DukePipebombBeach6",0,0,2,0,0,15)
		goto ReleaseFinish
	  ReleaseSpeed7:
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 3)
		DKPB I 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_FireCustomMissile("DukePipebomb7",0,0,2,0,0,15)
		goto ReleaseFinish
		DKPA I 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_FireCustomMissile("DukePipebombBeach7",0,0,2,0,0,15)
		goto ReleaseFinish
	  ReleaseSpeed8:
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 3)
		DKPB I 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_FireCustomMissile("DukePipebomb8",0,0,2,0,0,15)
		goto ReleaseFinish
		DKPA I 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_FireCustomMissile("DukePipebombBeach8",0,0,2,0,0,15)
		goto ReleaseFinish
	  ReleaseSpeed9:
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 3)
		DKPB I 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_FireCustomMissile("DukePipebomb9",0,0,2,0,0,15)
		goto ReleaseFinish
		DKPA I 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_FireCustomMissile("DukePipebombBeach9",0,0,2,0,0,15)
		goto ReleaseFinish
	  ReleaseSpeed10:
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 3)
		DKPB I 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_FireCustomMissile("DukePipebomb10",0,0,2,0,0,15)
		goto ReleaseFinish
		DKPA I 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_FireCustomMissile("DukePipebombBeach10",0,0,2,0,0,15)
		goto ReleaseFinish
	  ReleaseSpeed11:
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 3)
		DKPB I 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_FireCustomMissile("DukePipebomb11",0,0,2,0,0,15)
		goto ReleaseFinish
		DKPA I 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_FireCustomMissile("DukePipebombBeach11",0,0,2,0,0,15)
		goto ReleaseFinish
	  ReleaseFinish:
		TNT1 A 0 A_TakeInventory("RocketAmmo",1,TIF_NOTAKEINFINITE)
		TNT1 A 0 A_GiveInventory("DukeThrownPipebomb",1)
		TNT1 A 0 A_TakeInventory("DukePipebombSpeed",999)
		DKPB J 2 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DKPB JKLMNN 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 2
	  DetonatorRaise:
		DKPB VUTSRO 1 
		DKPB O 2 A_TakeInventory("DBSHOT",99)
		Stop

	  Fire2:
		TNT1 A 0 A_GiveInventory("DBSHOT",99)
		DKPB OPQ 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_GiveInventory("DukeKaboom",1)
		DKPB QP 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DKPB O 7 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_TakeInventory("DukeThrownPipebomb",1)
		TNT1 A 0 A_TakeInventory("DukeKaboom",1)
		DKPB ORSTUV 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_TakeInventory("DukeThrownPipebomb",1)
		TNT1 A 0 A_JumpIfNoAmmo("Fire3")
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, "Fire2LAB")
		DKPB EDCBAA 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DKPB A 2 A_TakeInventory("DBSHOT",99)
		Stop
	  Fire2LAB:
		DKPA EDCBAA 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DKPA A 2 A_TakeInventory("DBSHOT",99)
		Stop

	  Fire3:
		TNT1 A 3 A_TakeInventory("DBSHOT",99)
		Stop

	  Nothing:
		TNT1 A 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SelectWeapon("Glock 17")
		goto Deselect

	  AltFire:
		TNT1 A 0 A_JumpIfInventory("DukeClassMode", 2, "NoAltFireForDuke64")
		TNT1 A 0 A_JumpIfInventory("DukeStomp", 1, "Stomp")
		TNT1 A 0 A_JumpIfInventory("DBSHOT1",1,"AltFireB")
		TNT1 A 0 A_JumpIfInventory("DukePipeBombHold",1,"AltFireB")
		Goto Super::AltFire

	  AltFireB:
		TNT1 A 0 A_JumpIfInventory("DB1",1,"AltFireB1")
		TNT1 A 0 A_JumpIfInventory("DB2",1,"AltFireB2")
		TNT1 A 0 A_JumpIfInventory("DB3",1,"AltFireB3")
		TNT1 A 0 A_JumpIfInventory("DB4",1,"AltFireB4")
		TNT1 A 0 A_JumpIfInventory("DB5",1,"AltFireB5")
		TNT1 A 0 A_JumpIfInventory("DB6",1,"AltFireB6")
		TNT1 A 0 A_JumpIfInventory("DB7",1,"AltFireB7")
		TNT1 A 0 A_JumpIfInventory("DB8",1,"AltFireB8")
		TNT1 A 0 A_JumpIfInventory("DB9",1,"AltFireB9")
		TNT1 A 0 A_JumpIfInventory("DB10",1,"AltFireB10")
		TNT1 A 0 A_JumpIfInventory("DB11",1,"AltFireB11")
		TNT1 A 0 A_JumpIfInventory("DB12",1,"AltFireB12")
		TNT1 A 0 A_JumpIfInventory("DB13",1,"AltFireB13")
		TNT1 A 0 A_JumpIfInventory("DB14",1,"AltFireB14")
		TNT1 A 0 A_JumpIfInventory("DB15",1,"AltFireB15")
		TNT1 A 0 A_JumpIfInventory("DB16",1,"AltFireB16")
		TNT1 A 0 A_JumpIfInventory("DB17",1,"AltFireB17")
		TNT1 A 0 A_JumpIfInventory("DB18",1,"AltFireB18")
		TNT1 A 0 A_GiveInventory("DukeKicking",1)
		TNT1 A 0 ACS_NamedExecuteAlways("SamsaraClientDecorate",0,3)
		TNT1 A 0 A_GiveInventory("DB1",1)
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 5)
		DNBT C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT C 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB1")
		TNT1 A 0 A_TakeInventory("DB1",1)
		Goto Super::AltFireA2
		DNBT G 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT G 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB1")
		TNT1 A 0 A_TakeInventory("DB1",1)
		Goto Super::AltFireA2
	  AltFireB1:
		TNT1 A 0 A_TakeInventory("DB1",1)
		TNT1 A 0 A_GiveInventory("DB2",1)
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 5)
		DNBT C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT C 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB2")
		TNT1 A 0 A_TakeInventory("DB2",1)
		Goto Super::AltFireA3
		DNBT G 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT G 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB2")
		TNT1 A 0 A_TakeInventory("DB2",1)
		Goto Super::AltFireA3
	  AltFireB2:
		TNT1 A 0 A_TakeInventory("DB2",1)
		TNT1 A 0 A_GiveInventory("DB3",1)
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 5)
		DNBT C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT C 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB3")
		TNT1 A 0 A_TakeInventory("DB3",1)
		Goto Super::AltFireA4
		DNBT G 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT G 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB3")
		TNT1 A 0 A_TakeInventory("DB3",1)
		Goto Super::AltFireA4
	  AltFireB3:
		TNT1 A 0 A_TakeInventory("DB3",1)
		TNT1 A 0 A_GiveInventory("DB4",1)
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 5)
		DNBT C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT C 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB4")
		TNT1 A 0 A_TakeInventory("DB4",1)
		Goto Super::AltFireA5
		DNBT G 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT G 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB4")
		TNT1 A 0 A_TakeInventory("DB4",1)
		Goto Super::AltFireA5
	  AltFireB4:
		TNT1 A 0 A_TakeInventory("DB4",1)
		TNT1 A 0 A_GiveInventory("DB5",1)
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 5)
		DNBT C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT C 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB5")
		TNT1 A 0 A_TakeInventory("DB5",1)
		Goto Super::AltFireA6
		DNBT G 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT G 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB5")
		TNT1 A 0 A_TakeInventory("DB5",1)
		Goto Super::AltFireA6
	  AltFireB5:
		TNT1 A 0 A_TakeInventory("DB5",1)
		TNT1 A 0 A_GiveInventory("DB6",1)
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 5)
		DNBT C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT D 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB6")
		TNT1 A 0 A_TakeInventory("DB6",1)
		Goto Super::AltFireA7
		DNBT G 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT H 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB6")
		TNT1 A 0 A_TakeInventory("DB6",1)
		Goto Super::AltFireA7
	  AltFireB6:
		TNT1 A 0 A_TakeInventory("DB6",1)
		TNT1 A 0 A_GiveInventory("DB7",1)
		TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,2)
		TNT1 A 0 A_FireCustomMissile("DukeKickAttack",0,0)
		Goto AltFireB6End
		TNT1 A 0 A_FireCustomMissile("DukeKickAttackCoop",0,0)
		Goto AltFireB6End
	  AltFireB6End:
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 5)
		DNBT D 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT D 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB7")
		TNT1 A 0 A_TakeInventory("DB7",1)
		Goto Super::AltFireA8
		DNBT H 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT H 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB7")
		TNT1 A 0 A_TakeInventory("DB7",1)
		Goto Super::AltFireA8
	  AltFireB7:
		TNT1 A 0 A_TakeInventory("DB7",1)
		TNT1 A 0 A_GiveInventory("DB8",1)
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 5)
		DNBT D 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT D 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB8")
		TNT1 A 0 A_TakeInventory("DB8",1)
		Goto Super::AltFireA9
		DNBT H 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT H 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB8")
		TNT1 A 0 A_TakeInventory("DB8",1)
		Goto Super::AltFireA9
	  AltFireB8:
		TNT1 A 0 A_TakeInventory("DB8",1)
		TNT1 A 0 A_GiveInventory("DB9",1)
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 5)
		DNBT D 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT D 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB9")
		TNT1 A 0 A_TakeInventory("DB9",1)
		Goto Super::AltFireA10
		DNBT H 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT H 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB9")
		TNT1 A 0 A_TakeInventory("DB9",1)
		Goto Super::AltFireA10
	  AltFireB9:
		TNT1 A 0 A_TakeInventory("DB9",1)
		TNT1 A 0 A_GiveInventory("DB10",1)
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 5)
		DNBT D 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT D 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB10")
		TNT1 A 0 A_TakeInventory("DB10",1)
		Goto Super::AltFireA11
		DNBT H 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT H 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB10")
		TNT1 A 0 A_TakeInventory("DB10",1)
		Goto Super::AltFireA11
	  AltFireB10:
		TNT1 A 0 A_TakeInventory("DB10",1)
		TNT1 A 0 A_GiveInventory("DB11",1)
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 5)
		DNBT D 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT D 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB11")
		TNT1 A 0 A_TakeInventory("DB11",1)
		Goto Super::AltFireA12
		DNBT H 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT H 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB11")
		TNT1 A 0 A_TakeInventory("DB11",1)
		Goto Super::AltFireA12
	  AltFireB11:
		TNT1 A 0 A_TakeInventory("DB11",1)
		TNT1 A 0 A_GiveInventory("DB12",1)
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 5)
		DNBT D 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT D 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB12")
		TNT1 A 0 A_TakeInventory("DB12",1)
		Goto Super::AltFireA13
		DNBT H 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT H 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB12")
		TNT1 A 0 A_TakeInventory("DB12",1)
		Goto Super::AltFireA13
	  AltFireB12:
		TNT1 A 0 A_TakeInventory("DB12",1)
		TNT1 A 0 A_GiveInventory("DB13",1)
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 5)
		DNBT D 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT D 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB13")
		TNT1 A 0 A_TakeInventory("DB13",1)
		Goto Super::AltFireA14
		DNBT H 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT H 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB13")
		TNT1 A 0 A_TakeInventory("DB13",1)
		Goto Super::AltFireA14
	  AltFireB13:
		TNT1 A 0 A_TakeInventory("DB13",1)
		TNT1 A 0 A_GiveInventory("DB14",1)
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 5)
		DNBT D 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT D 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB14")
		TNT1 A 0 A_TakeInventory("DB14",1)
		Goto Super::AltFireA15
		DNBT H 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT H 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB14")
		TNT1 A 0 A_TakeInventory("DB14",1)
		Goto Super::AltFireA15
	  AltFireB14:
		TNT1 A 0 A_TakeInventory("DB14",1)
		TNT1 A 0 A_GiveInventory("DB15",1)
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 5)
		DNBT D 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT C 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB15")
		TNT1 A 0 A_TakeInventory("DB15",1)
		Goto Super::AltFireA16
		DNBT H 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT G 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB15")
		TNT1 A 0 A_TakeInventory("DB15",1)
		Goto Super::AltFireA16
	  AltFireB15:
		TNT1 A 0 A_TakeInventory("DB15",1)
		TNT1 A 0 A_GiveInventory("DB16",1)
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 5)
		DNBT C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT C 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB16")
		TNT1 A 0 A_TakeInventory("DB16",1)
		Goto Super::AltFireA17
		DNBT G 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT G 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB16")
		TNT1 A 0 A_TakeInventory("DB16",1)
		Goto Super::AltFireA17
	  AltFireB16:
		TNT1 A 0 A_TakeInventory("DB16",1)
		TNT1 A 0 A_GiveInventory("DB17",1)
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 5)
		DNBT C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT C 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB17")
		TNT1 A 0 A_TakeInventory("DB17",1)
		Goto Super::AltFireA18
		DNBT G 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT G 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB17")
		TNT1 A 0 A_TakeInventory("DB17",1)
		Goto Super::AltFireA18
	  AltFireB17:
		TNT1 A 0 A_TakeInventory("DB17",1)
		TNT1 A 0 A_GiveInventory("DB18",1)
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 5)
		DNBT C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT C 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB18")
		TNT1 A 0 A_TakeInventory("DB18",1)
		Goto ReadyA
		DNBT G 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT G 1 A_WeaponReady(WRF_NOSECONDARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"AltFireB18")
		TNT1 A 0 A_TakeInventory("DB18",1)
		Goto ReadyA
	  AltFireB18:
		TNT1 A 0 A_TakeInventory("DB18",1)
		TNT1 A 0 A_TakeInventory("DukeKicking",9)
		TNT1 A 0 A_JumpIfInventory("DukeLABToken", 1, 4)
		DNBT C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT C 1 A_WeaponReady(WRF_NOPRIMARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"ReadyB")
		Goto ReadyA
		DNBT G 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		DNBT G 1 A_WeaponReady(WRF_NOPRIMARY|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("DukePipebombHold",1,"ReadyB")
		Goto ReadyA

	  AltFlash:
		TNT1 A 0 A_JumpIfInventory("DukeThrownPipebomb",1,"AltFlash2")
		TNT1 A 0 A_JumpIfInventory("RocketAmmo",1,1)
		goto AltFlash3
		DKPB A 2 A_JumpIfInventory("DukeLABToken", 1, 1)
		stop
		DKPA A 2
		stop

	  AltFlash2:
		DKPB O 2
		stop
	
	  AltFlash3:
		TNT1 A 2
		stop
		
	  NoAltFireForDuke64:
		TNT1 A 0
		goto Ready

	  TauntWeaponSound:
		TNT1 A 0
		Goto Select

	  IntroTaunt:
		DKPB A 0 A_JumpIfInventory("DukeLABToken", 1, "IntroTauntLAB")
		Goto Super::IntroTaunt
	  IntroTauntLAB:
		DKPA A 0
		Goto Super::IntroTaunt

	  WaitingTaunt:
		TNT1 A 0 A_JumpIfInventory("DukeThrownPipebomb",1,"WaitingTauntDetonator")
		DKPB A 0 A_JumpIfInventory("DukeLABToken", 1, "WaitingTauntLAB")
		Goto Super::WaitingTaunt
	  WaitingTauntLAB:
		DKPA A 0
		Goto Super::WaitingTaunt
	  WaitingTauntDetonator:
		DKPB O 0
		Goto Super::WaitingTaunt

	  GiveMoney:
		TNT1 A 0 A_JumpIfInventory("DukeThrownPipebomb",1,"GiveMoneyDetonator")
		DKPB A 0 A_JumpIfInventory("DukeLABToken", 1, "GiveMoneyLAB")
		Goto Super::GiveMoney
	  GiveMoneyLAB:
		DKPA J 0
		Goto Super::GiveMoney
	  GiveMoneyDetonator:
		DKPB O 0
		Goto Super::WaitingTaunt

	  Nothing:
		TNT1 A 0 A_SelectWeapon("Mighty Boot")
		goto Deselect
	}
}

actor DukePipebombAmmo : RocketAmmo { +IGNORESKILL }
actor DukeKaboom : Inventory { -INVBAR +INVENTORY.UNDROPPABLE Inventory.MaxAmount 1 }

actor DukePipebomb
{
	SeeSound "duke/pipebomb"
	DamageType "DukeExplosive"
	Speed 16
	Radius 10
	Height 8
	Health 5
	Species "Player"
	Obituary "$SAMSARA_DUKE_OB_SLOT1"
	Gravity 0.8
	DamageFactor "MightyBoot", 0.0
	BounceFactor 0.7
	BounceCount 3
	Scale 0.2
	PROJECTILE
	+NOBLOOD
	+SHOOTABLE
	-NOBLOCKMAP
	-NOLIFTDROP
	-NOGRAVITY
	+NOTELEPORT
	-TELESTOMP
	+MOVEWITHSECTOR
	+BOUNCEONACTORS
	+DOOMBOUNCE
	-EXPLODEONWATER
	+CANBOUNCEWATER
	+FORCERADIUSDMG
	+THRUGHOST
	+THRUSPECIES
	States
	{
	  Spawn:
		TNT1 A 0
		TNT1 A 0 A_PlaySoundEx("silence","voice",0,0)
		TNT1 A 0 A_JumpIfInTargetInventory ("CoopModeOn",1,"Spawn2")
		TNT1 A 0 A_ChangeFlag ("THRUSPECIES",0)
		Goto Spawn2

	  Spawn2:
		PBOM AABB 1 A_JumpIfInTargetInventory ("DukeKaboom",1,"Death")
		Loop

	  Death:
		TNT1 A 0 A_ChangeFlag("SHOOTABLE",1) //for r3827 compatibility
		TNT1 A 0 A_PlaySound("duke/pipebomb")
		TNT1 A 0 A_Jump(256,"Death1","Death2")

	  Death1:
		TNT1 A 0 A_ChangeFlag("SHOOTABLE",1)
		TNT1 A 0 A_Gravity
		TNT1 A 0 A_JumpIfHealthLower(0,"Explode")
		PBOM A 1 A_JumpIfInTargetInventory ("DukeKaboom",1,"Explode")
		TNT1 A 0 A_JumpIfCloser(20,"Remove1")
		Loop

	  Death2:
		TNT1 A 0 A_ChangeFlag("SHOOTABLE",1)
		TNT1 A 0 A_Gravity
		TNT1 A 0 A_JumpIfHealthLower(0,"Explode")
		PBOM B 1 A_JumpIfInTargetInventory ("DukeKaboom",1,"Explode")
		TNT1 A 0 A_JumpIfCloser(20,"Remove2")
		Loop

	  Explode:
		TNT1 A 0 A_ChangeFlag("SHOOTABLE",0) //This must be cleared when we get here so double explosions don't happen!
		TNT1 A 0 A_NoBlocking
		TNT1 A 0 A_AlertMonsters
		TNT1 A 0 A_PlaySound("duke/explosion", CHAN_WEAPON, 1.0, 0, ATTN_NORM)
		TNT1 A 0 A_PlaySound("duke/pipeexplosion", 5, 0.5, 0, ATTN_NORM)
		TNT1 AAAAAAA 0 A_SpawnItemEx("PipebombFrag",random(-1,1),random(-1,1),random(26,56),random(-2,2),random(-2,2),random(5,15),random(-180,180),160)//A_SpawnDebris("PipebombFrag")
		TNT1 A 1 A_SpawnItemEx("RPGExplosion",0,0,3,0,0,0,0,32)//A_SpawnItem("RPGExplosion")
		TNT1 A 0 A_CheckFloor(2)
		TNT1 A 1 A_Explode(280,250) // Pipebombs have 1.5 the radius of the rockets.
		Stop
		TNT1 A 1 A_Explode(140,250) 
		Stop		

	  Remove1:
		PBOM A 1 A_JumpIfInTargetInventory("RocketAmmo",0,"Death1")
		Goto RemoveEnd

	  Remove2:
		PBOM B 1 A_JumpIfInTargetInventory("RocketAmmo",0,"Death2")
		Goto RemoveEnd

	  RemoveEnd:
		TNT1 A 0 A_GiveToTarget("DukeAmmoIndicator",1)
		TNT1 A 0 A_GiveToTarget("DukePipebombAmmo",1)
		TNT1 A 0 Thing_Remove(0)
		Stop
	}
}

actor DukePipebomb2 : DukePipebomb { Speed 17 }
actor DukePipebomb3 : DukePipebomb { Speed 18 }
actor DukePipebomb4 : DukePipebomb { Speed 19 }
actor DukePipebomb5 : DukePipebomb { Speed 20 }
actor DukePipebomb6 : DukePipebomb { Speed 21 }
actor DukePipebomb7 : DukePipebomb { Speed 22 }
actor DukePipebomb8 : DukePipebomb { Speed 23 }
actor DukePipebomb9 : DukePipebomb { Speed 24 }
actor DukePipebomb10 : DukePipebomb { Speed 25 }
actor DukePipebomb11 : DukePipebomb { Speed 26 }

actor DukePipebombBeach : DukePipebomb
{
	SeeSound "duke/pipebomb2"
	States
	{
	  Spawn:
		TNT1 A 0
		TNT1 A 0 A_PlaySoundEx("silence","voice",0,0)
		TNT1 A 0 A_JumpIfInTargetInventory ("CoopModeOn",1,"Spawn2")
		TNT1 A 0 A_ChangeFlag ("THRUSPECIES",0)
		Goto Spawn2

	  Spawn2:
		PBOM CCDD 1 A_JumpIfInTargetInventory ("DukeKaboom",1,"Death")
		Loop

	  Death:
		TNT1 A 0 A_ChangeFlag("SHOOTABLE",1) //for r3827 compatibility
		TNT1 A 0 A_PlaySound("duke/pipebomb2")
		TNT1 A 0 A_Jump(256,"Death1","Death2")

	  Death1:
		TNT1 A 0 A_ChangeFlag("SHOOTABLE",1)
		TNT1 A 0 A_Gravity
		TNT1 A 0 A_JumpIfHealthLower(0,"Explode")
		PBOM C 1 A_JumpIfInTargetInventory ("DukeKaboom",1,"Explode")
		TNT1 A 0 A_JumpIfCloser(20,"Remove1")
		Loop

	  Death2:
		TNT1 A 0 A_ChangeFlag("SHOOTABLE",1)
		TNT1 A 0 A_Gravity
		TNT1 A 0 A_JumpIfHealthLower(0,"Explode")
		PBOM D 1 A_JumpIfInTargetInventory ("DukeKaboom",1,"Explode")
		TNT1 A 0 A_JumpIfCloser(20,"Remove2")
		Loop

	  Explode:
		TNT1 A 0 A_ChangeFlag("SHOOTABLE",0) //This must be cleared when we get here so double explosions don't happen!
		TNT1 A 0 A_NoBlocking
		TNT1 A 0 A_AlertMonsters
		TNT1 A 0 A_PlaySound("duke/explosion", CHAN_WEAPON, 1.0, 0, ATTN_NORM)
		TNT1 A 0 A_PlaySound("duke/pipeexplosion", 5, 0.5, 0, ATTN_NORM)
		TNT1 AAAAAAA 0 A_SpawnItemEx("PipebombFrag",random(-1,1),random(-1,1),random(26,56),random(-2,2),random(-2,2),random(5,15),random(-180,180),160)//A_SpawnDebris("PipebombFrag")
		TNT1 A 1 A_SpawnItemEx("RPGExplosion",0,0,3,0,0,0,0,32)//A_SpawnItem("RPGExplosion")
		TNT1 A 0 A_CheckFloor(2)
		TNT1 A 1 A_Explode(280,250) // Pipebombs have 1.5 the radius of the rockets.
		Stop
		TNT1 A 1 A_Explode(140,250) 
		Stop	

	  Remove1:
		PBOM C 1 A_JumpIfInTargetInventory("RocketAmmo",0,"Death1")
		Goto Super::RemoveEnd

	  Remove2:
		PBOM D 1 A_JumpIfInTargetInventory("RocketAmmo",0,"Death2")
		Goto Super::RemoveEnd
	}
}

actor DukePipebombBeach2 : DukePipebombBeach { Speed 17 }
actor DukePipebombBeach3 : DukePipebombBeach { Speed 18 }
actor DukePipebombBeach4 : DukePipebombBeach { Speed 19 }
actor DukePipebombBeach5 : DukePipebombBeach { Speed 20 }
actor DukePipebombBeach6 : DukePipebombBeach { Speed 21 }
actor DukePipebombBeach7 : DukePipebombBeach { Speed 22 }
actor DukePipebombBeach8 : DukePipebombBeach { Speed 23 }
actor DukePipebombBeach9 : DukePipebombBeach { Speed 24 }
actor DukePipebombBeach10 : DukePipebombBeach { Speed 25 }
actor DukePipebombBeach11 : DukePipebombBeach { Speed 26 }

actor PipebombFrag
{   
	Health 4
	Speed 2
	Mass 0
	BounceFactor 0.45
	BounceCount 4
	+MISSILE
	+DOOMBOUNCE
	+FLOORCLIP
	+DONTSPLASH
	+CLIENTSIDEONLY
	+MOVEWITHSECTOR
	+BOUNCEONACTORS
	+NOTELEPORT
	+NOTARGET
	//Scale 0.75
	States
	{
	  Spawn:
		PBMF ABCD 3
		Loop

	  Death:
		TNT1 A 0 A_Jump(255, "Death1","Death2","Death3","Death4")

	  Death1:
		PBMF A 1050
		Stop

	  Death2:
		PBMF B 1050
		Stop

	  Death3:
		PBMF C 1050
		Stop

	  Death4:
		PBMF D 1050
		Stop
	}
}

actor DukeAmmoIndicator: CustomInventory
{
	Inventory.MaxAmount 0
	+AUTOACTIVATE
	
	States
	{
	   Spawn:
		 TNT1 A 0
		 stop
		 
	   Pickup:
		 TNT1 A 0
		 TNT1 A 0 A_PlaySoundEx("duke/itemget", 6)
		 TNT1 A 0 A_GiveInventory("DukeTauntCooldown", 5)
		 TNT1 A 0 A_SetBlend("FFFF00",0.1,5)
		 stop
	}
}