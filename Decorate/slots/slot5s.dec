actor GrenadeLauncher : RocketLauncher 5011
{
    Weapon.SlotNumber 8
    Game Doom
    SpawnID 163
}

actor SamsaraSlotFiveSkulltagPickup : SamsaraSlotFivePickup replaces GrenadeLauncher
{
	States
	{
      Spawn:
        TNT1 A 0
		TNT1 A 0 A_JumpIf((ACS_NamedExecuteWithResult("SamsaraDecorate", 29) == 1), "InstagibNope") // Prevents weapons from spawning in Instagib
        TNT1 A 1 A_JumpIf(ACS_NamedExecuteWithResult("SamsaraDecorate", 1) == 1, "IWasDropped")
        TNT1 A 35 A_JumpIf(1==1, "SpawnLoop")
        wait
	  
	  IWasDropped:
        TNT1 A 0 A_SpawnItemEx("SamsaraSlotFiveSkulltagDrop", 0,0,0, momx,momy,momz, 0, SXF_ABSOLUTEMOMENTUM)
        stop
		
	  SpawnLoop:      
        "----" A 35 bright ACS_NamedExecuteAlways("SamsaraClientClass", 0, 9)
        loop

		Doomguy:  WDGL A 35 A_ChangeFlag("FLOATBOB", 0)   goto SpawnLoop
		Doom64:   64GL Z 35 A_ChangeFlag("FLOATBOB", 0)   goto SpawnLoop
		DoomguyStr:  WDGL B 35 A_ChangeFlag("FLOATBOB", 0)   goto SpawnLoop
		Chexguy:  LAUC B 35 A_ChangeFlag("FLOATBOB", 0)   goto SpawnLoop
		Rott:     		PDSK A 35 A_ChangeFlag("FLOATBOB", 0)   goto SpawnLoop
		Katarn:    IMIN A 35 A_ChangeFlag("FLOATBOB", 0)   goto SpawnLoop
		Witchaven:  PWHJ ABCD 5 A_ChangeFlag("FLOATBOB", 0)   goto SpawnLoop
		Bitterman:      Q2WP A 35 A_ChangeFlag("FLOATBOB", 0) 	goto SpawnLoop
		RTCW: 	  RW98 A 35 A_ChangeFlag("FLOATBOB", 0)   goto SpawnLoop
		
		DoomStrFull:   WDGL D 35 Bright A_ChangeFlag("FLOATBOB", 0)   goto SpawnLoop
		RoTTFull: 	   PWE9 B 35 Bright A_ChangeFlag("FLOATBOB", 0)   goto SpawnLoop
		BittermanFull: Q2WP C 35 Bright A_ChangeFlag("FLOATBOB", 0)   goto SpawnLoop
		RTCWFull:  		RW98 C 35 bright A_ChangeFlag("FLOATBOB", 0)   goto SpawnLoop
		
		DoomStrEmpty:   WDGL C 35 Bright A_ChangeFlag("FLOATBOB", 0)   goto SpawnLoop
		RoTTEmpty: 		PWE9 A 35 Bright A_ChangeFlag("FLOATBOB", 0)   goto SpawnLoop
		BittermanEmpty: Q2WP B 35 Bright A_ChangeFlag("FLOATBOB", 0)   goto SpawnLoop
		RTCWEmpty:  	RW98 B 35 bright A_ChangeFlag("FLOATBOB", 0)   goto SpawnLoop
		
		Pickup:
			TNT1 A 0 A_JumpIfInventory("DoomGuyClass", 1, "PickupSkulltag")
			TNT1 A 0 A_JumpIfInventory("ChexClass", 1, "PickupSkulltag")
			TNT1 A 0 A_JumpIfInventory("RottClass", 1, "PickupSkulltag")
			TNT1 A 0 A_JumpIfInventory("StrifeClass", 1, "CheckStrife")
			TNT1 A 0 A_JumpIfInventory("KatarnClass", 1, "PickupSkulltag")
			TNT1 A 0 A_JumpIfInventory("WitchavenClass", 1, "PickupSkulltag")
			TNT1 A 0 A_JumpIfInventory("BittermanClass", 1, "PickupSkulltag")
			TNT1 A 0 A_JumpIfInventory("RTCWClass", 1, "PickupSkulltag")
			TNT1 A 0 A_JumpIf((ACS_NamedExecuteWithResult("SamsaraGiveWeapon", 5) & 3) == 1, "PickupSuccess")
			Goto PickupFailure
        PickupSkulltag:
			TNT1 A 0 A_JumpIf((ACS_NamedExecuteWithResult("SamsaraGiveWeapon", 9) & 3) == 1, "PickupSuccess")
			Goto PickupFailure
	}
}

actor SamsaraSlotFiveSkulltagDrop: SamsaraSlotFiveSkulltagPickup
{
  States
  {
    Spawn:
      TNT1 A 0
      goto SpawnLoop
    Pickup:
	  TNT1 A 0 A_JumpIfInventory("DoomGuyClass", 1, "PickupSkulltag")
	  TNT1 A 0 A_JumpIfInventory("ChexClass", 1, "PickupSkulltag")
	  TNT1 A 0 A_JumpIfInventory("RottClass", 1, "PickupSkulltag")
	  TNT1 A 0 A_JumpIfInventory("StrifeClass", 1, "CheckStrife")
	  TNT1 A 0 A_JumpIfInventory("KatarnClass", 1, "PickupSkulltag")
	  TNT1 A 0 A_JumpIfInventory("BittermanClass", 1, "PickupSkulltag")
	  TNT1 A 0 A_JumpIfInventory("WitchavenClass", 1, "PickupSkulltag")
	  TNT1 A 0 A_JumpIfInventory("RTCWClass", 1, "PickupSkulltag")
      TNT1 A 0 A_JumpIf((ACS_NamedExecuteWithResult("SamsaraGiveWeapon", 5, 1) & 1) == 1, "PickupSuccess")
      Goto PickupFailure
    PickupSkulltag:
	  TNT1 A 0 A_JumpIf((ACS_NamedExecuteWithResult("SamsaraGiveWeapon", 9, 1) & 1) == 1, "PickupSuccess")
      goto PickupFailure
	CheckStrife:
	  TNT1 A 0 A_JumpIfInventory("StrifeGuyInStrife", 1, "StrifeCheck")
	  TNT1 A 0 A_JumpIfInventory("GotWeapon5", 1, "StrifeCheck")
	  TNT1 A 0 A_GiveInventory("StrifeSigilPiece",1)
	  TNT1 A 0 A_GiveInventory(" Sigil ", 1)
	  TNT1 A 0 A_TakeInventory("StrifeSigilPiecePreferred",5)
	  TNT1 A 0 A_GiveInventory("StrifeSigilPiecePreferred", CallACS("StrifeSigilPreferred"))
	StrifeCheck:	
      TNT1 A 0 A_JumpIf((ACS_NamedExecuteWithResult("SamsaraGiveWeapon", 5, 1) & 1) == 1, "PickupSuccess")
      goto PickupFailure
  }
}
