actor WolfenClassMode : Counter { Inventory.MaxAmount 2 }
actor Wolfen_IHaveExtraLife : Counter { Inventory.MaxAmount 9 Inventory.InterHubAmount 9 }
actor Wolfen_IHaveSlot2 : Boolean {}
actor Totenkopf_IHaveDualPistols : Boolean {}
actor Totenkopf_IHaveDualMP40s : Boolean {}
actor Totenkopf_IHaveMauser : Boolean {}
actor Totenkopf_IHaveDualMausers : Boolean {}
actor Totenkopf_IHaveSTG44 : Boolean {}
actor Totenkopf_IHaveFlamethrower : Boolean {}
actor Totenkopf_IHaveMG42 : Boolean {}
actor Totenkopf_IHaveScope : Boolean {}
actor Totenkopf_IHavePowerArmor : Boolean {}
actor Totenkopf_IAmWolverine : Boolean {}
actor Totenkopf_GimmeDat : Boolean {}
actor WolfenPlayer : SamsaraPlayerPawnNormalRedBlood
{
    Player.DisplayName "Wolfenstein 3D"
    Player.StartItem "Luger", 1
    Player.StartItem "Knife", 1
    Player.StartItem "WolfenClass", 1
    Player.StartItem "CanWolfMovement", 1
    Player.StartItem "IsSamsaraClass", 1
	Player.StartItem "TauntButton", 1
    Player.StartItem "Clip", 50
    Player.Face "BJF"
    Player.JumpZ 9//Default is 8
    Player.Soundclass "WolfenPlayer"
	DamageFactor "RebelMissile", 0
    DamageFactor "PoisonCloud", 1.75
    //DamageFactor "Wraithverge", 0.75
	DamageFactor "DynamiteCoop", 0.0	
    DamageFactor "CorvusCrossbow", 1.1
    DamageFactor "MightyBoot", 1.5
    DamageFactor "DragonClaw", 1.1
    DamageFactor "WMCBeam", 0.75
    DamageFactor "WMCNade", 0.75
	DamageFactor "EnemyInfightDamage", 0.0
	DamageFactor "ElectricBolt", 1.0
	DamageFactor "PhosFireCoop", 0.0
	DamageFactor "EradCoopExplosive2", 0.0
    DamageFactor "C7MineBoom", 0.0	
    DamageFactor "EradCoopGreenFire", 0.0	
	DamageFactor "BCannonProj", 0.75	
	BloodType "SamsaraBloodyHellBlood"
    DamageFactor "RMR-BigPlasma", 0.85		
	DamageFactor "SWNukeCoop", 0.0		
	DamageFactor "SWRailgunCoop", 0.0
	DamageFactor "SWFlameCoop", 0.0
	DamageFactor "SWFlame2Coop", 0.0
	DamageFactor "SWStickyCoop", 0.0	
	DamageFactor "CMDMGSHIT", 0.0	
    Player.ColorRange 112, 127
	var int user_scalex;
	var int user_scaley;
    States
    {
		Spawn:
			BJBL A 0 NoDelay ACS_NamedExecuteWithResult("DisableVoodooDoll")
			BJBL A 0 A_JumpIfInventory("WolfenClassMode",2,4)
			BJBL A 0 A_TakeInventory("WolfCheckMoving")
			BJBL A 1 A_JumpIfInventory("WolfMoving", 1, "See")
			BJBL A -1 A_Jump(256,"Spawn")
			TK61 A 0 A_TakeInventory("WolfCheckMoving")
			TK61 A 1 A_JumpIfInventory("WolfMoving", 1, "See")
			TK61 A -1 A_Jump(256,"Spawn")
			Loop
		See:
			BJBL A 0 A_JumpIfInventory("WolfenClassMode",2,18)
			BJBL AAAABBBBCCCCDDDD 1 A_GiveInventory("WolfCheckMoving")
			BJBL A -1 A_Jump(256,"See")
			TK61 BBBBCCCCDDDDEEEE 1 A_GiveInventory("WolfCheckMoving")
			TK61 B -1 A_Jump(256,"See")
			Loop
		Missile:
			TNT1 A 0 A_JumpIfInventory("WolfenClassMode",2,"MissileTotenkopf")
			BJBL E 6
			Goto Spawn
		MissileTotenkopf:
			TK61 F 6
			TK61 G 6 Bright	  
			Goto Spawn
		Melee:
			TNT1 A 0 A_JumpIfInventory("WolfenClassMode",2,"MeleeTotenkopf")
			BJBL E 6
			BJBL F 6 Bright	 
			Goto Spawn
		MeleeTotenkopf:
			TK61 H 3 BRIGHT		
			Goto Spawn
		Pain:
			TNT1 A 0 A_JumpIfInventory("WolfenClassMode",2,"PainTotenkopf")
			TNT1 A 0 A_JumpIfInventory("AlreadyDiedOnceBJ",1,"ChanceToFail")
			TNT1 A 0 A_JumpIfInventory("WolfExtraLife",1,"GoingToSalvate")
			BJBL G 4 
			BJBL G 4 A_Pain
			Goto Spawn
		PainTotenkopf:
			TNT1 A 0 A_Jump(128,2)
			TK61 I 4 A_Pain
			Goto Spawn
			TK61 J 4 A_Pain
			Goto Spawn
		ChanceToFail:
			TNT1 A 0 A_Jump(128,"SalvationFail")
			BJBL G 4 A_JumpIfHealthLower(2, "GoingTo")
			BJBL G 4 A_Pain
			Goto Spawn
		SalvationFail:
			BJBL G 4 
			BJBL G 4 A_Pain
			Goto Spawn
		GoingToSalvate:
			BJBL G 4 A_JumpIfHealthLower(2, "GoingTo")
			BJBL G 4 A_Pain
			Goto Spawn
		GoingTo: // Deathmatch Version (also affects some Totenkopf stuff as per equipment clearing)
			TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"GoingToUnNerfed")
			TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"GoingToUnNerfedCoop")
			TNT1 A 0 A_GiveInventory("Medikit")
			TNT1 A 0 A_GiveInventory("Medikit")
			TNT1 A 0 A_GiveInventory("Medikit")
			TNT1 A 0 A_GiveInventory("Medikit")
			TNT1 A 0 A_TakeInventory("BasicArmor")
			TNT1 A 0 A_TakeInventory("Clip")
			TNT1 A 0 A_TakeInventory("Shell")
			TNT1 A 0 A_TakeInventory("RocketAmmo")
			TNT1 A 0 A_TakeInventory("Cell")
			TNT1 A 0 A_TakeInventory("Totenkopf_FlameThrowerFuel")
			TNT1 A 0 A_TakeInventory("Backpack")
			TNT1 A 0 A_TakeInventory("Totenkopf_IHaveDualPistols")
			TNT1 A 0 A_TakeInventory("Totenkopf_PistolDual")
			TNT1 A 0 A_TakeInventory("GotWeapon0")
			TNT1 A 0 A_TakeInventory("BJSuperKnife")
			//TNT1 A 0 A_TakeInventory("BJUberKnife")
			TNT1 A 0 A_TakeInventory("Totenkopf_IHaveMauser")
			TNT1 A 0 A_TakeInventory("Totenkopf_Mauser")
			TNT1 A 0 A_TakeInventory("Totenkopf_IHaveDualMausers")
			TNT1 A 0 A_TakeInventory("Totenkopf_MauserDual")
			TNT1 A 0 A_TakeInventory("GotWeapon2")
			TNT1 A 0 A_TakeInventory("Wolfen_IHaveSlot2")
			TNT1 A 0 A_TakeInventory("Machine Gun")
			TNT1 A 0 A_TakeInventory("GotWeapon3")
			TNT1 A 0 A_TakeInventory("Totenkopf_IHaveSTG44")
			TNT1 A 0 A_TakeInventory("Totenkopf_STG44")
			TNT1 A 0 A_TakeInventory("GotWeapon4")
			TNT1 A 0 A_TakeInventory("  Chaingun  ")
			TNT1 A 0 A_TakeInventory("Totenkopf_IHaveDualMP40s")
			TNT1 A 0 A_TakeInventory("Totenkopf_MP40Dual")
			TNT1 A 0 A_TakeInventory("GotWeapon5")
			TNT1 A 0 A_TakeInventory(" Rocket Launcher ")
			TNT1 A 0 A_TakeInventory("GotWeapon6")
			TNT1 A 0 A_TakeInventory(" Flamethrower ")
			TNT1 A 0 A_TakeInventory("GotWeapon7")
			TNT1 A 0 A_TakeInventory("Spear of Destiny")
			TNT1 A 0 A_GiveInventory("Clip",50)
			TNT1 A 0 A_GiveInventory("Salvate")
			TNT1 A 0 A_TakeInventory("Wolfen_IHaveExtraLife",1)
			//TNT1 A 0 A_GiveInventory("WolfLifeProtection")
			TNT1 A 0 A_PlayerScream
			BJBL G 0 A_TakeInventory("WolfExtraLife",1)
			BJBL G 8
			Goto Spawn
		GoingToUnNerfed: // SP Version
			TNT1 A 0 A_GiveInventory("Medikit")
			TNT1 A 0 A_GiveInventory("Medikit")
			TNT1 A 0 A_GiveInventory("Medikit")
			TNT1 A 0 A_GiveInventory("Medikit")
			TNT1 A 0 A_GiveInventory("Clip",50)
			TNT1 A 0 A_GiveInventory("BlueArmor")
			TNT1 A 0 A_GiveInventory("Salvate")
			TNT1 A 0 A_GiveInventory("WolfLifeProtection")
			TNT1 A 0 A_TakeInventory("Wolfen_IHaveExtraLife",1)
			TNT1 A 0 A_PlayerScream
			BJBL G 0 A_TakeInventory("WolfExtraLife",1)
			BJBL G 8
			Goto Spawn
		GoingToUnNerfedCoop: // CO-OP Version
			TNT1 A 0 A_GiveInventory("AlreadyDiedOnceBJ",1) //Prevents BJ beign immortal on survival
			TNT1 A 0 A_GiveInventory("Medikit")
			TNT1 A 0 A_GiveInventory("Medikit")
			TNT1 A 0 A_GiveInventory("Medikit")
			TNT1 A 0 A_GiveInventory("Medikit")
			TNT1 A 0 A_GiveInventory("Clip",50)
			TNT1 A 0 A_GiveInventory("BlueArmor")
			TNT1 A 0 A_GiveInventory("Salvate")
			TNT1 A 0 A_GiveInventory("WolfLifeProtection")	
			TNT1 A 0 A_TakeInventory("Wolfen_IHaveExtraLife",1)
			TNT1 A 0 A_PlayerScream
			BJBL G 0 A_TakeInventory("WolfExtraLife",1)
			BJBL G 8
			Goto Spawn
		Death:
			BJBL G 0 A_JumpIfInventory("WolfenClassMode",2,"DeathTotenkopf")
			BJBL G 0 A_SpawnItem("UniversalBloodyHellGoreDeathEffect")
			BJBL G 8 A_PlayerScream
			BJBL H 8 A_NoBlocking
			BJBL I 8
			BJBL JKL 8
			BJBL M -1
			Stop
		DeathTotenkopf:
			TNT1 A 0 A_SpawnItem("UniversalBloodyHellGoreDeathEffect")
			TK61 K 8 A_Playsound("Totenkopf/Death",CHAN_VOICE)
			TK61 L 8 A_NoBlocking
			TK61 M 8
			TK61 N 8
			TK61 O -1
			Stop
		XDeath:	
			TNT1 A 0 A_SpawnItem("UniversalBloodyHellGoreXDeathEffect")
			BJGB A 5 A_PlayerScream
			BJGB B 5 A_NoBlocking
			BJGB C 5
			BJGB DEFGHI 4
			BJGB J -1
			Stop
		XDeathTotenkopf:	
			TNT1 A 0 A_SpawnItem("UniversalBloodyHellGoreXDeathEffect")
			TK61 P 5 A_Playsound("Totenkopf/Death",CHAN_VOICE)
			TK61 Q 5 A_NoBlocking
			TK61 R 5
			TK61 STUVWX 4
			TK61 Y -1
			Stop
		CoopModeOn:
			TNT1 A 0
			TNT1 A 0 A_ChangeFlag("THRUSPECIES",1)
			TNT1 A 0 A_ChangeFlag("DONTBLAST",1)
			BJBL A 1
			goto Spawn
		Burn:
			Goto Death	// At some point, we need to make burn sprites for B.J like in previous versions of Samsara
		Death.ExpanderDMG:
		XDeath.ExpanderDMG:
			"####" "#" 0 A_SetUserVar("user_scalex", scalex*65536.0)
			"####" "#" 0 A_SetUserVar("user_scaley", scaley*65536.0)
			"####" "#" 0 A_PlaySound("duke/expand")
			Goto ExpanderLoop
		ExpanderLoop:
			"####" "#" 1 A_SetScale(1.1*(user_scalex/65536.0)+((0.01*(user_scalex/65536.0))*CallACS("Samsara_Expander",1))+((0.01*(user_scalex/65536.0))*(CallACS("Samsara_Expander",1)-CallACS("Samsara_Expander",2)))*(CallACS("Samsara_Expander",3)*2),1.1*(user_scaley/65536.0)+((0.01*(user_scaley/65536.0))*CallACS("Samsara_Expander",2)))
			"####" "#" 0 A_GiveInventory("ExpanderGrowthX", 1)
			"####" "#" 0 A_JumpIf(ceilingz - (z + height + CallACS("Samsara_Expander",1) + 32) <= 0, 2)
			"####" "#" 0 A_GiveInventory("ExpanderGrowthY", 1)
			"####" "#" 0 A_GiveInventory("ExpanderDoubleX", 1)
			"####" "#" 0 A_JumpIfInventory("ExpanderGrowthX", 40, "ExpanderPop")
			loop
		ExpanderPop:	
			"####" "#" 10
			"####" A 0 A_SpawnItemEx("ExpanderExplosion_Basic",0,0,height*2,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
			"####" A 0 A_PlaySound("duke/explosion", 6, 1.0)
			"####" A 1 ACS_NamedExecuteWithResult("SamsaraDecorate",36,2)
			"####" A 0 A_Jump(96,2)
			"####" A 0 A_GiveToTarget("DukeDMTaunt1", 1)
			"####" A 0 A_SetScale (1.0, 1.0)
			"####" A 0 A_UnsetSolid
			"####" A 0 A_SpawnItemEx("UniversalBloodyHellGoreXDeathEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_USEBLOODCOLOR)
			"####" A 0 A_SpawnItemEx("DukeGibPopSpawner", 0, 0, height*2, 0, 0, 0, 0, SXF_NOCHECKPOSITION|SXF_USEBLOODCOLOR)
			"####" A 0 A_GiveToTarget("DukeDMTaunt1",1)
			TNT1 A -1 A_UnsetSolid
			Stop
		Death.ExpanderDMGCoop:
		XDeath.ExpanderDMGCoop:
			"####" "#" 0 A_SetUserVar("user_scalex", scalex*65536.0)
			"####" "#" 0 A_SetUserVar("user_scaley", scaley*65536.0)
			"####" "#" 0 A_PlaySound("duke/expand")
			Goto ExpanderLoopCoop
		ExpanderLoopCoop:
			"####" "#" 1 A_SetScale(1.1*(user_scalex/65536.0)+((0.01*(user_scalex/65536.0))*CallACS("Samsara_Expander",1))+((0.01*(user_scalex/65536.0))*(CallACS("Samsara_Expander",1)-CallACS("Samsara_Expander",2)))*(CallACS("Samsara_Expander",3)*2),1.1*(user_scaley/65536.0)+((0.01*(user_scaley/65536.0))*CallACS("Samsara_Expander",2)))
			"####" "#" 0 A_GiveInventory("ExpanderGrowthX", 1)
			"####" "#" 0 A_JumpIf(ceilingz - (z + height + CallACS("Samsara_Expander",1) + 32) <= 0, 2)
			"####" "#" 0 A_GiveInventory("ExpanderGrowthY", 1)
			"####" "#" 0 A_GiveInventory("ExpanderDoubleX", 1)
			"####" "#" 0 A_JumpIfInventory("ExpanderGrowthX", 40, "ExpanderPopCoop")
			loop
		ExpanderPopCoop:	
			"####" "#" 10
			"####" A 0 A_SpawnItemEx("ExpanderExplosion_Coop",0,0,height*2,0,0,0,0,SXF_NOCHECKPOSITION|SXF_SETMASTER)
			"####" A 0 A_PlaySound("duke/explosion", 6, 1.0)
			"####" A 1 ACS_NamedExecuteWithResult("SamsaraDecorate",36,2)
			"####" A 0 A_Jump(96,2)
			"####" A 0 A_GiveToTarget("DukeDMTaunt1", 1)
			"####" A 0 A_SetScale (1.0, 1.0)
			"####" A 0 A_UnsetSolid
			"####" A 0 A_SpawnItemEx("UniversalBloodyHellGoreXDeathEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_USEBLOODCOLOR)
			"####" A 0 A_SpawnItemEx("DukeGibPopSpawner", 0, 0, height*2, 0, 0, 0, 0, SXF_NOCHECKPOSITION|SXF_USEBLOODCOLOR)
			"####" A 0 A_GiveToTarget("DukeDMTaunt1",1)
			TNT1 A -1 A_UnsetSolid
			Stop
		Pain.ShrinkerDMG:
			TNT1 A 0 A_ChangeFlag("NOPAIN",true)
			TNT1 A 0 A_ChangeFlag("NODAMAGE",true)
			TNT1 A 0 A_JumpIfInventory("WolfenClassMode",2,"ShrinkTotenkopf")
			BJBL G 0 ACS_NamedExecuteAlways("Samsara_PlayerShrinker")
			"####" "#" 0 A_SetUserVar("user_scalex", scalex*65536.0)
			"####" "#" 0 A_SetUserVar("user_scaley", scaley*65536.0)
			"####" "#" 0 A_PlaySound("duke/shrink")
			"####" "#" 1 A_SetScale(0.95*(user_scalex/65536.0),0.95*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.9*(user_scalex/65536.0),0.9*(user_scaley/65536.0))
			"####" "#" 0 A_SpawnItemEx("WolfenPlayer_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
			"####" "#" 1 A_SetScale(0.85*(user_scalex/65536.0),0.85*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.8*(user_scalex/65536.0),0.8*(user_scaley/65536.0))
			"####" "#" 0 A_SpawnItemEx("WolfenPlayer_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
			"####" "#" 1 A_SetScale(0.75*(user_scalex/65536.0),0.75*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.7*(user_scalex/65536.0),0.7*(user_scaley/65536.0))
			"####" "#" 0 A_SpawnItemEx("WolfenPlayer_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
			"####" "#" 1 A_SetScale(0.65*(user_scalex/65536.0),0.65*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.6*(user_scalex/65536.0),0.6*(user_scaley/65536.0))
			"####" "#" 0 A_SpawnItemEx("WolfenPlayer_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
			"####" "#" 1 A_SetScale(0.55*(user_scalex/65536.0),0.55*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.5*(user_scalex/65536.0),0.5*(user_scaley/65536.0))
			"####" "#" 0 A_SpawnItemEx("WolfenPlayer_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
			"####" "#" 1 A_SetScale(0.45*(user_scalex/65536.0),0.45*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.4*(user_scalex/65536.0),0.4*(user_scaley/65536.0))
			"####" "#" 0 A_SpawnItemEx("WolfenPlayer_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
			"####" "#" 1 A_SetScale(0.35*(user_scalex/65536.0),0.35*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.3*(user_scalex/65536.0),0.3*(user_scaley/65536.0))
			"####" "#" 0 A_SpawnItemEx("WolfenPlayer_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
			"####" "#" 1 A_SetScale(0.25*(user_scalex/65536.0),0.25*(user_scaley/65536.0))
			"####" "#" 4 A_SetScale(0.2*(user_scalex/65536.0),0.2*(user_scaley/65536.0))
			TNT1 A 0 A_ChangeFlag("NODAMAGE",false)
			Goto Spawn
		ShrinkTotenkopf:
			TK61 I 0 ACS_NamedExecuteAlways("Samsara_PlayerShrinker")
			"####" "#" 0 A_SetUserVar("user_scalex", scalex*65536.0)
			"####" "#" 0 A_SetUserVar("user_scaley", scaley*65536.0)
			"####" "#" 0 A_PlaySound("duke/shrink")
			"####" "#" 1 A_SetScale(0.95*(user_scalex/65536.0),0.95*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.9*(user_scalex/65536.0),0.9*(user_scaley/65536.0))
			"####" "#" 0 A_SpawnItemEx("TotenkopfPlayer_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
			"####" "#" 1 A_SetScale(0.85*(user_scalex/65536.0),0.85*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.8*(user_scalex/65536.0),0.8*(user_scaley/65536.0))
			"####" "#" 0 A_SpawnItemEx("TotenkopfPlayer_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
			"####" "#" 1 A_SetScale(0.75*(user_scalex/65536.0),0.75*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.7*(user_scalex/65536.0),0.7*(user_scaley/65536.0))
			"####" "#" 0 A_SpawnItemEx("TotenkopfPlayer_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
			"####" "#" 1 A_SetScale(0.65*(user_scalex/65536.0),0.65*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.6*(user_scalex/65536.0),0.6*(user_scaley/65536.0))
			"####" "#" 0 A_SpawnItemEx("TotenkopfPlayer_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
			"####" "#" 1 A_SetScale(0.55*(user_scalex/65536.0),0.55*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.5*(user_scalex/65536.0),0.5*(user_scaley/65536.0))
			"####" "#" 0 A_SpawnItemEx("TotenkopfPlayer_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
			"####" "#" 1 A_SetScale(0.45*(user_scalex/65536.0),0.45*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.4*(user_scalex/65536.0),0.4*(user_scaley/65536.0))
			"####" "#" 0 A_SpawnItemEx("TotenkopfPlayer_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
			"####" "#" 1 A_SetScale(0.35*(user_scalex/65536.0),0.35*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.3*(user_scalex/65536.0),0.3*(user_scaley/65536.0))
			"####" "#" 0 A_SpawnItemEx("TotenkopfPlayer_ShrinkEffect",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_TRANSFERTRANSLATION)
			"####" "#" 1 A_SetScale(0.25*(user_scalex/65536.0),0.25*(user_scaley/65536.0))
			"####" "#" 4 A_SetScale(0.2*(user_scalex/65536.0),0.2*(user_scaley/65536.0))
			TNT1 A 0 A_ChangeFlag("NODAMAGE",false)
			TNT1 A 0 A_ChangeFlag("NOPAIN",false)
			Goto Spawn
		Pain.Shock:
		Pain.Tesla:
			CBGS A 4 A_Pain
			CBGS A 4
			Goto See
	}
}

Actor WolfenPlayer_Shrink : WolfenPlayer
{
	Player.ForwardMove 0.25
	Player.SideMove 0.25
	Player.MorphWeapon "ShrunkWeapon"
	Player.ViewHeight 8
	DamageFactor "ZorchPistol", 0.0
	DamageFactor "Zorch", 0.0
	DamageFactor "ZorchKamikaze", 0.0
	DamageFactor "PhasingZorch", 0.0
	DamageFactor "ZorchSpectral", 0.0
	MaxStepHeight 2
	Height 8
	Radius 4
	-SOLID
	+NOPAIN
	States
	{
		Spawn:
			TNT1 A 0 A_JumpIfInventory("WolfenClassMode",2,3)
			BJBL A 1
			TNT1 A -1 A_Jump(256,"Spawn")
			TK61 A 1
			Loop
		See:
			TNT1 A 0 A_JumpIfInventory("WolfenClassMode",2,18)
			BJBL AAAABBBBCCCCDDDD 1
			TNT1 A -1 A_Jump(256,"See")
			TK61 BBBBCCCCDDDDEEEE 1
			Loop
		Death.PhosFire:
		Death.PhosFireCoop:
		Death.HexGreenFire:
		Death.QuakeFire:
		Death.FireExplosive:
		Death.PGFire:
		Death.WTRangedFire:
		Death.WolfenFlamethrower:
		Death.MarathonFire:
		Death.MarathonPlasmaFire:
		Burn:
		Death.TotenkopfFire:
		Death.DukeDamage:
		Death.DukePistol:
		Death.MightyBoot:
		Death.DukeExplosive:
		Death.DukeIce:
		Ice:
		Death.HexenIce:
		Death.Ice:
		Death.ExpanderDMG:
		XDeath.ExpanderDMG:
		Death.ExpanderDMGCoop:
		XDeath.ExpanderDMGCoop:
		Death.QuakeElectric:
		Death.NotQuadded:
		Death.QuakeExplosive:
		XDeath.QuakeElectric:
		XDeath.NotQuadded:
		XDeath.QuakeExplosive:
		Death.RottExplosive:
		Death.RottFire:
		Death.RottDisintegrate:
		Death.CalebFire:
		Death.LifeLeech:
		Death.CalebNapalm:
		Death.Vodoo:
		Death.VoodooPuff:
		Death.DynamiteCoop:
		Death.Dynamite:
		Death.Shock:  
		Death.Tesla:
		Death.CalebBullet:
		Disintegrate:
		Death.EradExplosive:
		Death.EradNova:
		Death.EradShock:
		Death.EradExplosive2:
		Death.EradDisc:
		Death.EradPiercingDart:
		Death.EradGreenFire:
		Death.EradCoopGreenFire:
		Death.Nuke:
		Death.HLLaser:
		Death.HLExplosive:
		Death.HLRPGExplosive:
		Death.HLEgon:
		Death.FreemanGibs:
		Death.SWFist:
		Death.SWKatana:
		Death.SWShuriken:
		Death.SWSticky:
		Death.SWStickyCoop:
		Death.SWGrenade:
		Death.SWNuke:
		Death.SWRocket:
		Death.SWRailgun:
		Death.SWRailgunCoop:
		Death.SWNukeCoop:
		Death.SWFlame:
		Death.SWFlame2:
		Death.SWFlame2Coop:
		Death.SWFlame3:	
		Death.SWBullet:
		Death.PSRAPower:
		Death.PSRAPowerCoop:
		Death.PSExplosive:
		Death.PSExplosiveCoop:
		Death.PSBullet:
		Death.PSFire:
		Death.PSFire:
		Death.LeonardDamage2:
		Death.LeonardDamage3:
		Death.LeonardDamage0:
		Death.LeonardDamage1:	
		Death.BittermanDamage:
		Death.Hexen2Damage:
		Death.Hexen2Fire:
		Death.Hexen2Electric:
		Death.Hexen2Extreme:
		Death.Hexen2ElectricExtreme:
		Death.Painkiller:
		Death.PainkillerBullet:
		Death.PainkillerElectro:
		Death.PainkillerExplosive:
		Death.PainkillerShuriken:
		Death.PainkillerDemon:
		Death.PainkillerStake:
		Death.PainkillerFire:
		PainkillerGib:
		Death.UnrealDamage:
		Death.UnrealPlasma:
		Death.UnrealSludge:
		Death.ASMDShockTrace:
		Death.UnrealExplosive:
		Death.UnrealRazor:
		Death.UnrealExtreme:
		Death.UnrealRedeemer:
		Death.UnrealShredded:
		UnrealXDeath:
		Death.RTCWVenomBullet:
		Death.RTCWExplosive:
		RTCWXDeath:
		RTCWXDeath2:
		Death.Q3Explosive:
		Death.Q3Energy:
		Death.Q3BFG:
		XDeath.Q3Explosive:
		XDeath.Q3Energy:
		Death.DeusExPistolFire:
		Death.DeusExFlamed:
		Death.DeusExLAM:
		Death.DeusExRifleExploded:
		Death.DeusExSabotPistol:
		Death.DeusExSabot:
		Death.DeusExBurned:
		Death.DeusExExploded:
		DeusXDeath:
		Death:
		XDeath:
		Death.Squish:
		XDeath.Squish:
			TNT1 A 0 A_PlaySound("duke/enemygib", CHAN_BODY)
			TNT1 A 1 A_SpawnItemEx("DukeBloodPool",0,0,0,0,0,0,0,SXF_USEBLOODCOLOR|SXF_NOCHECKPOSITION)
			TNT1 A -1
			stop
		Death.DukeSquish:
		XDeath.DukeSquish:
			TNT1 A 0 A_JumpIfInventory("WolfenClassMode",2,"DukeSquishTotenkopf")
			TNT1 A 0 A_GiveToTarget("DukeStomp", 1)
			TNT1 A 0 SetPlayerProperty(0,1,PROP_TOTALLYFROZEN)
			BJBL G 15
			TNT1 A 0 A_Jump(64,2)
			TNT1 A 0 A_GiveToTarget("DukeBootTaunt",1)
			TNT1 A 0 SetPlayerProperty(0,0,PROP_TOTALLYFROZEN)
			TNT1 A 0 A_PlaySound("duke/enemygib", CHAN_BODY)
			TNT1 A 1 A_SpawnItemEx("DukeBloodPool",0,0,0,0,0,0,0,SXF_USEBLOODCOLOR|SXF_NOCHECKPOSITION)
			TNT1 A -1
			stop
		DukeSquishTotenkopf:
			TNT1 A 0 A_GiveToTarget("DukeStomp", 1)
			TNT1 A 0 SetPlayerProperty(0,1,PROP_TOTALLYFROZEN)
			TK61 I 15
			TNT1 A 0 A_Jump(64,2)
			TNT1 A 0 A_GiveToTarget("DukeBootTaunt",1)
			TNT1 A 0 SetPlayerProperty(0,0,PROP_TOTALLYFROZEN)
			TNT1 A 0 A_PlaySound("duke/enemygib", CHAN_BODY)
			TNT1 A 1 A_SpawnItemEx("DukeBloodPool",0,0,0,0,0,0,0,SXF_USEBLOODCOLOR|SXF_NOCHECKPOSITION)
			TNT1 A -1
			stop
	}
}

actor WolfenPlayer_ShrinkEffect : WolfenPlayer
{
	-ISMONSTER
	-COUNTKILL
	-SHOOTABLE
	-SOLID
	+NOINTERACTION
	-NOGRAVITY
	+CLIENTSIDEONLY	
	Renderstyle Translucent
	Alpha 0.4
	States
	{
		Spawn:
			BJBL G 0
			BJBL G 0 A_SetUserVar("user_scalex", scalex*65536.0)
			BJBL G 0 A_SetUserVar("user_scaley", scaley*65536.0)
			"####" "#" 1 A_SetScale(0.95*(user_scalex/65536.0),0.95*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.9*(user_scalex/65536.0),0.9*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.85*(user_scalex/65536.0),0.85*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.8*(user_scalex/65536.0),0.8*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.75*(user_scalex/65536.0),0.75*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.7*(user_scalex/65536.0),0.7*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.65*(user_scalex/65536.0),0.65*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.6*(user_scalex/65536.0),0.6*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.55*(user_scalex/65536.0),0.55*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.5*(user_scalex/65536.0),0.5*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.45*(user_scalex/65536.0),0.45*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.4*(user_scalex/65536.0),0.4*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.35*(user_scalex/65536.0),0.35*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.3*(user_scalex/65536.0),0.3*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.25*(user_scalex/65536.0),0.25*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.2*(user_scalex/65536.0),0.2*(user_scaley/65536.0))
			Stop
	}
}

actor TotenkopfPlayer_ShrinkEffect : WolfenPlayer
{
	-ISMONSTER
	-COUNTKILL
	-SHOOTABLE
	-SOLID
	+NOINTERACTION
	-NOGRAVITY
	+CLIENTSIDEONLY	
	Renderstyle Translucent
	Alpha 0.4
	States
	{
		Spawn:
			TK61 I 0
			TK61 I 0 A_SetUserVar("user_scalex", scalex*65536.0)
			TK61 I 0 A_SetUserVar("user_scaley", scaley*65536.0)
			"####" "#" 1 A_SetScale(0.95*(user_scalex/65536.0),0.95*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.9*(user_scalex/65536.0),0.9*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.85*(user_scalex/65536.0),0.85*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.8*(user_scalex/65536.0),0.8*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.75*(user_scalex/65536.0),0.75*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.7*(user_scalex/65536.0),0.7*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.65*(user_scalex/65536.0),0.65*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.6*(user_scalex/65536.0),0.6*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.55*(user_scalex/65536.0),0.55*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.5*(user_scalex/65536.0),0.5*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.45*(user_scalex/65536.0),0.45*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.4*(user_scalex/65536.0),0.4*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.35*(user_scalex/65536.0),0.35*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.3*(user_scalex/65536.0),0.3*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.25*(user_scalex/65536.0),0.25*(user_scaley/65536.0))
			"####" "#" 1 A_SetScale(0.2*(user_scalex/65536.0),0.2*(user_scaley/65536.0))
			Stop
	}
}

actor WolfenAmmoCrate : CustomInventory
{
    +INVENTORY.INVBAR
    +INVENTORY.UNDROPPABLE
    Inventory.maxamount 1
    Inventory.Icon "BJAMMCRT"
    Inventory.UseSound "wolfen/ammocrate"
	Inventory.RestrictedTo "WolfenPlayer"
    Tag "Ammo Crate"
    States
    {
      Spawn:
        TNT1 A 5
        Stop

      Use:
        TNT1 A 0 A_JumpIfInventory("Clip",0,"UseFail")
        TNT1 A 0 A_SetBlend("white",0.1,1)
        TNT1 A 0 A_GiveInventory("Clip",800)
        stop

      UseFail:
        TNT1 A 0
        fail
    }
}

actor WolfMoving: Boolean {}
actor CanWolfMovement : Boolean {}
actor WolfenMovement : Boolean {}
actor WolfenClass : Boolean {}

actor WolfCheckMoving: CustomInventory
{
    States
    {
      Pickup:
        TNT1 A 0 A_JumpIfInventory("WolfMoving",1,"DoNothing")
        TNT1 A 0 A_JumpIfInventory("WolfenMovement",1,"DoStuff")

      DoNothing:
        TNT1 A 0
        stop

      DoStuff:
        TNT1 A 0 ACS_NamedExecuteAlways("SamsaraDecorate", 0, 2)
        stop
    }
}

actor WolfenBullet : FastProjectile
{
    Damage (Random(0,256)/4)
    Radius 1
    Height 1
    Speed 320
    Projectile
    Renderstyle "Normal"
    Species "Player"
    +BLOODSPLATTER
	+NOEXTREMEDEATH
	+NODAMAGETHRUST
    +THRUGHOST
    +THRUSPECIES
    +NOTIMEFREEZE
    Alpha 1.0
    States
    {
      Spawn:
        TNT1 A 1
        loop

      Death:
        TNT1 A 1
        stop
    }
}

actor WolfenBullet2 : WolfenBullet { Damage (Random(0,256)/8) }
Actor WolfenBullet3 : WolfenBullet { Damage (Random(0,256)/16) }

actor BlankPuff
{
    +CLIENTSIDEONLY
	+NOEXTREMEDEATH
	+NODAMAGETHRUST
    States
    {
      Spawn:
        TNT1 A 1
        Stop
    }
}
actor BlankPuffCoop : BlankPuff { +MTHRUSPECIES }

actor BlankPuffBloodless : BlankPuff { +BLOODLESSIMPACT +DONTSPLASH +NOTRIGGER }
actor BlankPuffBloodlessCoop : BlankPuffBloodless { +MTHRUSPECIES }

actor BlankPuffThruGhost : BlankPuff { +THRUGHOST }
actor BlankPuffThruGhostCoop : BlankPuffThruGhost { +MTHRUSPECIES }

actor BlankPuffThruGhostBloodless : BlankPuffThruGhost { +BLOODLESSIMPACT +DONTSPLASH +NOTRIGGER }
actor BlankPuffThruGhostBloodlessCoop : BlankPuffThruGhostBloodless { +MTHRUSPECIES }

Actor AlreadyDiedOnceBJ : Inventory { Inventory.Amount 1 Inventory.MaxAmount 1 }

actor Totenkopf_BlankPuff
{
    +CLIENTSIDEONLY
	+NOEXTREMEDEATH
	-BLOODSPLATTER
	+BLOODLESSIMPACT
	+NODAMAGETHRUST
    States
    {
      Spawn:
        TNT1 A 1
        Stop
    }
}

Actor Totenkopf_BloodGenerator : CustomInventory
{
	-COUNTITEM
	+INVENTORY.ALWAYSPICKUP
	Inventory.PickupMessage ""
	Inventory.PickupSound ""
	States
	{
		Pickup:
			TNT1 A 0
			TNT1 A 0 A_SpawnItemEx("Totenkopf_Blood",radius*cos(CallACS("Totenkopf_BloodGenerator_Return",1)),radius*sin(CallACS("Totenkopf_BloodGenerator_Return",1)),CallACS("Totenkopf_BloodGenerator_Return",2),0,0,0,0,SXF_NOCHECKPOSITION|SXF_USEBLOODCOLOR|SXF_ABSOLUTEPOSITION)
			TNT1 A 0
			stop
	}
}

Actor Totenkopf_Blood
{
	+NOINTERACTION
	+NOGRAVITY
	//+CLIENTSIDEONLY
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_SpawnItemEx("Switchable_FlyingBlood",0,0,0,random(-350,350)/100.00,random(-350,350)/100.00,random(500,1000)/100.00,random(-180,180),33|SXF_TRANSFERTRANSLATION)
			TK50 ABC 4 A_Stop
			Stop
	}
}

Actor Totenkopf_Blood_Mutant : Totenkopf_Blood
{
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_SpawnItemEx("Switchable_FlyingBlood",0,0,0,random(-350,350)/100.00,random(-350,350)/100.00,random(500,1000)/100.00,random(-180,180),33|SXF_TRANSFERTRANSLATION)
			TK56 ABC 4 A_Stop
			Stop
	}
}

Actor Totenkopf_BloodGeneratorAngle : Inventory { Inventory.Maxamount 131072 }
Actor Totenkopf_BloodGeneratorZ : Inventory { Inventory.Maxamount 131072 }

Actor Totenkopf_Tracer : FastProjectile
{
	Height 4
	Radius 2
	Speed 512
	Projectile
	DamageType "TotenkopfBullet"
	+BLOODLESSIMPACT
	+HITTRACER
	+NOEXTREMEDEATH
	+NODAMAGETHRUST
    +DONTBLAST
    +NOTIMEFREEZE
	States
	{
		Spawn:
			TNT1 A -1
			stop
		Crash:
		Death:
			TNT1 A 1
			TNT1 A 0 A_Playsound("Totenkopf/Ricochet", CHAN_BODY)
			TNT1 A 0 A_SpawnItemEx("Totenkopf_Tracer_Spark",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
			Stop
		XDeath:
			TNT1 A 0 A_JumpIf(CallACS("Totenkopf_BloodGenerator_Offsets")==1,1)
			TNT1 A 1 Bright
			TNT1 A 0 A_GiveInventory("Totenkopf_BloodGenerator",1,AAPTR_TRACER)
			TNT1 A 1
			Stop
	}
}

Actor Totenkopf_Tracer_Trail
{
	+NOINTERACTION
	+CLIENTSIDEONLY
	States
	{
		Spawn:
			TK51 AA 1 Bright
			Stop
	}
}

Actor Totenkopf_Tracer_Spark
{
	+NOINTERACTION
	+CLIENTSIDEONLY
	States
	{
		Spawn:
			TK51 BCDE 2 Bright
			Stop
	}
}

Actor Totenkopf_BurningGuard
{
	+ISMONSTER
	+NODAMAGE
	-COUNTKILL
	-SHOOTABLE
	-SOLID
	Height 52
	Radius 16
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_JumpIf(CallACS("Totenkopf_BurningVoice")==1,1)
			TK13 ABCDABCDABCDABCD 5 Bright
			TK13 EFG 5 Bright
			TK13 H -1
			Stop
	}
}

Actor TotenkopfPowerArmor : CustomInventory
{
	Radius 20
	Height 16
	Inventory.PickupMessage "Power Armor: your armor now regenerates!"
	Inventory.PickupSound "Totenkopf/Bonus"
	Inventory.RestrictedTo "WolfenPlayer"
	Inventory.Icon "TK55A0"
	+INVENTORY.ALWAYSPICKUP
	States
	{
		Spawn:
			TK55 A 6 Bright
			Loop
		Pickup:
			TNT1 A 0 A_GiveInventory("TotenkopfPowerArmorPickup",1)
			TNT1 A 0 A_GiveInventory("TotenkopfHasPowerArmor",1)
			stop
	}
}

Actor TotenkopfPowerArmorPickup : BasicArmorPickup
{
	Radius 20
	Height 16
	Inventory.PickupSound "Totenkopf/Bonus"
	Inventory.PickupMessage "Power Armor: your armor now regenerates!"
	Inventory.Icon "TK55A0"
	Armor.SavePercent 50
	Armor.SaveAmount 200
	+INVENTORY.KEEPDEPLETED
	States
	{
		Spawn:
			TK55 A 6 Bright
			Loop
	}
}

Actor TotenkopfPowerArmorKeeper : BasicArmorBonus
{
	Radius 20
	Height 16
	Inventory.Icon "TK55A0"
	Armor.SavePercent 50
	Armor.SaveAmount 1
	Armor.MaxSaveAmount 200
	+INVENTORY.ALWAYSPICKUP
	States
	{
		Spawn:
			TNT1 A 35
			Loop
	}
}

Actor TotenkopfHealingOrb : CustomInventory
{
	Radius 20
	Height 16
	Inventory.PickupMessage "Healing Orb: your health now regenerates!"
	Inventory.PickupSound "Totenkopf/Bonus"
	Inventory.RestrictedTo "WolfenPlayer"
	Inventory.Icon "TK55B0"
	+INVENTORY.ALWAYSPICKUP
	States
	{
		Spawn:
			TK55 A 6 Bright
			Loop
		Pickup:
			TNT1 A 0 A_GiveInventory("TotenkopfHealingOrbHealer",200)
			TNT1 A 0 A_GiveInventory("TotenkopfHasHealingOrb",1)
			stop
	}
}

ACTOR TotenkopfHealingOrbHealer : Health
{
	+COUNTITEM
	+INVENTORY.ALWAYSPICKUP
	Inventory.Amount 1
	Inventory.MaxAmount 200
	Inventory.PickupMessage ""
	States
	{
		Spawn:
			TNT1 A 1
			Loop
	}
}

Actor TotenkopfHasPowerArmor : Inventory { Inventory.Maxamount 1 }
Actor TotenkopfHasHealingOrb : Inventory { Inventory.Maxamount 1 }
Actor TotenkopfSecretCounter : Inventory { Inventory.Maxamount 30 }