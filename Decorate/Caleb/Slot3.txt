ACTOR Sawedoff : CalebWeapon
{
	obituary "%k gave %o a heap of buckshot."
	Weapon.AmmoType "Shell"
	Weapon.AmmoType2 "Shell"
	inventory.pickupmessage "You got the Sawed off!"
	Inventory.PickupSound "Caleb/Weaponup"
	weapon.selectionorder 80
	Tag "Sawed-Off Shotgun"
	Weapon.AmmoGive 8
	Weapon.AmmoUse 1
	Weapon.AmmoUse2 2
	Weapon.SlotNumber 3
	+THRUGHOST
	Decal ZBloodBulletChip1
	states
	{
	Spawn:
		BSOP A -1
		Stop
	Ready:
		TNT1 A 0 A_TakeInventory("UsingPitchfork", 1)
		TNT1 A 0 A_JumpIfInventory("GunsAkimboP", 1, "AkimboReady")
		TNT1 A 0 A_JumpIfInventory("CalebReady",1,"IntroTaunt")
		TNT1 A 0 A_JumpIfInventory("CalebWaiting",60,"WaitingTaunt")
		WP01 A 1 A_WeaponReady
		Goto Ready+1
	Deselect:
		WP01 A 0 A_JumpIfInventory("GunsAkimboP", 1, 1)
		Goto Super::DeselectLoop
		SAKM A 0
		Goto Super::DeselectLoop
	Select:
		WP01 A 0 A_JumpIfInventory("GunsAkimboP", 1, 1)
		Goto Super::SelectLoop
		SAKM A 0
		Goto Super::SelectLoop
	Fire:
		TNT1 A 0 A_JumpIfInventory("GunsAkimboP", 1, "AkimboFire")
		TNT1 A 0 A_JumpIfInventory("SawedOffCheck",2,"Reload")
		TNT1 A 0 A_JumpIfInventory("SawedOffCheck",1,"Fire2")
		TNT1 A 1 A_GunFlash
		SWFL ABC 2 BRIGHT A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 2 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_GiveInventory("SawedOffCheck",1)
		Goto Ready
	Fire2:
		WP01 C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_GunFlash
		SWFL DEF 2 BRIGHT A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_GiveInventory("SawedOffCheck",2)
		TNT1 A 20 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		Goto Ready
	AltFire:
		TNT1 A 0 A_JumpIfInventory("GunsAkimboP", 1, "AkimboAltFire")
		TNT1 A 0 A_JumpIfInventory("SawedOffCheck",2,"Reload")
		TNT1 A 0 A_JumpIfInventory("SawedOffCheck",1,"Fire2")
		TNT1 A 0 A_JumpIfInventory("Shell", 2, 1)
		Goto Fire
		WP01 D 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_GunFlash
		AB99 ABC 2 BRIGHT A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_GiveInventory("SawedOffCheck",2)
		TNT1 A 22 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		Goto Ready
	Flash:
		TNT1 A 0 A_JumpIfInventory("SawedOffCheck",1,"Flash2")
		TNT1 A 0 A_PlayWeaponSound("SawnOff/Fire")
		TNT1 A 0 A_JumpIfInventory("CoopModeOn", 1, 2)
		TNT1 A 0 A_FireBullets(4.1, 1.8, 15, 5, "ZBBulletPuff", FBF_NORANDOM|FBF_USEAMMO)
		Goto Flash1End
		TNT1 A 0 A_FireBullets(4.1, 1.8, 15, 5, "ZBBulletPuffCoop", FBF_NORANDOM|FBF_USEAMMO)
		Goto Flash1End
	Flash1End:
		TNT1 A 0 A_SetPitch(pitch-2.25)
		ANIM D 1 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.25)
		ANIM E 1 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.25)
		ANIM L 1 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.25)
		ANIM H 1 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.5)
		ANIM G 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.25)
		ANIM Y 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.5)
		TNT1 A 0 A_SetPitch(pitch+0.25)
		ANIM C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.25)
		ANIM BA 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		Stop
	Flash2:
		TNT1 A 0 A_PlayWeaponSound("SawnOff/Fire")
		TNT1 A 0 A_JumpIfInventory("CoopModeOn", 1, 2)
		TNT1 A 0 A_FireBullets(4.1, 1.8, 15, 5, "ZBBulletPuff", FBF_NORANDOM|FBF_USEAMMO)
		Goto Flash2End
		TNT1 A 0 A_FireBullets(4.1, 1.8, 15, 5, "ZBBulletPuffCoop", FBF_NORANDOM|FBF_USEAMMO)
		Goto Flash2End
	Flash2End:
		TNT1 A 0 A_SetPitch(pitch-2.25)
		ANIM D 1 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.25)
		ANIM E 1 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.25)
		ANIM L 1 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.25)
		ANIM H 1 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.5)
		ANIM G 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.25)
		ANIM Y 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.25)
		ANIM C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.25)
		ANIM B 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.25)
		ANIM A 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.25)
		TNT1 A 0 A_JumpIfNoAmmo("NoAmmo")
		TNT1 A 0 A_PlaySound("SawnOff/Load",6)
		WP01 EFG 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_FireCustomMissile("ZBShotgunCasing",-45+random(-8,8),0,1,8,0)
		TNT1 A 0 A_FireCustomMissile("ZBShotgunCasing",-45+random(-8,8),0,0,8,0)
		TNT1 A 0 A_TakeInventory("SawedOffCheck",2)
		WP01 HIJKLMNOPQRSTU 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		Stop
	AltFlash:
		TNT1 A 0 A_JumpIfInventory("SawedOffCheck",1,"Flash2")
		TNT1 A 0 A_JumpIfInventory("Shell", 2, 1)
		Goto Flash
		TNT1 A 0 A_PlayWeaponSound("SawnOff/AltFire")
		TNT1 A 0 A_JumpIfInventory("CoopModeOn", 1, 2)
		TNT1 A 0 A_FireBullets(5.8, 5.2, 30, 5, "ZBBulletPuff", FBF_NORANDOM|FBF_USEAMMO)
		Goto AltFlashEnd
		TNT1 A 0 A_FireBullets(5.8, 5.2, 30, 5, "ZBBulletPuffCoop", FBF_NORANDOM|FBF_USEAMMO)
		Goto AltFlashEnd
	AltFlashEnd:
		TNT1 A 0 A_SetPitch(pitch-4.5)
		ANIM D 1 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.5)
		ANIM K 1 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.5)
		ANIM W 1 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.5)
		ANIM V 1 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.5)
		ANIM I 1 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.5)
		ANIM J 1 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.5)
		ANIM J 1 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.5)
		ANIM I 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.5)
		ANIM H 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.5)
		ANIM GYC 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfNoAmmo("NoAmmo")
		TNT1 A 0 A_PlaySound("SawnOff/Load",6)
		WP01 EF 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_FireCustomMissile("ZBShotgunCasing",-45+random(-8,8),0,1,8,0)
		TNT1 A 0 A_FireCustomMissile("ZBShotgunCasing",-45+random(-8,8),0,0,8,0)
		TNT1 A 0 A_TakeInventory("SawedOffCheck",2)
		WP01 GHIJKLMNOPQRTV 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		Stop
	NoAmmo:
		WP01 A 20 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		Stop
	AkimboReady:
		TNT1 A 0 A_JumpIfInventory("CalebReady",1,"IntroTaunt")
		TNT1 A 0 A_JumpIfInventory("CalebWaiting",60,"WaitingTaunt")
		SAKM A 1 A_WeaponReady
		Goto Ready+1
	AkimboFire:
		TNT1 A 0 A_GunFlash("AkimboFlash")
		SWFL JK 2 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		SWFL L 1 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("Shell", 1, 1)
		Goto Ready // Go back if no ammo, this is needed since this works with flash state.
		SWFL GH 2 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		SWFL I 1 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 7 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		goto Ready
	AkimboAltFire:
		TNT1 A 0 A_JumpIfInventory("Shell", 4, 1)
		Goto Fire
		TNT1 A 0 A_GunFlash("AkimboAltFlash")
		SAFF ABC 2 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 18 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		goto Ready
	AkimboFlash:
		SAKF A 3 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("CoopModeOn", 1, 2)
		TNT1 A 0 A_FireBullets (4.3, 2.2, 15, 5, "ZBBulletPuff", FBF_NORANDOM|FBF_USEAMMO)
		Goto AkimboFlashContinue
		TNT1 A 0 A_FireBullets (4.3, 2.2, 15, 5, "ZBBulletPuffCoop", FBF_NORANDOM|FBF_USEAMMO)
		Goto AkimboFlashContinue
	AkimboFlashContinue:
		TNT1 A 0 A_PlaySound("SawnOff/Fire")
		TNT1 A 0 A_SetPitch(pitch-0.95)
		SAKM C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.95)
		SAKM C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("Shell", 1, 1)
		Stop
		SAKF C 3 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("CoopModeOn", 1, 2)
		TNT1 A 0 A_FireBullets (4.3, 2.2, 15, 5, "ZBBulletPuff", FBF_NORANDOM|FBF_USEAMMO)
		Goto AkimboFlashEnd
		TNT1 A 0 A_FireBullets (4.3, 2.2, 15, 5, "ZBBulletPuffCoop", FBF_NORANDOM|FBF_USEAMMO)
		Goto AkimboFlashEnd
	AkimboFlashEnd:
		TNT1 A 0 A_PlaySound("SawnOff/Fire")
		TNT1 A 0 A_SetPitch(pitch-0.95)
		SAKM C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.95)
		SAKM C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		SAKF EFG 2 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		SAKF H 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		stop
	AkimboAltFlash:
		TNT1 A 0 A_JumpIfInventory("Shell", 4, 1)
		Goto Flash
		SAKM BB 1 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_TakeInventory("Shell", 2, TIF_NOTAKEINFINITE)
		TNT1 A 0 A_JumpIfInventory("CoopModeOn", 1, 2)
		TNT1 A 0 A_FireBullets (6.1, 5.6, 60, 5, "ZBBulletPuff", FBF_NORANDOM|FBF_USEAMMO)
		Goto AkimboAltPitchCheck
		TNT1 A 0 A_FireBullets (6.1, 5.6, 60, 5, "ZBBulletPuffCoop", FBF_NORANDOM|FBF_USEAMMO)
		Goto AkimboAltPitchCheck
	AkimboAltPitchCheck:
		TNT1 AA 0 A_PlayWeaponSound("SawnOff/AltFire")
		TNT1 A 0 A_SetPitch(pitch-5.75)
		SAKM CC 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch-0.60)
		SAKM DD 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch-0.5)
		TNT1 A 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch-0.5)
		TNT1 A 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch-0.5)
		TNT1 A 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.75)
		TNT1 A 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.60)
		TNT1 A 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.5)
		SAKM E 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.5)
		SAKM E 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+0.5)
		SAKM D 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+2.5)
		SAKM D 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_SetPitch(pitch+2.5)
		SAKM CCFF 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		SAKM A 5 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		stop
	Reload:
		TNT1 A 0 A_JumpIfInventory("Shell",1,1)
		Goto Ready
		TNT1 A 0 A_PlaySound("SawnOff/Load",6)
		WP01 EF 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_FireCustomMissile("ZBShotgunCasing",-45+random(-8,8),0,1,8,0)
		TNT1 A 0 A_FireCustomMissile("ZBShotgunCasing",-45+random(-8,8),0,0,8,0)
		TNT1 A 0 A_TakeInventory("SawedOffCheck",2)
		WP01 GHIJKLMNOPQRTV 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		Goto Ready
	}
}

Actor SawedOffCheck : Counter { inventory.maxamount 2 }
