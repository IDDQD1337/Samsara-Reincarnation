actor Flaregun : CalebWeapon
{
	Obituary "%k \cucooked\c- %o."
	AttackSound "Flare/Fire"
	Inventory.PickupMessage "You got the Flare Gun!"
	Inventory.PickupSound "Caleb/Weaponup"
	Weapon.SelectionOrder 230
	Weapon.AmmoType "Shell"
	Weapon.AmmoUse 1
	Weapon.AmmoType2 "Shell"
	Weapon.AmmoUse2 0
	Tag "Flare Pistol"
	+WEAPON.NOALERT
	Weapon.ammogive 8
	Weapon.SlotNumber 2
	states
	{
	Ready:
		TNT1 A 0 A_TakeInventory("UsingPitchfork", 1)
		TNT1 A 0 A_JumpIfInventory("GunsAkimboP", 1, "AkimboReady")
		TNT1 A 0 A_JumpIfInventory("CalebReady",1,"IntroTaunt")
		TNT1 A 0 A_JumpIfInventory("CalebWaiting",60,"WaitingTaunt")
		FLAR A 1 A_WeaponReady
		Goto Ready+1
	Deselect:
		FLAR A 0 A_JumpIfInventory("GunsAkimboP", 1, 1)
		Goto Super::DeselectLoop
		FAKM A 0
		Goto Super::DeselectLoop
	Select:
		FLAR A 0 A_JumpIfInventory("GunsAkimboP", 1, 1)
		Goto Super::SelectLoop
		FAKM A 0
		Goto Super::SelectLoop
	Fire:
		TNT1 A 0 A_JumpIfInventory("GunsAkimboP", 1, "AkimboFire")
		TNT1 A 0 A_GunFlash
		TNT1 A 3 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_Light1
		FLAF A 2 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_Light2
		FLAF B 2 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_Light1
		FLAF C 2 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_Light0
		TNT1 A 8 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		goto Ready
	AltFire:
		TNT1 A 0 A_JumpIfInventory("GunsAkimboP", 1, "AkimboAltfire")
		TNT1 A 0 A_JumpIfInventory("Shell", 3, 1)
		Goto Ready
		TNT1 A 0 A_GunFlash
		TNT1 A 3 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_light1
		FLAF A 2 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_Light2
		FLAF B 2 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_Light1
		FLAF C 2 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_Light0
		TNT1 A 8 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		goto Ready
	Flash:
		TNT1 A 0 A_AlertMonsters
		FLAR B 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		FLAR B 2 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"FlashCoop")
		TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"FlashCoop")
		TNT1 A 0 A_FireCustomMissile("FlareFire",0,1,9,0)
		Goto FlashEnd
	FlashCoop:
		TNT1 A 0 A_FireCustomMissile("FlareFireCoop",0,1,9,0)
		Goto FlashEnd
	AltFlash:
		TNT1 A 0 A_AlertMonsters
		FLAR B 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		FLAR B 2 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_TakeInventory("Shell", 3, TIF_NOTAKEINFINITE)
		TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"AltFlashCoop")
		TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"AltFlashCoop")
		TNT1 A 0 A_FireCustomMissile("FlareAlt",0,1,9,0)
		Goto FlashEnd
	AltFlashCoop:
		TNT1 A 0 A_FireCustomMissile("FlareAltCoop",0,1,9,0)
		Goto FlashEnd
	FlashEnd:
		TNT1 A 0 A_PlayWeaponSound("Flare/Fire")
		FLAR I 2 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		FLAR CDEFGH 2 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		stop
	AkimboReady:
		TNT1 A 0 A_JumpIfInventory("CalebReady",1,"IntroTaunt")
		TNT1 A 0 A_JumpIfInventory("CalebWaiting",60,"WaitingTaunt")
		FAKM A 1 A_WeaponReady
		Goto Ready+1
	AkimboFire:
		TNT1 A 0 A_GunFlash("AkimboFlash")
		TNT1 A 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_Light2
		FLAF A 3 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_Light1
		FLAF B 2 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_Light0
		FLAF C 1 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 2 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIFNoAmmo("Ready")
		TNT1 A 0 A_Light2
		FLAF D 3 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_Light1
		FLAF E 2 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_Light0
		FLAF F 1 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 4 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_ReFire
		goto Ready
	AkimboAltFire:
		TNT1 A 0 A_JumpIfInventory("Shell", 3, 1)
		Goto Ready
		TNT1 A 0 A_GunFlash("AkimboAltFlash")
		TNT1 A 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_Light2
		FLAF A 3 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_Light1
		FLAF B 2 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_Light0
		FLAF C 1 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 2 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("Shell", 3, 1)
		Goto Ready
		TNT1 A 0 A_Light2
		FLAF D 3 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_Light1
		FLAF E 2 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_Light0
		FLAF F 1 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 4 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_ReFire
		goto Ready
	AkimboFlash:
		TNT1 A 0 A_AlertMonsters
		TNT1 A 0 A_PlaySound("Flare/Fire")
		TNT1 A 0 A_JumpIfInventory("SPModeOn", 1, "AkimboFlashCoop")
		TNT1 A 0 A_JumpIfInventory("CoopModeOn", 1, "AkimboFlashCoop")
		TNT1 A 0 A_FireCustomMissile("FlareFire",0,1,9,0)
		FAKM BK 2 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		FAKM CDEDC 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_FireCustomMissile("FlareFire",0,1,-9,0)
		Goto AkimboFlashEnd
	AkimboAltFlash:
		TNT1 A 0 A_AlertMonsters
		TNT1 A 0 A_PlaySound("Flare/Fire")
		TNT1 A 0 A_TakeInventory("Shell", 3, TIF_NOTAKEINFINITE)
		TNT1 A 0 A_JumpIfInventory("SPModeOn", 1, "AkimboAltFlashCoop")
		TNT1 A 0 A_JumpIfInventory("CoopModeOn", 1, "AkimboAltFlashCoop")
		TNT1 A 0 A_FireCustomMissile("FlareAlt",0,1,9,3)
		FAKM BK 2 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		FAKM CDEDC 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("Shell", 3, 1)
		Stop
		TNT1 A 0 A_FireCustomMissile("FlareAlt",0,1,-9,3)
		TNT1 A 0 A_TakeInventory("Shell", 3, TIF_NOTAKEINFINITE)
		Goto AkimboFlashEnd
	AkimboFlashCoop:
		TNT1 A 0 A_FireCustomMissile("FlareFireCoop",0,1,9,0)
		FAKM BK 2 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		FAKM CDEDC 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_FireCustomMissile("FlareFireCoop",0,1,-9,0)
		Goto AkimboFlashEnd
	AkimboAltFlashCoop:
		TNT1 A 0 A_FireCustomMissile("FlareAltCoop",0,1,9,3)
		FAKM BK 2 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		FAKM CDEDC 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfInventory("Shell", 3, 1)
		Stop
		TNT1 A 0 A_FireCustomMissile("FlareAltCoop",0,1,-9,3)
		TNT1 A 0 A_TakeInventory("Shell", 3, TIF_NOTAKEINFINITE)
		Goto AkimboFlashEnd
	AkimboFlashEnd:
		TNT1 A 0 A_AlertMonsters
		TNT1 A 0 A_PlaySound("Flare/Fire")
		FAKM FL 2 Bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		FAKM GIJIG 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		FAKM A 2 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		Stop
	Spawn:
		FGRN A -1
		stop
	}
}

ACTOR FlareAlt // first flare ball that launches +8 after some time
{
	Decal BFGScorch
	Radius 13
	Height 6
	Speed 25
	Scale 0.3
	Alpha 0.9
	RENDERSTYLE ADD
	PROJECTILE
	+WINDTHRUST
	+STRIFEDAMAGE
	+FULLVOLACTIVE
	+BRIGHT
	DamageType "CalebFire"
	DeathSound "LifeLeech/Explode"
	ActiveSound "Flare/Air"
	var int user_pitch;
	States
	{
	Spawn:
		FALT A 0
		FALT A 0 A_LoopActiveSound // 20 tics of repetition
		FALT A 0 A_SetUserVar("user_pitch", CallACS("FlareGunPitch"))
		FALT A 2
		FALT AAAAA 0 A_CustomMissile("BloodFlareTrail",0,0,random(0,360),2,random(-90,90))
		FALT A 2
		FALT AAAAA 0 A_CustomMissile("BloodFlareTrail",0,0,random(0,360),2,random(-90,90))
		FALT A 2
		FALT AAAAA 0 A_CustomMissile("BloodFlareTrail",0,0,random(0,360),2,random(-90,90))
		FALT A 2
		FALT AAAAA 0 A_CustomMissile("BloodFlareTrail",0,0,random(0,360),2,random(-90,90))
		FALT A 2
		FALT AAAAA 0 A_CustomMissile("BloodFlareTrail",0,0,random(0,360),2,random(-90,90))
		FALT A 2
		FALT AAAAA 0 A_CustomMissile("BloodFlareTrail",0,0,random(0,360),2,random(-90,90))
		FALT A 2
		FALT AAAAA 0 A_CustomMissile("BloodFlareTrail",0,0,random(0,360),2,random(-90,90))
		FALT A 2
		FALT AAAAA 0 A_CustomMissile("BloodFlareTrail",0,0,random(0,360),2,random(-90,90))
		Goto Dispatch
	Dispatch:
		TNT1 A 0 A_SpawnItemEx("FlareAltSub",0,0,0,(cos(user_pitch/182)*25)+(cos(user_pitch/182)*40)+(sin(user_pitch/182)*0),-5,((-sin(user_pitch/182)*25)+(-sin(user_pitch/182)*40)+(cos(user_pitch/182)*0)),0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("FlareAltSub",0,0,0,(cos(user_pitch/182)*25)+(cos(user_pitch/182)*40)+(sin(user_pitch/182)*-2),-2,((-sin(user_pitch/182)*25)+(-sin(user_pitch/182)*40)+(cos(user_pitch/182)*-2)),0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("FlareAltSub",0,0,0,(cos(user_pitch/182)*25)+(cos(user_pitch/182)*40)+(sin(user_pitch/182)*-5),0,((-sin(user_pitch/182)*25)+(-sin(user_pitch/182)*40)+(cos(user_pitch/182)*-5)),0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("FlareAltSub",0,0,0,(cos(user_pitch/182)*25)+(cos(user_pitch/182)*40)+(sin(user_pitch/182)*-2),+2,((-sin(user_pitch/182)*25)+(-sin(user_pitch/182)*40)+(cos(user_pitch/182)*-2)),0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("FlareAltSub",0,0,0,(cos(user_pitch/182)*25)+(cos(user_pitch/182)*40)+(sin(user_pitch/182)*0),+5,((-sin(user_pitch/182)*25)+(-sin(user_pitch/182)*40)+(cos(user_pitch/182)*0)),0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("FlareAltSub",0,0,0,(cos(user_pitch/182)*25)+(cos(user_pitch/182)*40)+(sin(user_pitch/182)*2),+2,((-sin(user_pitch/182)*25)+(-sin(user_pitch/182)*40)+(cos(user_pitch/182)*2)),0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("FlareAltSub",0,0,0,(cos(user_pitch/182)*25)+(cos(user_pitch/182)*40)+(sin(user_pitch/182)*5),0,((-sin(user_pitch/182)*25)+(-sin(user_pitch/182)*40)+(cos(user_pitch/182)*5)),0,SXF_NOCHECKPOSITION)
		TNT1 A 5 A_SpawnItemEx("FlareAltSub",0,0,0,(cos(user_pitch/182)*25)+(cos(user_pitch/182)*40)+(sin(user_pitch/182)*2),-2,((-sin(user_pitch/182)*25)+(-sin(user_pitch/182)*40)+(cos(user_pitch/182)*2)),0,SXF_NOCHECKPOSITION)
		Stop
	Death:
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",0,0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_PlayWeaponSound("Flare/Explode2")
		TNT1 A 0 A_Explode(80, 120)
		FALT A 5 A_SpawnItemEx("FlareKaboom5",-2,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_CLIENTSIDE)
		Stop
	}
}

Actor FlareAltCoop : FlareAlt
{
	Species "Player"
	+THRUSPECIES
	+DONTHARMCLASS
	+DONTHARMSPECIES
	+MTHRUSPECIES
	States
	{
	Spawn:
		FALT A 0
		FALT A 0 A_LoopActiveSound
		FALT A 0 A_SetUserVar("user_pitch", CallACS("FlareGunPitch"))
		FALT A 2
		FALT AAAAA 0 A_CustomMissile("BloodFlareTrail",0,0,random(0,360),2,random(-90,90))
		FALT A 2
		FALT AAAAA 0 A_CustomMissile("BloodFlareTrail",0,0,random(0,360),2,random(-90,90))
		FALT A 2
		FALT AAAAA 0 A_CustomMissile("BloodFlareTrail",0,0,random(0,360),2,random(-90,90))
		FALT A 2
		FALT AAAAA 0 A_CustomMissile("BloodFlareTrail",0,0,random(0,360),2,random(-90,90))
		FALT A 2
		FALT AAAAA 0 A_CustomMissile("BloodFlareTrail",0,0,random(0,360),2,random(-90,90))
		FALT A 2
		FALT AAAAA 0 A_CustomMissile("BloodFlareTrail",0,0,random(0,360),2,random(-90,90))
		FALT A 2
		FALT AAAAA 0 A_CustomMissile("BloodFlareTrail",0,0,random(0,360),2,random(-90,90))
		FALT A 2
		FALT AAAAA 0 A_CustomMissile("BloodFlareTrail",0,0,random(0,360),2,random(-90,90))
		Goto Dispatch
	Dispatch:
		TNT1 A 0 A_SpawnItemEx("FlareAltSubCoop",0,0,0,(cos(user_pitch/182)*25)+(cos(user_pitch/182)*40)+(sin(user_pitch/182)*0),-5,((-sin(user_pitch/182)*25)+(-sin(user_pitch/182)*40)+(cos(user_pitch/182)*0)),0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("FlareAltSubCoop",0,0,0,(cos(user_pitch/182)*25)+(cos(user_pitch/182)*40)+(sin(user_pitch/182)*-2),-2,((-sin(user_pitch/182)*25)+(-sin(user_pitch/182)*40)+(cos(user_pitch/182)*-2)),0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("FlareAltSubCoop",0,0,0,(cos(user_pitch/182)*25)+(cos(user_pitch/182)*40)+(sin(user_pitch/182)*-5),0,((-sin(user_pitch/182)*25)+(-sin(user_pitch/182)*40)+(cos(user_pitch/182)*-5)),0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("FlareAltSubCoop",0,0,0,(cos(user_pitch/182)*25)+(cos(user_pitch/182)*40)+(sin(user_pitch/182)*-2),+2,((-sin(user_pitch/182)*25)+(-sin(user_pitch/182)*40)+(cos(user_pitch/182)*-2)),0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("FlareAltSubCoop",0,0,0,(cos(user_pitch/182)*25)+(cos(user_pitch/182)*40)+(sin(user_pitch/182)*0),+5,((-sin(user_pitch/182)*25)+(-sin(user_pitch/182)*40)+(cos(user_pitch/182)*0)),0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("FlareAltSubCoop",0,0,0,(cos(user_pitch/182)*25)+(cos(user_pitch/182)*40)+(sin(user_pitch/182)*2),+2,((-sin(user_pitch/182)*25)+(-sin(user_pitch/182)*40)+(cos(user_pitch/182)*2)),0,SXF_NOCHECKPOSITION)
		TNT1 A 0 A_SpawnItemEx("FlareAltSubCoop",0,0,0,(cos(user_pitch/182)*25)+(cos(user_pitch/182)*40)+(sin(user_pitch/182)*5),0,((-sin(user_pitch/182)*25)+(-sin(user_pitch/182)*40)+(cos(user_pitch/182)*5)),0,SXF_NOCHECKPOSITION)
		TNT1 A 5 A_SpawnItemEx("FlareAltSubCoop",0,0,0,(cos(user_pitch/182)*25)+(cos(user_pitch/182)*40)+(sin(user_pitch/182)*2),-2,((-sin(user_pitch/182)*25)+(-sin(user_pitch/182)*40)+(cos(user_pitch/182)*2)),0,SXF_NOCHECKPOSITION)
		Stop
	Death:
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",0,0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_PlayWeaponSound("Flare/Explode2")
		TNT1 A 0 A_Explode(80, 148)
		FALT A 5 A_SpawnItemEx("FlareKaboom5",-2,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_CLIENTSIDE)
		Stop
	 }
}

ACTOR FlareAltSub : FlareAlt // one of the 8 small flare balls launched after some time
{
	scale 0.3
	Damage (0)
	states
	{
	Spawn:
		FALT A 0
		FALT A 0 A_LoopActiveSound
	Flight:
		FALT A 1
		FALT A 0 A_CustomMissile("BloodFlareTrail",0,0,random[FlareGun](0,360),2,random[FlareGun](-90,90))
		LOOP
	Death:
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",0,0,random[FlareGun](0,360),2,random[FlareGun](-90,90))
		TNT1 A 0 A_PlayWeaponSound("LifeLeech/Explode")
		TNT1 A 0 A_Explode(Random(10,15),120,1)
		TNT1 A 5 A_SpawnItemEx("FlareKaboom4",-2,0,0,0,0,0,0,SXF_NOCHECKPOSITION|SXF_CLIENTSIDE)
		Stop
	}
}

Actor FlareAltSubCoop : FlareAltSub { Species "Player" +THRUSPECIES +DONTHARMCLASS +DONTHARMSPECIES +MTHRUSPECIES }

Actor FlareActorExplosion
{
	Speed 0
	Height 4
	Radius 4
	Damage (0)
	ReactionTime 1
	Obituary "%k cooked %o."
	DamageType "CalebFire"
	PROJECTILE
	+RIPPER
	+BLOODLESSIMPACT
	+FORCERADIUSDMG
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_Jump(128,2)
			TNT1 A 0 A_ChangeFlag("PAINLESS",1)
			TNT1 A 1 A_Countdown
			Wait
		Death:
			TNT1 A 1 A_Explode(3, 10, 0)
			TNT1 A 1
			Stop
	}
}

Actor FlareActorExplosionCoop : FlareActorExplosion
{
 	Species "Player"
	+THRUSPECIES
	+DONTHARMCLASS
	+DONTHARMSPECIES
	+MTHRUSPECIES
	States
	{
		Death:
			TNT1 A 1 A_Explode(5, 20, 0)
			TNT1 A 1
			Stop
	}
}

ACTOR FlareFire
{
	Radius 3
	Height 4
	Speed 50
	Scale 0.3
	PROJECTILE
	+BRIGHT
	+SEEKERMISSILE
	+DONTSPLASH
	+FOILINVUL
	+WINDTHRUST
	DamageType "CalebFire"
	activesound "Flare/Air"
	var int user_radius;
	var int user_offsetz;
	var int user_angle;
	States
	{
	Spawn:
		FAIR A 0
		FAIR A 0 A_LoopActiveSound
	SpawnLoop:
		FALT ABC 1
		FALT AAA 0 A_CustomMissile("BloodFlareTrail",0,0,random(0,360),2,random(-90,90))
		FALT D 1
		FALT A 0 A_CustomMissile("BloodFlareTrail",0,0,random(0,360),2,random(-90,90))
		Loop
	Death:
		TNT1 A 1
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",0,0,random(0,360),2,random(-90,90))
		stop
	XDeath:
		TNT1 A 0 A_SetUserVar("user_radius", CallACS("StickyLocation",1))
		TNT1 A 0 A_SetUserVar("user_offsetz", CallACS("StickyLocation",2))
		TNT1 A 0 A_SetUserVar("user_angle", CallACS("StickyLocation",3))
		TNT1 A 0 A_SetScale(0.4)
		FAIR DEF 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosion")
		TNT1 A 0 A_JumpIf(CallACS("StickyLocation",4) == 1, "Vanish")
		FAIR GHI 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosion")
		TNT1 A 0 A_JumpIf(CallACS("StickyLocation",4) == 1, "Vanish")
		FAIR DEF 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosion")
		TNT1 A 0 A_JumpIf(CallACS("StickyLocation",4) == 1, "Vanish")
		FAIR GHI 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosion")
		TNT1 A 0 A_JumpIf(CallACS("StickyLocation",4) == 1, "Vanish")
		FAIR DEF 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosion")
		TNT1 A 0 A_JumpIf(CallACS("StickyLocation",4) == 1, "Vanish")
		FAIR GHI 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosion")
		TNT1 A 0 A_JumpIf(CallACS("StickyLocation",4) == 1, "Vanish")
		FAIR DEF 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosion")
		TNT1 A 0 A_JumpIf(CallACS("StickyLocation",4) == 1, "Vanish")
		FAIR GHI 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosion")
		TNT1 A 0 A_JumpIf(CallACS("StickyLocation",4) == 1, "Vanish")
		FAIR DEF 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosion")
		TNT1 A 0 A_JumpIf(CallACS("StickyLocation",4) == 1, "Vanish")
		FAIR GHI 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosion")
		TNT1 A 0 A_JumpIf(CallACS("StickyLocation",4) == 1, "Vanish")
		FAIR DEF 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosion")
		TNT1 A 0 A_JumpIf(CallACS("StickyLocation",4) == 1, "Vanish")
		FAIR GHI 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosion")
		TNT1 A 0 A_JumpIf(CallACS("StickyLocation",4) == 1, "Vanish")
		FAIR DEF 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosion")
		TNT1 A 0 A_JumpIf(CallACS("StickyLocation",4) == 1, "Vanish")
		FAIR GHI 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosion")
		Stop
	Vanish:
		TNT1 A 5 A_FadeOut
		Stop
	}
}

Actor FlareFireCoop : FlareFire
{
	Species "Player"
	DamageType "CalebFire"
	+THRUSPECIES
	+MTHRUSPECIES
	+DONTHARMCLASS
	+DONTHARMSPECIES
	states
	{
	XDeath:
		TNT1 A 0 A_SetScale(0.4)
		TNT1 A 0 A_SetUserVar("user_radius", CallACS("StickyLocation",1))
		TNT1 A 0 A_SetUserVar("user_offsetz", CallACS("StickyLocation",2))
		TNT1 A 0 A_SetUserVar("user_angle", CallACS("StickyLocation",3))
		FAIR DEF 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosionCoop")
		TNT1 A 0 A_JumpIf(CallACS("StickyLocation",4) == 1, "Vanish")
		FAIR GHI 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosionCoop")
		TNT1 A 0 A_JumpIf(CallACS("StickyLocation",4) == 1, "Vanish")
		FAIR DEF 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosionCoop")
		TNT1 A 0 A_JumpIf(CallACS("StickyLocation",4) == 1, "Vanish")
		FAIR GHI 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosionCoop")
		TNT1 A 0 A_JumpIf(CallACS("StickyLocation",4) == 1, "Vanish")
		FAIR DEF 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosionCoop")
		TNT1 A 0 A_JumpIf(CallACS("StickyLocation",4) == 1, "Vanish")
		FAIR GHI 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosionCoop")
		TNT1 A 0 A_JumpIf(CallACS("StickyLocation",4) == 1, "Vanish")
		FAIR DEF 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosionCoop")
		TNT1 A 0 A_JumpIf(CallACS("StickyLocation",4) == 1, "Vanish")
		FAIR GHI 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosionCoop")
		TNT1 A 0 A_JumpIf(CallACS("StickyLocation",4) == 1, "Vanish")
		FAIR DEF 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosionCoop")
		TNT1 A 0 A_JumpIf(CallACS("StickyLocation",4) == 1, "Vanish")
		FAIR GHI 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosionCoop")
		TNT1 A 0 A_JumpIf(CallACS("StickyLocation",4) == 1, "Vanish")
		FAIR DEF 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosionCoop")
		TNT1 A 0 A_JumpIf(CallACS("StickyLocation",4) == 1, "Vanish")
		FAIR GHI 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosionCoop")
		TNT1 A 0 A_JumpIf(CallACS("StickyLocation",4) == 1, "Vanish")
		FAIR DEF 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosionCoop")
		TNT1 A 0 A_JumpIf(CallACS("StickyLocation",4) == 1, "Vanish")
		FAIR GHI 1 A_Warp(AAPTR_TRACER,user_radius >> 16,0,abs(user_offsetz),user_angle+180,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
		TNT1 AAAAA 0 A_CustomMissile("BloodFlareTrail",FRandom(0.0,8.0),0,random(0,360),2,random(-90,90))
		TNT1 A 0 A_SpawnItemEx("FlareActorExplosionCoop")
		Stop
	}
}

actor BloodFlareTrail : BloodNapalmDebris { Scale 0.1 Translation "176:191=32:47","208:223=16:31" }

actor BloodFlareTrail1
{
	Health 5
	Radius 1
	Height 1
	Speed 10
	Mass 30
	PROJECTILE
	+BRIGHT
	+DONTSPLASH
	-NOGRAVITY
	-SOLID
	+NOBLOCKMAP
	+NOBLOCKMONST
	+THRUSPECIES
	+CLIENTSIDEONLY
	Scale 0.1
	States
	{
	Spawn:
		FAIR ABCABCABCABCABCABCABCABCABCABCABCABC 3
		Stop
	Death:
		FAIR C 1
		Stop
	}
}

actor FlareKaboom
{
	Radius 64
	Height 16
	RenderStyle Add
	Scale 0.5
	+BRIGHT
	+NOBLOCKMAP
	+NOGRAVITY
	+DONTSPLASH
	+WINDTHRUST
	+FIXMAPTHINGPOS
	-SOLID
	+CLIENTSIDEONLY
	states
	{
	Spawn:
		FALT A 1
		FALT A 1 A_Burst("FlareKaboom3")
		stop
	}
}

actor FlareKaboom2 : FlareKaboom
{
	-WINDTHRUST
	states
	{
	Spawn:
		LLSX A 0
		LLSX A 2 A_SpawnDebris("BloodFlareDebris")
		LLSX BCDEFGHIJK 2
		stop
	}
}

actor FlareKaboom3 : FlareKaboom2
{
	states
	{
	Spawn:
		LLSX A 0
		LLSX A 0 A_SpawnItemEx("FlareKaboom2",0,0,0,0,0,0,0,SXF_CLIENTSIDE)
		LLSX A 2 A_SpawnDebris("BloodFlareDebris")
		LLSX BCDEFGHIJK 2
		stop
	}
}

actor FlareKaboom4 : FlareKaboom2
{
	Scale 0.75
	states
	{
	Spawn:
		LLSX A 0
		LLSX A 0 A_SpawnDebris("BloodFlareDebris")
		LLSX ABCDEFGHIJK 2 A_FadeOut(0.08)
		stop
	}
}

actor FlareKaboom5 : FlareKaboom2
{
	Scale 1.0
	RenderStyle Normal
	states
	{
	Spawn:
		LLSX A 0
		LLSX AAAAAAAAAAA 0 A_SpawnDebris("BloodFlareDebris")
		LLSX ABCDEFGHIJK 2
		stop
	}
}