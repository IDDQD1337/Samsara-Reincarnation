Actor " AM Cyclone " : Weapon
{
    Weapon.SelectionOrder 1735
    Weapon.SlotNumber 6
	weapon.BobStyle normal
	weapon.BobRangeX 1.2
	weapon.BobRangeY 0.5
	weapon.BobSpeed 2.0	
    Weapon.SlotPriority 6	
    Weapon.AmmoUse 1
    Weapon.AmmoGive 25
    Weapon.AmmoType "Shell"
    Inventory.PickupMessage "AM Cyclone!"
	Obituary "%o ate %k's big fresh mint snow-balls."	
	Inventory.RestrictedTo "DisruptorPlayer"
    Tag "AM Cyclone"
    States
	{
	Spawn:
		SQ72 T -1
		Stop

	Ready:
		SQ71 QQQQRRRRSSSSTTTTUUUUVVVV 1 A_WeaponReady
		Loop

	Deselect:
		TNT1 A 0 A_Lower
		SQ71 Q 1 A_Lower
		Loop

	Select:
		TNT1 A 0 A_TakeInventory("DisruptorMode", 1)
		TNT1 A 0 A_Raise
		SQ71 Q 1 A_Raise
		Loop

	Fire:
		TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,"FireStart")
		TNT1 A 0 A_JumpIfInventory("Shell",1,"FireStart")
		goto NoAmmoSwitch
	FireStart:
		TNT1 A 0 A_AlertMonsters
		TNT1 A 0 A_GiveInventory("SamsaraDisruptorAMCycloneAttackHandler")
		SQ71 W 1 bright	A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfNoAmmo("Ready")
		SQ71 WXXX 1 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_AlertMonsters
		TNT1 A 0 A_GiveInventory("SamsaraDisruptorAMCycloneAttackHandler")
		SQ71 W 1 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfNoAmmo("Ready")
		SQ71 WXXX 1 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_AlertMonsters
		TNT1 A 0 A_GiveInventory("SamsaraDisruptorAMCycloneAttackHandler")
		SQ71 W 1 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfNoAmmo("Ready")
		SQ71 WXXX 1 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)	
		TNT1 A 0 A_AlertMonsters
		TNT1 A 0 A_GiveInventory("SamsaraDisruptorAMCycloneAttackHandler")
		SQ71 W 1 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfNoAmmo("Ready")
		SQ71 WXXX 1 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_AlertMonsters
		TNT1 A 0 A_GiveInventory("SamsaraDisruptorAMCycloneAttackHandler")
		SQ71 W 1 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_JumpIfNoAmmo("Ready")
		SQ71 WXXX 1 bright A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		SQ71 YYY 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		SQ71 ZZZ 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		SQ72 AAA 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		SQ71 QQQ 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		TNT1 A 0 A_Refire
		SQ71 QQQ 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		goto Ready
		
	NoAmmoSwitch:
		TNT1 A 0 A_ClearReFire
		TNT1 A 0 A_SelectWeapon(" 18mm Semi ")
		goto Deselect
	}
}

actor SamsaraDisruptorAMCycloneAttackHandler : Trigger
{
    States
    {
      // Ammo checking/taking stuff
      Pickup:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,"PickupAttack")
        TNT1 A 0 A_JumpIfInventory("Shell",1,1)
        stop
        TNT1 A 0 A_TakeInventory("Shell",1)
        goto PickupAttack

      // Attack stuff
      PickupAttack:
        TNT1 A 0 A_PlaySound("Disruptor/Cannon2",CHAN_WEAPON)
		TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"PickupAttackCoop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"PickupAttackCoop")
      PickupAttackDM:
		TNT1 A 0 A_FireCustomMissile("DisruptorSnowBall",0,1,0,0)
        stop

      PickupAttackCoop:
		TNT1 A 0 A_FireCustomMissile("DisruptorSnowBall_1",0,1,0,0)
        stop
    }
}

Actor DisruptorSnowBall
{
	Height 8
	Radius 8
    Speed 25
	Damage (Random(25,35))
	Projectile
	RenderStyle Add
	Alpha 1.0	
	DeathSound "Disruptor/SnowBoom"
	ActiveSound "Disruptor/SnowTrail"
	+NOBLOOD
	+BLOODLESSIMPACT
	+THRUGHOST
	+WINDTHRUST
	+FORCEXYBILLBOARD
	-SKYEXPLODE
	+FORCERADIUSDMG
	Scale 0.60
	Obituary "%o enjoyed %k's fresh mint snow-balls."	
    States
    {
      Spawn:
		TNT1 A 0
		TNT1 A 0 A_LoopActiveSound
        SQ94 VVVVVVVVVV 1 bright
		Goto SpawnLoop
	  SpawnLoop:
        SQ94 V 1 bright A_Weave(2, 2, 2.0, 1.5)		
        SQ94 V 1 bright A_Weave(2, 2, 2.0, 1.5)			
        Loop
      Death:
		TNT1 A 0 A_SetScale(1.2)
		TNT1 A 0 A_Explode(Random(32,45), 40)
		SQ94 HIJKLMNOPQRS 3 bright
		SQ94 TU 2 bright
        Stop
    }
}

Actor DisruptorSnowBall_1 : DisruptorSnowBall
{
	Speed 35
	Species "Player"
	+THRUSPECIES
	+DONTHARMCLASS
	+DONTHARMSPECIES
	+MTHRUSPECIES
	States
	{
      Death:
		TNT1 A 0 A_SetScale(1.2)
		TNT1 A 0 A_Explode(14,44)
		SQ94 HIJKLMNOPQRS 3 bright
		SQ94 TU 2 bright
        Stop 
	}
} 