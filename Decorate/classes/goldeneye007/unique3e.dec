ACTOR Goldeneye_ProximityMines : Weapon
{
  Weapon.SelectionOrder 41
  Weapon.SlotNumber 9
  Obituary "%o was destroyed by %k's proximity mine."
  +WEAPON.NOALERT
  +WEAPON.AMMO_OPTIONAL
  +INVENTORY.UNDROPPABLE
  Weapon.AmmoType "RocketAmmo"
  Weapon.AmmoUse 1
  Inventory.Pickupmessage "Proximity Mine"
  Tag "Mines (Proximity)"
  Inventory.RestrictedTo "JamesBond"
  Height 16
  Radius 8
  States
  {
  Spawn:
    PIST A -1
    stop

  // Weapon
  Ready:
	TNT1 A 0 A_JumpIfInventory("BondWatchQueue", 1, "RaiseWatch")
	TNT1 A 0 A_JumpIfInventory("BondWatchToken", 1, "WatchReady")
	Goto Center

  Center:
    TNT1 A 1 A_WeaponReady
    Goto Ready

  Deselect:
	TNT1 A 0 A_TakeInventory("BondFireDelay", 3)
	TNT1 A 0 A_TakeInventory("BondAlternateFire", 1)
	TNT1 A 0 A_TakeInventory("BondDualWieldToken", 1)
	TNT1 A 0 A_TakeInventory("BondAltToggle", 2)
	TNT1 A 0 A_TakeInventory("BondZoomToken", 1)
	TNT1 A 0 A_TakeInventory("BondDualWieldSpamProtector", 1)
	TNT1 A 0 A_TakeInventory("BondDryFireSpamProtector1", 1)
	TNT1 A 0 A_TakeInventory("BondDryFireSpamProtector2", 1)
	TNT1 A 0 A_TakeInventory("BondAltActivationToken", 1)
    TNT1 A 1 A_Lower
    Loop

  Select:
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,2)
    TNT1 A 0 A_JumpIfInventory("RocketAmmo",1,1)
    goto SelectLoop
    TNT1 A 0 A_PlaySound("Goldeneye/MineSwitch",CHAN_7)
  SelectLoop:
	TNT1 A 0 A_GiveInventory("Goldeneye_UnarmedToken", 1)
	TNT1 A 0 A_TakeInventory("Goldeneye_PP7Token", 1)
	TNT1 A 0 A_TakeInventory("Goldeneye_KnifeToken", 1)
	TNT1 A 0 A_TakeInventory("Goldeneye_KF7Token", 1)
	TNT1 A 0 A_TakeInventory("Goldeneye_AutoShotgunToken", 1)
	TNT1 A 0 A_TakeInventory("Goldeneye_AR33Token", 1)
	TNT1 A 0 A_TakeInventory("Goldeneye_RocketLauncherToken", 1)
	TNT1 A 0 A_TakeInventory("Goldeneye_RCP90Token", 1)
	TNT1 A 0 A_TakeInventory("Goldeneye_LaserToken", 1)
	TNT1 A 0 A_TakeInventory("Goldeneye_GoldenGunToken", 1)
	TNT1 A 0 A_TakeInventory("Goldeneye_SniperToken", 1)
	TNT1 A 0 A_TakeInventory("Goldeneye_D5KToken", 1)
    TNT1 A 1 A_Raise
    Loop

  Fire:
    TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,"FireStart")
    TNT1 A 0 A_JumpIfInventory("RocketAmmo",1,"FireStart")
	goto FireDry

  FireDry:
    TNT1 A 0 A_JumpIfInventory("BondDryFireSpamProtector1", 1, "FireFinish")
    TNT1 A 0 ACS_NamedExecuteAlways("BondDryFireSpamBlocker_Primary")
    TNT1 A 0 A_GiveInventory("BondDryFireSpamProtector1", 1)
    goto FireFinish

  FireStart:
	TNT1 A 0 A_GiveInventory("BondFiringToken", 1)
    goto FireCenter

  FireCenter:
  FireCenterAttack:
	TNT1 A 0 A_GiveInventory("SamsaraGoldenEyeProximityMineAttackHandler")
    TNT1 A 0 A_TakeInventory("BondFiringToken")
  FireCenterDone:
    TNT1 A 35
	goto FireFinish

  FireFinish:
    TNT1 A 0 A_TakeInventory("BondFiringToken")
    goto Ready

  // Watch
  WatchReady:
	GE13 T 0 A_JumpIfInventory("BondWatchQueue", 1, "RaiseWatch")
	GE13 T 4 A_WeaponReady(WRF_DISABLESWITCH|WRF_NOFIRE)
	Loop

  LowerWatch:
	GE13 T 0 A_Zoomfactor(1.0)
	GE13 T 0 A_TakeInventory("BondWatchActivate", 1)
	GE13 T 0 A_GiveInventory("BondWatchUIDeinit", 1)
	GE13 T 0 ACS_NamedExecuteAlways("BondWatchLookUpAndDown")
	GE13 T 10
	GE13 T 0 A_WeaponReady(WRF_DISABLESWITCH|WRF_NOFIRE)
	GE13 TSRQPONMLKJIHGFEDCBA 2
	GE13 A 0 A_JumpIfInventory("BondDualWieldToken", 1, 1)
	Goto LowerWatch+29
	GE13 A 0 A_GunFlash("DualRaise",GFF_NOEXTCHANGE)
	GE00 A 12
	GE13 A 0 A_TakeInventory("BondWatchQueue", 1)
	GE13 A 0 SetPlayerProperty(0, 0, PROP_Frozen)
	GE13 A 0 A_TakeInventory ("PowerTimeFreezer", 0x7fffffff) 
	GE13 A 0 A_TakeInventory("BondWatchToken", 1)
	GE13 A 0 A_TakeInventory("BondWatchUIInit", 1)
	GE13 A 0 ACS_NamedExecuteAlways("BondWeaponSwitch")
	Goto Ready

  RaiseWatch:
	GE13 A 0 A_ZoomFactor(1.0)
	GE13 A 0 A_TakeInventory("BondAltToggle", 2)
	GE13 A 0 A_WeaponReady(WRF_DISABLESWITCH|WRF_NOFIRE)
	GE13 A 0 A_JumpIfInventory("BondWatchToken", 1, "LowerWatch")
	GE13 A 0 A_GiveInventory("BondWatchActivate", 1)
	GE13 A 0 A_JumpIfInventory("BondDualWieldToken", 1, 1)
	Goto RaiseWatch+8
	GE13 A 0 A_GunFlash("DualLower",GFF_NOEXTCHANGE)
	GE00 A 12
	GE13 A 0 A_TakeInventory("BondPitchTokens", 32768)
	GE13 A 0 A_TakeInventory("BondAngleTokens", 131072)
	GE13 A 0 SetPlayerProperty(0, 1, PROP_Frozen)
	GE13 A 0 ACS_NamedExecuteAlways("BondWatchLookUpAndDown")
	//GE13 T 0 A_GiveInventory("Goldeneye_TimeFreezer", 1)
	GE13 ABCDEFGHIJKLMNOPQRST 2
	GE13 T 0 A_Zoomfactor(7.5)
	GE13 T 0 A_GiveInventory("BondWatchUIInit", 1)
	GE13 T 0 A_GiveInventory("BondWatchToken", 1)
	GE13 T 0 ACS_NamedExecuteAlways("BondWatchInterface")
	GE13 T 0 A_TakeInventory("BondWatchQueue", 1)
	Goto Ready
  }
}

// Attack handler

actor SamsaraGoldenEyeProximityMineAttackHandler : Trigger
{
    States
    {
      // Ammo checking/taking stuff
      Pickup:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,"PickupAttack")
        TNT1 A 0 A_JumpIfInventory("RocketAmmo",1,1)
        stop
        TNT1 A 0 A_TakeInventory("RocketAmmo",1)
        goto PickupAttack

      // Attack stuff
      PickupAttack:
        TNT1 A 0 A_PlaySound("Goldeneye/MineThrow",CHAN_WEAPON)
        goto PickupAttackCenter

      PickupAttackCenter:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"PickupAttackCenterCoop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"PickupAttackCenterCoop")
      PickupAttackCenterDM:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_ProximityMineProjectile",0,false)
        stop

      PickupAttackCenterCoop:
        TNT1 A 0 A_FireCustomMissile("Goldeneye_ProximityMineProjectileCoop",0,false)
        stop
    }
}

Actor Goldeneye_ProximityMineProjectile
{
	Damage (0)
	Projectile
	Height 6
	Radius 2
	Speed 10
	-NOGRAVITY
	+ISMONSTER
	Gravity 0.25
	Scale 0.33
	var int user_pitch;
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_SetUserVar("user_pitch", CallACS("BondThrownKnifePitch"))
			TNT1 A 0 A_SetPitch(user_pitch - 90)
			Goto SpawnLoop
		SpawnLoop:	
			GE00 A 1 A_SetPitch(pitch - 5, SPF_INTERPOLATE)
			loop
		Death:
			TNT1 A 0 A_Playsound("Goldeneye/Mineplant", CHAN_5)
			TNT1 A 0 A_CustomMissile("Goldeneye_ProximityMineStatic", 0, 0, angle, CMF_TRACKOWNER)
			stop
		Crash:
		XDeath:
			TNT1 A 0 A_SetGravity(0.75)
			TNT1 A 0 A_CheckFloor("XDeathFloor")
			TNT1 A 0 A_ChangeFlag(THRUACTORS, true)
			GE00 A 1 A_SetPitch(pitch - 5, SPF_INTERPOLATE)
			Loop
		XDeathFloor:
			TNT1 A 0 A_NoGravity
			TNT1 A 0 A_Playsound("Goldeneye/Mineplant", CHAN_5)
			TNT1 A 0 A_CustomMissile("Goldeneye_ProximityMineStatic", 0, 0, angle, CMF_TRACKOWNER)
			stop
	}
}

Actor Goldeneye_ProximityMineProjectileCoop : Goldeneye_ProximityMineProjectile 
{ 
	+THRUSPECIES 
	+DONTHARMSPECIES
	Species "Player"
	States
	{
		Death:
			TNT1 A 0 A_Playsound("Goldeneye/Mineplant", CHAN_5)
			TNT1 A 0 A_CustomMissile("Goldeneye_ProximityMineStaticCoop", 0, 0, angle, CMF_TRACKOWNER)
			stop
		Crash:
		XDeath:
			TNT1 A 0 A_SetGravity(0.75)
			TNT1 A 0 A_CheckFloor("XDeathFloor")
			TNT1 A 0 A_ChangeFlag(THRUACTORS, true)
			GE00 A 1 A_SetPitch(pitch - 5, SPF_INTERPOLATE)
			Loop
		XDeathFloor:
			TNT1 A 0 A_NoGravity
			TNT1 A 0 A_Playsound("Goldeneye/Mineplant", CHAN_5)
			TNT1 A 0 A_CustomMissile("Goldeneye_ProximityMineStaticCoop", 0, 0, angle, CMF_TRACKOWNER)
			stop
			}
}

Actor Goldeneye_ProximityMineStatic
{
	+LOOKALLAROUND
	+ISMONSTER
	-COUNTKILL
	-SHOOTABLE
	+VULNERABLE
	+NOGRAVITY
	+MOVEWITHSECTOR
	+THRUACTORS
	+NOBLOOD
	+FORCERADIUSDMG
	+EXTREMEDEATH
	+SEEINVISIBLE
	Speed 0
	Mass 10000
	Health 10
	Height 6
	Radius 2
	Scale 0.33
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_CheckFloor("FloorLoop")
			TNT1 A 0 A_CheckCeiling("CeilingLoop")
			GE00 A 0 A_SetPitch(0)
			GE00 A 0 A_SetAngle(angle)
		SpawnLoop:
			GE00 B 0 A_ChangeFlag(FRIENDLY, false)
			GE00 B 0 A_LookEx(LOF_NOJUMP, 0, 2048, 2048, 0, "Detonate")
			GE00 B 0 A_ClearTarget
			GE00 B 0 A_ChangeFlag(FRIENDLY, true)
			GE00 B 0 A_LookEx(0, 0, 64, 64, 0, "Detonate")
			GE00 B 1 A_SetPitch(90)
			Loop
		FloorLoop:
			GE00 B 0 A_ChangeFlag(FRIENDLY, false)
			GE00 B 0 A_LookEx(LOF_NOJUMP, 0, 2048, 2048, 0, "Detonate")
			GE00 B 0 A_ClearTarget
			GE00 B 0 A_ChangeFlag(FRIENDLY, true)
			GE00 B 0 A_LookEx(0, 0, 64, 64, 0, "Detonate")
			GE00 B 1 A_SetPitch(0)
			Loop
		CeilingLoop:
			GE00 C 0 A_ChangeFlag(FRIENDLY, false)
			GE00 C 0 A_LookEx(LOF_NOJUMP, 0, 2048, 2048, 0, "Detonate")
			GE00 C 0 A_ClearTarget
			GE00 C 0 A_ChangeFlag(FRIENDLY, true)
			GE00 C 0 A_LookEx(0, 0, 64, 64, 0, "Detonate")
			GE00 C 1 A_SetPitch(180)
			Loop
		Death:
		Detonate:
			TNT1 A 0 A_PlaySound("Goldeneye/Explosion", CHAN_BODY)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-5, 5), frandom(-5, 5), frandom(-6, 7), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-5, 5), frandom(-5, 5), frandom(-6, 7), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-5, 5), frandom(-5, 5), frandom(-1, 4), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-5, 5), frandom(-5, 5), frandom(-1, 4), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-3, 3), frandom(-3, 3), frandom(1, 6), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-3, 3), frandom(-3, 3), frandom(1, 6), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-3, 3), frandom(-3, 3), frandom(1, 6), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-3, 3), frandom(-3, 3), frandom(1, 6), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-3, 3), frandom(-3, 3), frandom(1, 6), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-3, 3), frandom(-3, 3), frandom(1, 6), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAA 0 A_SpawnItemEx ("Goldeneye_ExplosionSmoke", frandom(-1, 1), frandom(-1, 1), frandom(-1, 1), 0, 0, 0, 0, SXF_NOCHECKPOSITION, 0)
			TNT1 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 0, 0, -24, 0, 0, 0, 0, 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 5 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 5 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 5 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)	
			TNT1 A 5 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 5 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 5 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 5 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			stop
	}
}

Actor Goldeneye_ProximityMineStaticCoop : Goldeneye_ProximityMineStatic
{
	+DONTHARMCLASS
	+DONTHARMSPECIES
	+FRIENDLY
	Species "Player"
	States
	{
		SpawnLoop:
			GE00 B 0 A_ChangeFlag(FRIENDLY, true)
			GE00 B 0 A_LookEx(LOF_NOJUMP|LOF_NOSOUNDCHECK, 0, 2048, 2048, 0, "Detonate")
			GE00 B 0 A_ClearTarget
			GE00 B 0 A_LookEx(0, 0, 64, 64, 0, "Detonate")
			GE00 B 1 A_SetPitch(90)
			Loop
		FloorLoop:
			GE00 B 0 A_ChangeFlag(FRIENDLY, true)
			GE00 B 0 A_LookEx(LOF_NOJUMP|LOF_NOSOUNDCHECK, 0, 2048, 2048, 0, "Detonate")
			GE00 B 0 A_ClearTarget
			GE00 B 0 A_LookEx(0, 0, 64, 64, 0, "Detonate")
			GE00 B 1 A_SetPitch(0)
			Loop
		CeilingLoop:
			GE00 C 0 A_ChangeFlag(FRIENDLY, true)
			GE00 C 0 A_LookEx(LOF_NOJUMP|LOF_NOSOUNDCHECK, 0, 2048, 2048, 0, "Detonate")
			GE00 C 0 A_ClearTarget
			GE00 C 0 A_LookEx(0, 0, 64, 64, 0, "Detonate")
			GE00 C 1 A_SetPitch(180)
			Loop
			}
}			
