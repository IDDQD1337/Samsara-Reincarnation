actor SamsaraGoldenEyePermanentTankCannon : Boolean {}

actor SamsaraGoldenEyeTankProtection : SamsaraPowerupGiver
{
    Powerup.Type SamsaraGoldenEyeTankProtection
    Powerup.Duration 0x7FFFFFFF
}

actor PowerSamsaraGoldenEyeTankProtection : PowerProtection { DamageFactor "Normal", 0.1 }

Actor Goldeneye_Tank
{
	Height 40
	Radius 40
	Health 2000
	Mass 36000
	+SHOOTABLE
	+NOBLOOD
    +NOTIMEFREEZE
	States
	{
		Spawn:
			GE00 A 0 NoDelay ACS_NamedExecuteWithResult("Goldeneye_BuildTank")
		SpawnLoop:
			GE00 A 0 A_JumpIfInventory("Goldeneye_UsingTank",1,"SetInvulnerable")
			GE00 A 0 A_ChangeFlag("NODAMAGE",false)
			GE00 A 1
			Loop
		SetInvulnerable:
			GE00 A 0 A_ChangeFlag("NODAMAGE",true)
			Goto SpawnLoop+2
		Death:
			TNT1 A 0 A_GiveInventory("Goldeneye_TankRemoval")
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-5, 5), frandom(-5, 5), frandom(-6, 7), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-5, 5), frandom(-5, 5), frandom(-6, 7), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-5, 5), frandom(-5, 5), frandom(-1, 4), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-5, 5), frandom(-5, 5), frandom(-1, 4), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-3, 3), frandom(-3, 3), frandom(1, 6), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-3, 3), frandom(-3, 3), frandom(1, 6), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-3, 3), frandom(-3, 3), frandom(1, 6), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-3, 3), frandom(-3, 3), frandom(1, 6), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-3, 3), frandom(-3, 3), frandom(1, 6), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-3, 3), frandom(-3, 3), frandom(1, 6), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAA 0 A_SpawnItemEx ("Goldeneye_ExplosionSmoke", frandom(-48, 48), frandom(-48, 48), frandom(-1, 1), 0, 0, 0, 0, SXF_NOCHECKPOSITION, 0)
			TNT1 A 0 A_PlaySound("Goldeneye/Explosion",CHAN_BODY)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", -80 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 64 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", -80 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 64 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", -80 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 64 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", -80 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 64 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", -80 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 64 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 0 A_PlaySound("Goldeneye/Explosion",CHAN_BODY)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", -80 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 64 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", -80 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 64 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", -80 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 64 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", -80 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 64 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", -80 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 64 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 0 A_PlaySound("Goldeneye/Explosion",CHAN_BODY)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", -80 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 64 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", -80 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 64 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", -80 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 64 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", -80 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 64 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", -80 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 64 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 0 A_PlaySound("Goldeneye/Explosion",CHAN_BODY)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", -80 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 64 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", -80 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 64 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", -80 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 64 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", -80 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 64 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", -80 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 64 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 0 A_PlaySound("Goldeneye/Explosion",CHAN_BODY)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", -80 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 64 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", -80 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 64 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", -80 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 64 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", -80 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 64 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", -80 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			GE00 A 0 A_FadeOut(0.02) GE00 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 64 + frandom(-48, 48), frandom(-48, 48), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(15, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			stop
	}
}

Actor Goldeneye_Tank_CollisionBoundary
{
	Height 40
	Radius 8
    +NOTIMEFREEZE
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_CheckLOF("Stay",CLOFF_JUMPOBJECT|CLOFF_JUMP_ON_MISS|CLOFF_MUSTBESOLID|CLOFF_ALLOWNULL,16,0,-90)
			TNT1 A 0 A_CheckLOF("Stay",CLOFF_JUMPOBJECT|CLOFF_JUMP_ON_MISS|CLOFF_MUSTBESOLID|CLOFF_ALLOWNULL,16,0,90)
			TNT1 A 2 A_CheckLOF("Stay",CLOFF_JUMPOBJECT|CLOFF_JUMP_ON_MISS|CLOFF_MUSTBESOLID|CLOFF_ALLOWNULL,16)
			Stop
		Stay:
			TNT1 A 0 A_GiveInventory("Goldeneye_Tank_Blocked",1,AAPTR_Master)
			Stop
	}
}

Actor Goldeneye_Tank_Blocked : Boolean {}

Actor Goldeneye_Tank_Collision_FrontL
{
	Height 40
	Radius 20
	+SOLID
	+NOBLOOD
	+SHOOTABLE
	+NODAMAGE
    +NOTIMEFREEZE
	States
	{
		Spawn:
			TNT1 A 0 NoDelay A_JumpIfInventory("Goldeneye_TankRemoval",1,"Remove",AAPTR_TRACER)
			TNT1 A 1 A_Warp(AAPTR_TRACER,64,12,0,0,WARPF_NOCHECKPOSITION)
			Loop
		Remove:
			TNT1 A 1
			Stop
	}
}

Actor Goldeneye_Tank_Collision_FrontR : Goldeneye_Tank_Collision_FrontL
{
	States
	{
		Spawn:
			TNT1 A 0 NoDelay A_JumpIfInventory("Goldeneye_TankRemoval",1,"Remove",AAPTR_TRACER)
			TNT1 A 1 A_Warp(AAPTR_TRACER,64,-12,0,0,WARPF_NOCHECKPOSITION)
			Loop
	}
}

Actor Goldeneye_Tank_Collision_BackL : Goldeneye_Tank_Collision_FrontL
{
	States
	{
		Spawn:
			TNT1 A 0 NoDelay A_JumpIfInventory("Goldeneye_TankRemoval",1,"Remove",AAPTR_TRACER)
			TNT1 A 1 A_Warp(AAPTR_TRACER,-80,12,0,0,WARPF_NOCHECKPOSITION)
			Loop
	}
}

Actor Goldeneye_Tank_Collision_BackR : Goldeneye_Tank_Collision_FrontL
{
	States
	{
		Spawn:
			TNT1 A 0 NoDelay A_JumpIfInventory("Goldeneye_TankRemoval",1,"Remove",AAPTR_TRACER)
			TNT1 A 1 A_Warp(AAPTR_TRACER,-80,-12,0,0,WARPF_NOCHECKPOSITION)
			Loop
	}
}

Actor Goldeneye_Tank_Step_Front
{
	Height 20
	Radius 48
	+SOLID
    +NOTIMEFREEZE
	States
	{
		Spawn:
			TNT1 A 0
		SpawnLoop:
			TNT1 A 0 A_JumpIfInventory("Goldeneye_TankRemoval",1,"Remove",AAPTR_TRACER)
			TNT1 A 0 A_JumpIfInventory("Goldeneye_UsingTank",1,"NotSolid",AAPTR_Tracer)
			TNT1 A 0 A_SetSolid
			TNT1 A 1 A_Warp(AAPTR_TRACER,56,0,0,0,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
			Loop
		NotSolid:
			TNT1 A 0 A_UnsetSolid
			Goto SpawnLoop+3
		Remove:
			TNT1 A 1
			Stop
	}
}

Actor Goldeneye_Tank_Step_Back : Goldeneye_Tank_Step_Front
{
	States
	{
		Spawn:
			TNT1 A 0
		SpawnLoop:
			TNT1 A 0 A_JumpIfInventory("Goldeneye_TankRemoval",1,"Remove",AAPTR_TRACER)
			TNT1 A 0 A_JumpIfInventory("Goldeneye_UsingTank",1,"NotSolid",AAPTR_Tracer)
			TNT1 A 0 A_SetSolid
			TNT1 A 1 A_Warp(AAPTR_TRACER,-72,0,0,0,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
			Loop
		NotSolid:
			TNT1 A 0 A_UnsetSolid
			Goto SpawnLoop+3
	}
}

Actor Goldeneye_Tank_Turret : SwitchableDecoration
{
	Height 40
	Radius 40
	Activation THINGSPEC_Activate|THINGSPEC_ThingTargets|THINGSPEC_Switch
	+USESPECIAL
	+SOLID
    +NOTIMEFREEZE
	States
	{
		Spawn:
			TNT1 A 0 NoDelay A_JumpIfInventory("Goldeneye_TankRemoval",1,"Remove",AAPTR_TRACER)
			GE00 A 0 A_SetSolid
			GE00 A 0 A_ChangeFlag("USESPECIAL",1)
			GE00 A 1 A_Warp(AAPTR_TRACER,0,0,0,0,WARPF_NOCHECKPOSITION|WARPF_USECALLERANGLE|WARPF_COPYINTERPOLATION)
			Loop
		Active:
		InActive:
			GE00 A 0 A_JumpIfInventory("Goldeneye_TankGivenRockets",1,2)
			GE00 A 0 A_GiveToTarget("RocketAmmo",30)
			GE00 A 0 A_GiveInventory("Goldeneye_TankGivenRockets",1)
			GE00 A 0 A_GiveToTarget("Goldeneye_TankWeapon",1)
			GE00 A 0 A_JumpIf(CallACS("Goldeneye_TankActivationHeight")==0,"Spawn")
			GE00 A 0 A_GiveInventory("Goldeneye_UsingTank",1,AAPTR_Tracer)
			GE00 A 0 A_GiveInventory("Goldeneye_UsingTank",1,AAPTR_Master)
			GE00 A 0 A_GiveToTarget("Goldeneye_UsingTank",1)
			GE00 A 0 A_PlaySound("Goldeneye/Tank/Ignition",CHAN_7,1.0,0,0.5)
			GE00 A 0 A_UnsetSolid
			GE00 A 0 A_ChangeFlag("USESPECIAL",0)
			GE00 A 0 ACS_NamedExecuteWithResult("Goldeneye_TankActivator")
			Goto Using
		Using:
			GE00 A 0 A_JumpIfInventory("Goldeneye_UsingTank",1,1,AAPTR_TRACER)
			Goto BackToSpawn
			GE00 A 1 A_JumpIfInventory("Goldeneye_TankRemoval",1,"Remove",AAPTR_TRACER)
			Loop
		BackToSpawn:
			TNT1 A 0 A_JumpIfInTargetInventory("SamsaraGoldenEyePermanentTankCannon",1,2)
			GE00 A 0 A_TakeFromTarget("Goldeneye_TankWeapon",1)
			GE00 A 0 A_ClearTarget
			Goto Spawn
		Remove:
			TNT1 A 0 A_GiveInventory("Goldeneye_TankRemoval")
			GE00 A 3 A_Fadeout(0.02)
			Wait
	}
}

Actor Goldeneye_TankDamageObjects : Trigger
{
	States
	{
		Pickup:
			TNT1 A 0 A_FireCustomMissile("Goldeneye_TankHitter",(CallACS("Goldeneye_TankCounters",2)/182.0)-angle,0,0,-24,0,pitch)
			TNT1 A 0 A_FireCustomMissile("Goldeneye_TankHitter",(CallACS("Goldeneye_TankCounters",2)/182.0)+180-angle,0,0,-24,0,pitch)
			Stop
	}
}

Actor Goldeneye_Tank_Barrel
{
	Height 16
	Radius 8
    +NOTIMEFREEZE
	States
	{
		Spawn:
			GE00 A 0
			GE00 A 0 A_JumpIfInventory("Goldeneye_TankRemoval",1,"Remove",AAPTR_TRACER)
			GE00 A 0 A_JumpIfInventory("Goldeneye_UsingTank",1,"DoNotWarp")
			GE00 A 1 A_Warp(AAPTR_TRACER,0,0,0,0,WARPF_NOCHECKPOSITION|WARPF_COPYINTERPOLATION)
			Loop
		DoNotWarp:
			GE00 A 1
			Goto Spawn
		Remove:
			GE00 A 3 A_Fadeout(0.02)
			Wait
	}
}

Actor Goldeneye_UsingTank : Boolean {}
Actor Goldeneye_TankRemoval : Boolean {}
Actor Goldeneye_TankGivenRockets : Boolean {}
Actor Goldeneye_TankAngle : Counter { Inventory.MaxAmount 65536 }
Actor Goldeneye_TankPitch : Counter { Inventory.MaxAmount 65536 }
Actor Goldeneye_TankForward : Counter { Inventory.MaxAmount 131072 }
Actor Goldeneye_TankSide : Counter { Inventory.MaxAmount 131072 }
Actor Goldeneye_TankBaseAngle : Counter { Inventory.MaxAmount 65536 }

Actor Goldeneye_TankHitter
{
	Height 40
	Radius 36
	Speed 36
	Damage (0)
	Projectile
	DamageType "GETank"
	+BLOODLESSIMPACT
	+THRUACTORS
	+FORCERADIUSDMG
    +NOTIMEFREEZE
    +DONTREFLECT
    +DONTBLAST
	States
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_AlertMonsters(1024)
			TNT1 A 0 A_RadiusThrust(16,36,RTF_NOIMPACTDAMAGE,36)
			TNT1 A 1 A_Explode(50,32,0,0,32)
			TNT1 A 0 A_RadiusThrust(16,36,RTF_NOIMPACTDAMAGE,36)
			TNT1 A 1 A_Explode(50,32,0,0,32)
			Stop
	}
}

Actor Goldeneye_TankWeapon : Weapon
{
	Weapon.AmmoUse1 1
	Weapon.AmmoType1 "Goldeneye_TankMagazine"
	Weapon.AmmoUse2 0
	Weapon.AmmoType2 "RocketAmmo"
	Weapon.SlotNumber 0
    Weapon.BobStyle InverseSmooth
    Weapon.BobSpeed 1.6
    Weapon.BobRangeX 0.3
    Weapon.BobRangeY 0.4
	Obituary "%o was blown up by %k's tank cannon."
	Inventory.RestrictedTo "JamesBond"
	Tag "Tank Cannon"
	+WEAPON.AMMO_OPTIONAL
	+WEAPON.EXPLOSIVE
	+WEAPON.NOALERT
	States
	{
		Spawn:
			TNT1 A -1
			Stop

		// Weapon
		Ready:
			TNT1 A 0 A_JumpIfInventory("BondWatchQueue", 1, "RaiseWatch")
			TNT1 A 0 A_JumpIfInventory("BondWatchToken", 1, "WatchReady")
			goto Center

		ReadyAmmoCheck:
			TNT1 A 0 A_JumpIfInventory("SamsaraReloadMode",1,1)
			goto Ready
			TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",0,"Ready")
			TNT1 A 0 A_JumpIfInventory("Goldeneye_TankMagazine",1,"Ready")
			goto ReloadCheck

		ReadyNoAmmoCheck:
			TNT1 A 0 A_JumpIfInventory("SamsaraReloadMode",1,"ReadyAmmoCheck")
			TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,"ReloadStart")
			TNT1 A 0 A_JumpIfInventory("RocketAmmo",1,"ReloadStart")
			goto Ready

		Center:
			TNT1 A 0 A_JumpIfInventory("SamsaraReloadMode",1,5)
			TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,3)
			TNT1 A 0 A_JumpIfInventory("RocketAmmo",1,2)
			TNT1 A 1 A_WeaponReady
			goto ReadyNoAmmoCheck
			TNT1 A 1 A_WeaponReady
			goto ReadyAmmoCheck
			TNT1 A 1 A_WeaponReady(WRF_ALLOWRELOAD)
			goto ReadyAmmoCheck

		Deselect:
			TNT1 A 0 A_TakeInventory("BondFireDelay", 3)
			TNT1 A 0 A_TakeInventory("BondAlternateFire", 1)
			TNT1 A 0 A_TakeInventory("BondDualWieldToken", 1)
			TNT1 A 0 A_TakeInventory("BondAltToggle", 2)
			TNT1 A 0 A_TakeInventory("BondZoomToken", 1)
			TNT1 A 0 A_TakeInventory("BondDualWieldSpamProtector", 1)
			TNT1 A 0 A_TakeInventory("BondDryFireSpamProtector1", 1)
			TNT1 A 0 A_TakeInventory("BondDryFireSpamProtector2", 1)
			TNT1 A 0 A_TakeInventory("BondAltActivationToken", 1)
			TNT1 A 1 A_Lower
			Loop

		Select:
			TNT1 A 0 A_GiveInventory("Goldeneye_UnarmedToken", 1)
			TNT1 A 0 A_TakeInventory("Goldeneye_PP7Token", 1)
			TNT1 A 0 A_TakeInventory("Goldeneye_KnifeToken", 1)
			TNT1 A 0 A_TakeInventory("Goldeneye_KF7Token", 1)
			TNT1 A 0 A_TakeInventory("Goldeneye_AutoShotgunToken", 1)
			TNT1 A 0 A_TakeInventory("Goldeneye_AR33Token", 1)
			TNT1 A 0 A_TakeInventory("Goldeneye_RocketLauncherToken", 1)
			TNT1 A 0 A_TakeInventory("Goldeneye_RCP90Token", 1)
			TNT1 A 0 A_TakeInventory("Goldeneye_LaserToken", 1)
			TNT1 A 0 A_TakeInventory("Goldeneye_GoldenGunToken", 1)
			TNT1 A 0 A_TakeInventory("Goldeneye_SniperToken", 1)
			TNT1 A 0 A_TakeInventory("Goldeneye_D5KToken", 1)
			TNT1 A 1 A_Raise
			Loop

		Fire:
			TNT1 A 0 A_JumpIfInventory("SamsaraReloadMode",1,"FireReloadable")
		FireNonReloadable:
			TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,"FireStart")
			TNT1 A 0 A_JumpIfInventory("RocketAmmo",1,"FireStart")
			goto FireDry

		FireReloadable:
			TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",0,"FireStart")
			TNT1 A 0 A_JumpIfInventory("Goldeneye_TankMagazine",1,"FireStart")
			goto FireDry

		FireDry:
			TNT1 A 0 A_JumpIfInventory("BondDryFireSpamProtector1", 1, "FireFinish")
			TNT1 A 0 ACS_NamedExecuteAlways("BondDryFireSpamBlocker_Primary")
			TNT1 A 0 A_GiveInventory("BondDryFireSpamProtector1", 1)
			goto FireFinish

		FireStart:
			TNT1 A 0 A_GiveInventory("BondFiringToken", 1)
			TNT1 A 0 A_AlertMonsters
			goto FireCenter

		FireCenter:
		FireCenterAttack:
			TNT1 A 0 A_GiveInventory("SamsaraGoldenEyeTankCannonAttackHandler")
			TNT1 A 0 A_TakeInventory("BondFiringToken")
		FireCenterDone:
			TNT1 A 35
			goto FireFinish

		FireFinish:
			TNT1 A 0 A_TakeInventory("BondFiringToken")
			goto ReadyNoAmmoCheck

		Reload:
		ReloadCheck:
			TNT1 A 0 A_JumpIfInventory("Goldeneye_TankMagazine",0,"Ready")
			TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",0,2)
			TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,"ReloadStart")
			TNT1 A 0 A_JumpIfInventory("RocketAmmo",1,"ReloadStart")
			goto Ready

		ReloadStart:
            TNT1 A 35
			TNT1 A 0 A_JumpIfInventory("SamsaraReloadMode",1,"ReloadAmmo")
		ReloadDone:
			TNT1 A 0
			goto Ready

		ReloadAmmo:
			TNT1 A 0 A_JumpIfInventory("Goldeneye_TankMagazine",0,"ReloadDone")
			TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",0,2)
			TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,2)
			TNT1 A 0 A_JumpIfInventory("RocketAmmo",1,1)
			goto ReloadDone
			TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",0,2)
			TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,2)
			TNT1 A 0 A_TakeInventory("RocketAmmo",1)
			TNT1 A 0 A_GiveInventory("Goldeneye_TankMagazine")
			loop

		// Watch
		WatchReady:
			GE13 T 0 A_JumpIfInventory("BondWatchQueue", 1, "RaiseWatch")
			GE13 T 4 A_WeaponReady(WRF_DISABLESWITCH|WRF_NOFIRE)
			Loop

		LowerWatch:
			GE13 T 0 A_Zoomfactor(1.0)
			GE13 T 0 A_TakeInventory("BondWatchActivate", 1)
			GE13 T 0 A_GiveInventory("BondWatchUIDeinit", 1)
			GE13 T 0 ACS_NamedExecuteAlways("BondWatchLookUpAndDown")
			GE13 T 10
			GE13 T 0 A_WeaponReady(WRF_DISABLESWITCH|WRF_NOFIRE)
			GE13 TSRQPONMLKJIHGFEDCBA 2
			GE13 A 0 A_TakeInventory("BondWatchQueue", 1)
			GE13 A 0 SetPlayerProperty(0, 0, PROP_Frozen)
			GE13 A 0 A_TakeInventory ("PowerTimeFreezer", 0x7fffffff)
			GE13 A 0 A_TakeInventory("BondWatchToken", 1)
			GE13 A 0 A_TakeInventory("BondWatchUIInit", 1)
			GE13 A 0 ACS_NamedExecuteAlways("BondWeaponSwitch")
			Goto Ready

		RaiseWatch:
			GE13 A 0 A_ZoomFactor(1.0)
			GE13 A 0 A_TakeInventory("BondAltToggle", 2)
			GE13 A 0 A_WeaponReady(WRF_DISABLESWITCH|WRF_NOFIRE)
			GE13 A 0 A_JumpIfInventory("BondWatchToken", 1, "LowerWatch")
			GE13 A 0 A_GiveInventory("BondWatchActivate", 1)
			GE13 A 0 A_TakeInventory("BondPitchTokens", 32768)
			GE13 A 0 A_TakeInventory("BondAngleTokens", 131072)
			GE13 A 0 SetPlayerProperty(0, 1, PROP_Frozen)
			GE13 A 0 ACS_NamedExecuteAlways("BondWatchLookUpAndDown")
			//GE13 T 0 A_GiveInventory("Goldeneye_TimeFreezer", 1)
			GE13 ABCDEFGHIJKLMNOPQRST 2
			GE13 T 0 A_Zoomfactor(7.5)
			GE13 T 0 A_GiveInventory("BondWatchUIInit", 1)
			GE13 T 0 A_GiveInventory("BondWatchToken", 1)
			GE13 T 0 ACS_NamedExecuteAlways("BondWatchInterface")
			GE13 T 0 A_TakeInventory("BondWatchQueue", 1)
			Goto Ready
	}
}

// Attack handler

actor SamsaraGoldenEyeTankCannonAttackHandler : Trigger
{
    States
    {
      // Ammo checking/taking stuff
      Pickup:
        TNT1 A 0 A_JumpIfInventory("SamsaraReloadMode",1,"PickupReloadable")
      PickupNonReloadable:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",1,"PickupAttack")
        TNT1 A 0 A_JumpIfInventory("RocketAmmo",1,1)
        stop
        TNT1 A 0 A_TakeInventory("RocketAmmo",1)
        goto PickupAttack

      PickupReloadable:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteAmmo",0,"PickupAttack")
        TNT1 A 0 A_JumpIfInventory("Goldeneye_TankMagazine",1,1)
        stop
        TNT1 A 0 A_TakeInventory("Goldeneye_TankMagazine",1)
        goto PickupAttack

      // Attack stuff
      PickupAttack:
        TNT1 A 0 A_PlaySound("Goldeneye/Tank/Fire",CHAN_WEAPON)
        goto PickupAttackCenter

      PickupAttackCenter:
        TNT1 A 0 A_JumpIfInventory("SPModeOn",1,"PickupAttackCenterCoop")
        TNT1 A 0 A_JumpIfInventory("CoopModeOn",1,"PickupAttackCenterCoop")
      PickupAttackCenterDM:
        TNT1 A 0 A_SpawnItemEx("Goldeneye_TankShell",148,-7,20,20*cos(pitch),0,20*sin(-pitch))
        TNT1 A 0 A_JumpIfInventory("SamsaraHasSpread",1,1)
        stop
        TNT1 A 0 A_SpawnItemEx("Goldeneye_TankShell",148,-7,20,20*cos(pitch),0,20*sin(-pitch),-15)
        TNT1 A 0 A_SpawnItemEx("Goldeneye_TankShell",148,-7,20,20*cos(pitch),0,20*sin(-pitch),15)
        stop

      PickupAttackCenterCoop:
        TNT1 A 0 A_SpawnItemEx("Goldeneye_TankShellCoop",148,-7,20,20*cos(pitch),0,20*sin(-pitch))
        TNT1 A 0 A_JumpIfInventory("SamsaraHasSpread",1,1)
        stop
        TNT1 A 0 A_SpawnItemEx("Goldeneye_TankShellCoop",148,-7,20,20*cos(pitch),0,20*sin(-pitch),-15)
        TNT1 A 0 A_SpawnItemEx("Goldeneye_TankShellCoop",148,-7,20,20*cos(pitch),0,20*sin(-pitch),15)
        stop
    }
}

actor Goldeneye_TankMagazine : Ammo
{
	Inventory.MaxAmount 1
    Tag "Tank Cannon Magazine"
	+IGNORESKILL
}

Actor Goldeneye_TankShell
{
	Damage (0)
	Projectile
	Height 8
	Radius 6
	Speed 20
	-NOGRAVITY
	+FORCERADIUSDMG
	+EXTREMEDEATH
	Gravity 0.167
	Scale 0.75
	DeathSound "Goldeneye/Explosion"
	States
	{
		Spawn:
			GE00 A 0
			GE00 A 1 Bright A_SpawnItemEx("Goldeneye_RocketSmoke", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION)
			loop
		Death:
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-5, 5), frandom(-5, 5), frandom(-6, 7), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-5, 5), frandom(-5, 5), frandom(-6, 7), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-5, 5), frandom(-5, 5), frandom(-1, 4), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-5, 5), frandom(-5, 5), frandom(-1, 4), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-3, 3), frandom(-3, 3), frandom(1, 6), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-3, 3), frandom(-3, 3), frandom(1, 6), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-3, 3), frandom(-3, 3), frandom(1, 6), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-3, 3), frandom(-3, 3), frandom(1, 6), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-3, 3), frandom(-3, 3), frandom(1, 6), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAAAAAAAAAA 0 A_SpawnItemEx("Goldeneye_Debris", frandom(-8, 8), frandom(-8, 8), frandom(-8, 8), frandom(-3, 3), frandom(-3, 3), frandom(1, 6), frandom(-360, 360), SXF_NOCHECKPOSITION)
			TNT1 AAAA 0 A_SpawnItemEx ("Goldeneye_ExplosionSmoke", frandom(-1, 1), frandom(-1, 1), frandom(-1, 1), 0, 0, 0, 0, SXF_NOCHECKPOSITION, 0)
			TNT1 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", 0, 0, -24, 0, 0, 0, 0, 0, 0) TNT1 A 0 A_Explode(30, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(30, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(30, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(30, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(30, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(30, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(30, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(30, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(30, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 3 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(30, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 5 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(30, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 5 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(30, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 5 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(30, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 5 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(30, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 5 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(30, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 5 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(30, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			TNT1 A 5 A_SpawnItemEx ("Goldeneye_ExplosionParticle", frandom(-24, 24), frandom(-24, 24), frandom(-12, 26), 0, 0, 0, frandom(-360, 360), 0, 0) TNT1 A 0 A_Explode(30, 80, XF_HURTSOURCE, 1, 80) TNT1 A 0 A_RadiusGive("Goldeneye_ExplosionZThrust",80,RGF_PLAYERS|RGF_NOTARGET|RGF_MONSTERS) TNT1 A 0 A_RadiusThrust(40,80,!RTF_AFFECTSOURCE,80)
			stop
	}
}

actor Goldeneye_TankShellCoop : Goldeneye_TankShell
{
	Species "Player"
	+THRUSPECIES
}
