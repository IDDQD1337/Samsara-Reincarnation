actor CalebVision: Boolean {}
actor CalebVisionFuel: Counter { Inventory.MaxAmount 100 }

actor BeastVision : CustomInventory
{
	tag "Beast Vision"
	+INVBAR
	+INVENTORY.UNDROPPABLE
	Inventory.Icon INBEAST
	+inventory.hubpower
	Inventory.PickupSound "misc/i_pkup"
	Inventory.PickupMessage "You got the Best Vision!"
	Inventory.UseSound ""
	Inventory.RestrictedTo "Caleb"
	Inventory.MaxAmount 1
	Scale 0.5
	States
	{
	Spawn:
		INFR A -1
		Stop

	Use:
        TNT1 A 0 A_JumpIfInventory("SamsaraHasInfiniteInventory",1,"CanStartFlying")
		TNT1 A 0 A_JumpIfInventory("CalebVisionFuel",1,"CanStartFlying")
		TNT1 A 0 ACS_NamedExecuteAlways("SamsaraClientDecorate",0,6)
		fail

	CanStartFlying:
		TNT1 A 0 A_JumpIfInventory("CalebVision",1,"IsFlying")

	NotFlying:
		TNT1 A 0 A_PlaySoundEx("Caleb/Powerup","item",0,0)
		TNT1 A 0 A_GiveInventory("CalebVision",1)
		TNT1 A 0 A_GiveInventory("PowerLightAmp",1)
		TNT1 A 1 ACS_NamedExecuteAlways("CalebBeastVisionDrain",0)
		fail

	IsFlying:
		//TNT1 A 0 A_PlaySoundEx("Caleb/Powerup","item",0,0)
		TNT1 A 1 A_TakeInventory("CalebVision", 1)
		TNT1 A 1 A_TakeInventory("PowerLightAmp", 1)
		TNT1 A 15
		fail
	}
}

actor CalebNightVision : Infrared { Powerup.Duration 0x7FFFFFFF }